[
    {
        "type": "type_B",
        "db_id": "activity_1",
        "chart_category": "Advanced Calculations",
        "chart_type": "calculate_residuals",
        "NLQ": "I like this scatter plot showing movie ratings over time, but could you create a similar visualization for my student activity data instead? I'd like to see how the average age of students in each activity compares to the overall average, with activities on the x-axis and the age difference on the y-axis. Please use a red-blue color scheme where blue shows activities with older students and red shows activities with younger students compared to the average. Also, add a title that explains what we're looking at.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/activity_1.sqlite')\n\nquery = '''\nSELECT \n    A.activity_name,\n    AVG(S.Age) AS Avg_Age\nFROM \n    Activity AS A\nJOIN \n    Participates_in AS P ON A.actid = P.actid\nJOIN \n    Student AS S ON P.stuid = S.StuID\nGROUP BY \n    A.actid, A.activity_name\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\noverall_avg_age = df['Avg_Age'].mean()\n\nchart = (\n    alt.Chart(df)\n    .mark_point()\n    .transform_calculate(\n        Age_Delta=\"datum.Avg_Age - \" + str(overall_avg_age)\n    )\n    .encode(\n        x=alt.X(\"activity_name:N\").title(\"Activity Name\"),\n        y=alt.Y(\"Age_Delta:Q\").title(\"Age Delta (Years)\"),\n        color=alt.Color(\"Age_Delta:Q\")\n        .title(\"Age Delta\")\n        .scale(domainMid=0, scheme=\"redblue\"),\n    )\n    .properties(title=\"Difference in Average Age by Activity\")\n)\n\nchart",
        "reference_path": "./vis_bench/img/Advanced Calculations___calculate_residuals.png"
    },
    {
        "type": "type_B",
        "db_id": "activity_1",
        "chart_category": "Uncertainties And Trends",
        "chart_type": "simple_scatter_plot_with_errorbars",
        "NLQ": "Can you create a chart showing the average age of students for each activity type, with error bars showing the minimum and maximum ages? I'd like to see the activity names on the x-axis instead of just numbers, and rename the y-axis to \"Average Age of Participants\" to make it clearer what we're looking at.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/activity_1.sqlite')\n\nquery = '''\nSELECT\n    A.activity_name,\n    AVG(S.Age) AS average_age,\n    MIN(S.Age) AS min_age,\n    MAX(S.Age) AS max_age\nFROM\n    Participates_in AS P\nJOIN\n    Student AS S ON P.stuid = S.StuID\nJOIN\n    Activity AS A ON P.actid = A.actid\nGROUP BY\n    A.activity_name;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).transform_calculate(\n    ymin=\"datum.min_age\",\n    ymax=\"datum.max_age\"\n)\n\npoints = base.mark_point(\n    filled=True,\n    size=50,\n    color='black'\n).encode(\n    alt.X('activity_name', sort=None),\n    alt.Y('average_age', title='Average Age of Participants')\n)\n\nerrorbars = base.mark_errorbar().encode(\n    x=\"activity_name\",\n    y=\"ymin:Q\",\n    y2=\"ymax:Q\"\n)\n\nchart = points + errorbars\n\nchart",
        "reference_path": "./vis_bench/img/Uncertainties And Trends___simple_scatter_plot_with_errorbars.png"
    },
    {
        "type": "type_B",
        "db_id": "aircraft",
        "chart_category": "Advanced Calculations",
        "chart_type": "calculate_residuals",
        "NLQ": "I came across this scatter plot image that calculates differences from the average, and I really like its style. Can you create something similar showing how each aircraft's maximum gross weight compares to the average, plotted against their total disk area using the aircraft table? Add a title \"Aircraft Weight Residuals vs. Total Disk Area\" and make sure to label the axes properly.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/aircraft.sqlite')\n\nquery = '''\nSELECT \n    Aircraft, \n    CAST(REPLACE(Max_Gross_Weight, ',', '') AS REAL) AS Max_Gross_Weight,\n    CAST(REPLACE(Total_disk_area, ' ft²', '') AS REAL) AS Total_Disk_Area\nFROM \n    aircraft\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = (\n    alt.Chart(df)\n    .mark_point()\n    .transform_joinaggregate(Average_Weight=\"mean(Max_Gross_Weight)\")\n    .transform_calculate(Weight_Residual=\"datum.Max_Gross_Weight - datum.Average_Weight\")\n    .encode(\n        x=alt.X(\"Total_Disk_Area:Q\").title(\"Total Disk Area (sq ft)\"),\n        y=alt.Y(\"Weight_Residual:Q\").title(\"Weight Residual (lbs)\"),\n        color=alt.Color(\"Weight_Residual:Q\").title(\"Weight Residual\").scale(domainMid=0),\n        tooltip=[\"Aircraft:N\", \"Max_Gross_Weight:Q\", \"Total_Disk_Area:Q\"]\n    )\n    .properties(title=\"Aircraft Weight Residuals vs. Total Disk Area\")\n)\n\nchart",
        "reference_path": "./vis_bench/img/Advanced Calculations___calculate_residuals.png"
    },
    {
        "type": "type_B",
        "db_id": "aircraft",
        "chart_category": "Bar Charts",
        "chart_type": "stacked_bar_chart",
        "NLQ": "I came across this stacked bar chart that looks really clean and professional. Can you create something similar to show the total passengers for each airport, splitting them into international and domestic? I'd like the airports on the x-axis and the bars stacked by passenger type. Please use blue for domestic passengers and orange for international passengers, and make sure to include a legend on the right side.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/aircraft.sqlite')\n\nquery = '''\nSELECT \n    Airport_Name,\n    International_Passengers AS Passengers,\n    'International' AS Passenger_Type\nFROM \n    airport\nUNION ALL\nSELECT \n    Airport_Name,\n    Domestic_Passengers AS Passengers,\n    'Domestic' AS Passenger_Type\nFROM \n    airport\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='Airport_Name:N',\n    y='sum(Passengers):Q',\n    color='Passenger_Type:N'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___stacked_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "aircraft",
        "chart_category": "Uncertainties And Trends",
        "chart_type": "simple_scatter_plot_with_errorbars",
        "NLQ": "Can you create a scatter plot showing the relationship between total disk area and maximum gross weight for aircraft? I'd like to see error bars showing about 10% margin of error for the weight values. Please use black dots for the data points, make them a good size, and label the axes properly with \"Total Disk Area (sq ft)\" on the x-axis and \"Max Gross Weight (lb)\" on the y-axis. Also, add a grid to make it easier to read the values.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/aircraft.sqlite')\n\nquery = '''\nSELECT \n    CAST(REPLACE(Max_Gross_Weight, ',', '') AS REAL) AS Max_Gross_Weight,\n    CAST(REPLACE(Total_disk_area, ',', '') AS REAL) AS Total_Disk_Area\nFROM \n    aircraft\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\ndf['yerr'] = df['Max_Gross_Weight'] * 0.1\n\nbase = alt.Chart(df).transform_calculate(\n    ymin=\"datum.Max_Gross_Weight - datum.yerr\",\n    ymax=\"datum.Max_Gross_Weight + datum.yerr\"\n)\n\npoints = base.mark_point(\n    filled=True,\n    size=50,\n    color='black'\n).encode(\n    x=alt.X('Total_Disk_Area:Q', title='Total Disk Area (sq ft)'),\n    y=alt.Y('Max_Gross_Weight:Q', title='Max Gross Weight (lb)', scale=alt.Scale(zero=False))\n)\n\nerrorbars = base.mark_errorbar().encode(\n    x=\"Total_Disk_Area:Q\",\n    y=\"ymin:Q\",\n    y2=\"ymax:Q\"\n)\n\nchart = points + errorbars\nchart",
        "reference_path": "./vis_bench/img/Uncertainties And Trends___simple_scatter_plot_with_errorbars.png"
    },
    {
        "type": "type_B",
        "db_id": "baseball_1",
        "chart_category": "Uncertainties And Trends",
        "chart_type": "line_chart_with_confidence_interval_band",
        "NLQ": "I came across this line chart with a shaded band that shows trends and uncertainty—it looks really professional. Could you create something similar to visualize how the average number of home runs per team has changed over the years, using the batting data from the database? I'd like to see the full history of baseball home runs with a 95% confidence interval band around the average, and make the chart wider to show the long-term trend better.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/baseball_1.sqlite')\n\nquery = '''\nSELECT \n    year, \n    team_id, \n    SUM(hr) AS team_hr\nFROM batting\nWHERE hr IS NOT NULL\nGROUP BY year, team_id;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nline = alt.Chart(df).mark_line().encode(\n    x=alt.X('year:O', title='Year'),\n    y=alt.Y('mean(team_hr):Q', title='Average Home Runs per Team')\n)\n\nband = alt.Chart(df).mark_errorband(extent='ci').encode(\n    x='year:O',\n    y=alt.Y('team_hr:Q')\n)\n\nchart = (band + line).properties(\n    title='Average Team Home Runs per Year with 95% Confidence Interval'\n)\nchart.show()",
        "reference_path": "./vis_bench/img/Uncertainties And Trends___line_chart_with_confidence_interval_band.png"
    },
    {
        "type": "type_B",
        "db_id": "browser_web",
        "chart_category": "Advanced Calculations",
        "chart_type": "gantt_chart",
        "NLQ": "Can you create a Gantt chart showing all the web client accelerators from our database? I'd like each accelerator name listed on the y-axis, with bars starting at their ID number and ending 2 units later. Use a simple blue color scheme for all bars and add a grid in the background. Also, please rename the axes to show \"task\" on the y-axis and \"start, end\" on the x-axis.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/browser_web.sqlite')\nquery = '''\nSELECT id, name\nFROM Web_client_accelerator\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndf['start'] = df['id']\ndf['end'] = df['id'] + 2\ndf = df.rename(columns={'name': 'task'})\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='start:Q',\n    x2='end:Q',\n    y='task:N'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Advanced Calculations___gantt_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "candidate_poll",
        "chart_category": "Circular Plots",
        "chart_type": "pacman_chart",
        "NLQ": "I came across this cool circular Pac-Man style chart, and I love how it looks! Can you create something similar to visualize the support rate data from the candidate table in our database? But could you make the Pac-Man face right instead of left, and make the mouth a bit smaller?",
        "code": "import numpy as np\nimport altair as alt\nimport sqlite3\nimport pandas as pd\n\nconn = sqlite3.connect('database/candidate_poll.sqlite')\n\nquery = '''\nSELECT Support_rate\nFROM candidate\nLIMIT 1\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nprint(\"Fetched Support Rate from Database:\", df['Support_rate'].iloc[0])\n\nconn.close()\n\nchart = alt.Chart().mark_arc(color=\"gold\").encode(\n    theta=alt.ThetaDatum((5 / 8) * np.pi).scale(None),\n    theta2=alt.Theta2Datum((19 / 8) * np.pi),\n    radius=alt.RadiusDatum(100).scale(None),\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Circular Plots___pacman_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "company_employee",
        "chart_category": "Circular Plots",
        "chart_type": "radial_chart",
        "NLQ": "I came across this circular chart that looks really engaging, and I think it would be perfect for showing how employees from different colleges are spread across industries. Could you create something similar using our data on people's graduation colleges and the industries they work in? Please add a title \"Employee Distribution by Graduation College and Industry\" and show the actual count values on each segment. Also, make sure to use white lines between segments and include tooltips with college, industry, and employee count information.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/company_employee.sqlite')\n\nquery = '''\nSELECT \n    p.Graduation_College AS College,\n    c.Industry AS Industry,\n    COUNT(*) AS Employee_Count\nFROM \n    employment AS e\nJOIN \n    people AS p ON e.People_ID = p.People_ID\nJOIN \n    company AS c ON e.Company_ID = c.Company_ID\nGROUP BY \n    p.Graduation_College, c.Industry\nORDER BY \n    p.Graduation_College, c.Industry;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    alt.Theta(\"Employee_Count:Q\").stack(True),\n    alt.Radius(\"Employee_Count\").scale(type=\"sqrt\", zero=True, rangeMin=20),\n    color=\"Industry:N\",\n    tooltip=[\"College:N\", \"Industry:N\", \"Employee_Count:Q\"]\n)\n\nc1 = base.mark_arc(innerRadius=20, stroke=\"#fff\")\nc2 = base.mark_text(radiusOffset=10).encode(text=\"Employee_Count:Q\")\n\nchart = c1 + c2\nchart.properties(title=\"Employee Distribution by Graduation College and Industry\")",
        "reference_path": "./vis_bench/img/Circular Plots___radial_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "concert_singer",
        "chart_category": "Advanced Calculations",
        "chart_type": "layered_chart_with_dual-axis",
        "NLQ": "Can you create a chart showing stadium capacities as green bars and average attendance as a blue line? I'd like to see stadium names along the x-axis, with capacity values on the left y-axis and attendance numbers on the right y-axis. Please make the axes independent so both datasets are clearly visible.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/concert_singer.sqlite')\n\nquery = '''\nSELECT Name, Capacity, Average\nFROM stadium;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    alt.X('Name:N').title('Stadium Name')\n)\n\nbars = base.mark_bar(color='#57A44C').encode(\n    alt.Y('Capacity:Q').axis(title='Stadium Capacity', titleColor='#57A44C')\n)\n\nline = base.mark_line(color='#5276A7').encode(\n    alt.Y('Average:Q').axis(title='Average Attendance', titleColor='#5276A7')\n)\n\nchart = alt.layer(bars, line).resolve_scale(\n    y='independent'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Advanced Calculations___layered_chart_with_dual-axis.png"
    },
    {
        "type": "type_B",
        "db_id": "cre_Theme_park",
        "chart_category": "Advanced Calculations",
        "chart_type": "ranged_dot_plot",
        "NLQ": "Can you create a chart showing hotel price ranges by star rating? I'd like to see the data points colored by whether pets are allowed or not, and add a title \"Hotel Price Ranges by Star Rating and Pet Policy\". Also, could you connect the points with a red line to show the trend across star ratings?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/cre_Theme_park.sqlite')\n\nquery = '''\nSELECT \n    h.star_rating_code,\n    r.star_rating_description,\n    h.price_range,\n    CASE \n        WHEN h.pets_allowed_yn = '1' THEN 'Pets Allowed'\n        ELSE 'No Pets Allowed'\n    END AS pets_policy\nFROM Hotels AS h\nJOIN Ref_Hotel_Star_Ratings AS r ON h.star_rating_code = r.star_rating_code\nWHERE h.price_range IS NOT NULL AND h.price_range != '' AND h.star_rating_code IS NOT NULL\nORDER BY h.star_rating_code\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = (\n    alt.Chart(df)\n    .encode(\n        x=alt.X(\"price_range:Q\", title=\"Price Range\"),\n        y=alt.Y(\"star_rating_description:N\", title=\"Star Rating\"),\n        color=alt.Color(\"pets_policy:N\", title=\"Pet Policy\"),\n    )\n    .mark_point(size=100, filled=True)\n)\n\nline = (\n    alt.Chart(df)\n    .encode(\n        x=\"price_range:Q\",\n        y=\"star_rating_description:N\",\n        detail=\"star_rating_description:N\",\n    )\n    .mark_line(color=\"#db646f\")\n)\n\nfinal_chart = (line + chart).properties(\n    title=\"Hotel Price Ranges by Star Rating and Pet Policy\"\n)\n\nfinal_chart",
        "reference_path": "./vis_bench/img/Advanced Calculations___ranged_dot_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "cre_Theme_park",
        "chart_category": "Distributions",
        "chart_type": "boxplot_with_minmax_whiskers",
        "NLQ": "Can you create a boxplot showing the distribution of Visit_ID by Tourist_ID from the theme park database? I'd like a simple blue boxplot with min-max whiskers, but without the title and with a cleaner grid. The x-axis should show the Tourist_ID values and the y-axis should show the Visit_ID values.",
        "code": "import altair as alt\nimport sqlite3\nimport pandas as pd\n\nconn = sqlite3.connect('database/cre_Theme_park.sqlite')\nquery = '''\nSELECT CAST(Tourist_ID AS TEXT) AS age, Visit_ID AS people FROM Visits\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_boxplot(extent='min-max').encode(\n    x='age:O',\n    y='people:Q'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___boxplot_with_minmax_whiskers.png"
    },
    {
        "type": "type_B",
        "db_id": "culture_company",
        "chart_category": "Distributions",
        "chart_type": "cumulative_count_chart",
        "NLQ": "I came across this chart image that shows a running total over time, and I really like its clean style. Can you create something similar using the book_club table to show how the total number of books grows year by year? Use a blue area chart instead of the light blue in the example, and make sure the y-axis shows the cumulative count of books.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/culture_company.sqlite')\nquery = '''\nSELECT Year, COUNT(*) AS Book_Count\nFROM book_club\nGROUP BY Year\nORDER BY Year\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ncumulative_chart = alt.Chart(df).transform_window(\n    cumulative_count=\"sum(Book_Count)\",\n    sort=[{\"field\": \"Year\"}],\n).mark_area().encode(\n    x=alt.X(\"Year:Q\", title=\"Year\"),\n    y=alt.Y(\"cumulative_count:Q\", title=\"Cumulative Count of Books\").stack(False)\n)\n\ncumulative_chart",
        "reference_path": "./vis_bench/img/Distributions___cumulative_count_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "customers_and_addresses",
        "chart_category": "Distributions",
        "chart_type": "cumulative_count_chart",
        "NLQ": "I like this chart showing movie ratings, but I need something similar for our order data instead. Can you create a cumulative area chart that shows how our orders have grown over time, broken down by order status like Delivered and Cancelled? I'd like to see the dates on the x-axis and have different colors for each status category.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/customers_and_addresses.sqlite')\nquery = '''\nSELECT \n    order_status, \n    order_date\nFROM \n    Customer_Orders\nORDER BY \n    order_date ASC;\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\ndf['order_date'] = pd.to_datetime(df['order_date'])\n\ncumulative_chart = alt.Chart(df).transform_window(\n    cumulative_count=\"count()\",\n    sort=[{\"field\": \"order_date\"}],\n    groupby=[\"order_status\"]\n).mark_area().encode(\n    x=alt.X(\"order_date:T\", title=\"Order Date\"),\n    y=alt.Y(\"cumulative_count:Q\", stack=False, title=\"Cumulative Count\"),\n    color=alt.Color(\"order_status:N\", title=\"Order Status\")\n).properties(\n    title=\"Cumulative Count of Orders by Status Over Time\"\n)\n\ncumulative_chart",
        "reference_path": "./vis_bench/img/Distributions___cumulative_count_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "customers_and_addresses",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_last_value_labeled",
        "NLQ": "Can you create a line chart showing the total number of customer orders over time from our database? I'd like to highlight the most recent data point with a circle and show its value as a text label next to it.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/customers_and_addresses.sqlite')\n\nquery = '''\nSELECT \n    DATE(order_date) AS order_date, \n    COUNT(order_id) AS total_orders\nFROM \n    Customer_Orders\nGROUP BY \n    DATE(order_date)\nORDER BY \n    order_date\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).encode(\n    x=alt.X(\"order_date:T\", title=\"Order Date\"),\n    y=alt.Y(\"total_orders:Q\", title=\"Total Orders\")\n)\n\nline = chart.mark_line().encode()\n\nlabel = chart.encode(\n    x='max(order_date):T',\n    y=alt.Y('total_orders:Q').aggregate(argmax='order_date'),\n    text=alt.Text('total_orders:Q', format='.0f')\n)\n\ntext = label.mark_text(align='left', dx=4)\ncircle = label.mark_circle()\nfinal_chart = line + circle + text\nfinal_chart",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_last_value_labeled.png"
    },
    {
        "type": "type_B",
        "db_id": "customers_and_invoices",
        "chart_category": "Distributions",
        "chart_type": "cumulative_count_chart",
        "NLQ": "I like this cumulative count chart showing movie data by IMDB rating, but I need something similar for our business data. Can you create a chart that shows the cumulative count of our orders over time? Use the date_order_placed column from our Orders table, and make it a blue area chart with Order Date on the x-axis and Cumulative Count of Orders on the y-axis.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/customers_and_invoices.sqlite')\n\nquery = '''\nSELECT \n    date_order_placed AS order_date\nFROM \n    Orders\nORDER BY \n    date_order_placed ASC\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\ncumulative_chart = alt.Chart(df).transform_window(\n    cumulative_count=\"count()\",\n    sort=[{\"field\": \"order_date\"}],\n).mark_area().encode(\n    x=alt.X(\"order_date:T\", title=\"Order Date\"),\n    y=alt.Y(\"cumulative_count:Q\", title=\"Cumulative Count of Orders\").stack(False)\n)\n\ncumulative_chart",
        "reference_path": "./vis_bench/img/Distributions___cumulative_count_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "customer_deliveries",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_logarithmic_scale",
        "NLQ": "I came across this line chart with a logarithmic scale, and I really like how it highlights growth trends. Could you create something similar to show the cumulative growth of our customer base over the years using the `date_became_customer` column from the Customers table? Please title it \"Customer Growth Over Time (Logarithmic Scale)\" and label the y-axis as \"Cumulative Number of Customers\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/customer_deliveries.sqlite')\n\nquery = '''\nSELECT\n    date(date_became_customer) AS year,\n    COUNT(customer_id) AS num_customers\nFROM Customers\nGROUP BY\n    year\nORDER BY\n    year;\n'''\n\ndf = pd.read_sql_query(query, conn)\ndf['cumulative_customers'] = df['num_customers'].cumsum()\nconn.close()\n\nalt.Chart(df).mark_line().encode(\n    x='year:O',\n    y=alt.Y('cumulative_customers', scale=alt.Scale(type=\"log\"), title='Cumulative Number of Customers')\n).properties(\n    title='Customer Growth Over Time (Logarithmic Scale)'\n)",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_logarithmic_scale.png"
    },
    {
        "type": "type_B",
        "db_id": "decoration_competition",
        "chart_category": "Advanced Calculations",
        "chart_type": "top_k_items",
        "NLQ": "Can you create a bar chart showing the top 5 colleges with the highest average rank in the decoration competition? I'd like the college names on the x-axis and their average rank on the y-axis, with the bars sorted from highest to lowest rank. Please use a blue color gradient for the bars where darker blue represents higher ranks.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/decoration_competition.sqlite')\n\nquery = '''\nSELECT \n    c.Name AS College_Name,\n    AVG(r.Rank_in_Round) AS Avg_Rank\nFROM \n    round AS r\nJOIN \n    member AS m ON r.Member_ID = m.Member_ID\nJOIN \n    college AS c ON m.College_ID = c.College_ID\nGROUP BY \n    c.College_ID\nORDER BY \n    Avg_Rank DESC\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    alt.X('College_Name:N').sort('-y'),\n    alt.Y('Avg_Rank:Q'),\n    alt.Color('Avg_Rank:Q')\n).transform_window(\n    rank='rank(Avg_Rank)',\n    sort=[alt.SortField('Avg_Rank', order='descending')]\n).transform_filter(\n    (alt.datum.rank < 6)\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Advanced Calculations___top_k_items.png"
    },
    {
        "type": "type_B",
        "db_id": "decoration_competition",
        "chart_category": "Distributions",
        "chart_type": "empirical_cumulative_distribution_function",
        "NLQ": "I like this dot chart showing questionnaire ratings, but I'd like to create a completely different visualization. Can you make a line chart that shows the cumulative distribution of ranks for different colleges in the decoration competition? I want to see which colleges tend to get better ranks, with each college shown as a different colored line. Please add a grid in the background and make the chart wider than it is tall.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/decoration_competition.sqlite')\n\nquery = '''\nSELECT \n    c.Name AS College_Name,\n    r.Rank_in_Round\nFROM \n    round AS r\nJOIN \n    member AS m ON r.Member_ID = m.Member_ID\nJOIN \n    college AS c ON m.College_ID = c.College_ID\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).transform_window(\n    ecdf=\"cume_dist()\",\n    sort=[{\"field\": \"Rank_in_Round\", \"order\": \"ascending\"}],\n    groupby=[\"College_Name\"]\n).mark_line().encode(\n    x=alt.X(\"Rank_in_Round:Q\", title=\"Rank in Round\"),\n    y=alt.Y(\"ecdf:Q\", title=\"Empirical Cumulative Distribution\"),\n    color=alt.Color(\"College_Name:N\", title=\"College\")\n).properties(\n    title=\"Empirical Cumulative Distribution of Ranks by College\",\n    width=600,\n    height=400\n)\n\nchart",
        "reference_path": "./vis_bench/img/Distributions___empirical_cumulative_distribution_function.png"
    },
    {
        "type": "type_B",
        "db_id": "department_management",
        "chart_category": "Advanced Calculations",
        "chart_type": "top_k_letters",
        "NLQ": "I came across this bar chart image that has a clean and professional style—love how it highlights the top categories. Can you create something similar to show the top 10 states with the most department heads born there, using the `head` table's `born_state` column? Make the bars horizontal instead of vertical, and sort them from highest to lowest count.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/department_management.sqlite')\n\nquery = '''\nSELECT h.born_state AS state, COUNT(*) AS head_count\nFROM head AS h\nGROUP BY h.born_state\nORDER BY head_count DESC\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).transform_window(\n    rank='rank(head_count)',\n    sort=[alt.SortField('head_count', order='descending')]\n).transform_filter(\n    alt.datum.rank < 11\n).mark_bar().encode(\n    y=alt.Y('state:N').sort('-x'),\n    x='head_count:Q'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Advanced Calculations___top_k_letters.png"
    },
    {
        "type": "type_B",
        "db_id": "department_management",
        "chart_category": "Distributions",
        "chart_type": "empirical_cumulative_distribution_function",
        "NLQ": "I need to create a completely different visualization. Can you make an ECDF chart showing the distribution of department budgets from the database? I'd like to see a step line chart with budget in billions on the x-axis and cumulative proportion on the y-axis. Please include a grid, make the y-axis go from 0 to 1, and title it \"Empirical Cumulative Distribution of Department Budgets\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/department_management.sqlite')\nquery = '''\nSELECT Budget_in_Billions\nFROM department\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\necdf_chart = alt.Chart(df).transform_window(\n    ecdf=\"cume_dist()\",\n    sort=[{\"field\": \"Budget_in_Billions\"}]\n).mark_line(interpolate='step-after').encode(\n    x=alt.X(\"Budget_in_Billions:Q\", title=\"Budget in Billions\"),\n    y=alt.Y(\"ecdf:Q\", title=\"Cumulative Proportion\", scale=alt.Scale(domain=[0, 1]))\n).properties(\n    title=\"Empirical Cumulative Distribution of Department Budgets\",\n    width=600,\n    height=400\n)\n\necdf_chart",
        "reference_path": "./vis_bench/img/Distributions___empirical_cumulative_distribution_function.png"
    },
    {
        "type": "type_B",
        "db_id": "department_store",
        "chart_category": "Advanced Calculations",
        "chart_type": "top_k_letters",
        "NLQ": "I came across this bar chart that has a clean and professional style—something like the \"Top K Letters\" design. Can you create a similar visualization showing the 10 products that customers buy the most, ranked by how often they're purchased? The data should come from the Products and Order_Items tables. But instead of vertical bars, make them horizontal with the product names on the y-axis. Also, change the color from light blue to a darker blue, and add grid lines to make it easier to read the values.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/department_store.sqlite')\nquery = '''\nSELECT \n    P.product_name AS product,\n    COUNT(OI.order_item_id) AS purchase_count\nFROM \n    Products AS P\nJOIN \n    Order_Items AS OI ON P.product_id = OI.product_id\nGROUP BY \n    P.product_name\nORDER BY \n    purchase_count DESC\nLIMIT 10;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    y=alt.Y('product:N', sort='-x', title='Product'),\n    x=alt.X('purchase_count:Q', title='Purchase Count')\n).properties(\n    title='Top 10 Most Frequently Purchased Products'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Advanced Calculations___top_k_letters.png"
    },
    {
        "type": "type_B",
        "db_id": "device",
        "chart_category": "Advanced Calculations",
        "chart_type": "top_k_letters",
        "NLQ": "I came across this bar chart image that ranks letters by frequency, and I really like its clean style. Could you create something similar but showing the top 5 software platforms used across devices? Make it a horizontal bar chart instead of vertical, with the platforms listed on the y-axis and the count on the x-axis.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/device.sqlite')\nquery = '''\nSELECT Software_Platform, COUNT(*) AS Platform_Count\nFROM device\nGROUP BY Software_Platform\nORDER BY Platform_Count DESC\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nalt.Chart(df).transform_window(\n    rank='rank(Platform_Count)',\n    sort=[alt.SortField('Platform_Count', order='descending')]\n).transform_filter(\n    alt.datum.rank < 6\n).mark_bar().encode(\n    y=alt.Y('Software_Platform:N').sort('-x'),\n    x='Platform_Count:Q'\n)",
        "reference_path": "./vis_bench/img/Advanced Calculations___top_k_letters.png"
    },
    {
        "type": "type_B",
        "db_id": "device",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_point_markers",
        "NLQ": "Can you create a simple line chart with points showing the number of shops opened each year? I'd like to see the trend over time using data from the shop table. Please use the Open_Year column on the x-axis and count the number of shops opened for each year. Add a clear title like \"Trend of Shop Openings Over Years\" and proper axis labels.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/device.sqlite')\nquery = \"\"\"\nSELECT Open_Year, COUNT(Shop_ID) AS Shop_Count\nFROM shop\nGROUP BY Open_Year\nORDER BY Open_Year\n\"\"\"\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_line(point=True).encode(\n    x=alt.X('Open_Year:O', title='Year Opened'),\n    y=alt.Y('Shop_Count:Q', title='Number of Shops Opened'),\n    tooltip=['Open_Year', 'Shop_Count']\n).properties(\n    title='Trend of Shop Openings Over Years'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_point_markers.png"
    },
    {
        "type": "type_B",
        "db_id": "document_management",
        "chart_category": "Advanced Calculations",
        "chart_type": "waterfall_chart",
        "NLQ": "I came across this waterfall chart that looks really professional, and I'd love to use a similar style to visualize how document access counts accumulate across different document structures. Could you also include the total count at the end for clarity?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/document_management.sqlite')\nquery = '''\nSELECT \n    DS.document_structure_description,\n    SUM(D.access_count) AS total_access_count\nFROM Documents AS D\nJOIN Document_Structures AS DS \n    ON D.document_structure_code = DS.document_structure_code\nGROUP BY DS.document_structure_description\nORDER BY DS.document_structure_code\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbegin_row = pd.DataFrame([{\"document_structure_description\": \"Begin\", \"total_access_count\": 0}])\nend_row = pd.DataFrame([{\"document_structure_description\": \"End\", \"total_access_count\": df['total_access_count'].sum()}])\ndf = pd.concat([begin_row, df, end_row], ignore_index=True)\n\namount = alt.datum.total_access_count\nlabel = alt.datum.document_structure_description\nwindow_lead_label = alt.datum.window_lead_label\nwindow_sum_amount = alt.datum.window_sum_amount\n\ncalc_prev_sum = alt.expr.if_(label == \"End\", 0, window_sum_amount - amount)\ncalc_amount = alt.expr.if_(label == \"End\", window_sum_amount, amount)\ncalc_text_amount = (\n    alt.expr.if_((label != \"Begin\") & (label != \"End\") & calc_amount > 0, \"+\", \"\")\n    + calc_amount\n)\n\nbase_chart = alt.Chart(df).transform_window(\n    window_sum_amount=\"sum(total_access_count)\",\n    window_lead_label=\"lead(document_structure_description)\",\n).transform_calculate(\n    calc_lead=alt.expr.if_((window_lead_label == None), label, window_lead_label),\n    calc_prev_sum=calc_prev_sum,\n    calc_amount=calc_amount,\n    calc_text_amount=calc_text_amount,\n    calc_center=(window_sum_amount + calc_prev_sum) / 2,\n    calc_sum_dec=alt.expr.if_(window_sum_amount < calc_prev_sum, window_sum_amount, \"\"),\n    calc_sum_inc=alt.expr.if_(window_sum_amount > calc_prev_sum, window_sum_amount, \"\"),\n).encode(\n    x=alt.X(\"document_structure_description:O\", axis=alt.Axis(title=\"Document Structure\", labelAngle=0), sort=None)\n)\n\ncolor_coding = (\n    alt.when((label == \"Begin\") | (label == \"End\"))\n    .then(alt.value(\"#878d96\"))\n    .when(calc_amount < 0)\n    .then(alt.value(\"#24a148\"))\n    .otherwise(alt.value(\"#fa4d56\"))\n)\n\nbar = base_chart.mark_bar(size=45).encode(\n    y=alt.Y(\"calc_prev_sum:Q\", title=\"Access Count\"),\n    y2=alt.Y2(\"window_sum_amount:Q\"),\n    color=color_coding,\n)\n\nrule = base_chart.mark_rule(xOffset=-22.5, x2Offset=22.5).encode(\n    y=\"window_sum_amount:Q\",\n    x2=\"calc_lead\",\n)\n\ntext_pos_values_top_of_bar = base_chart.mark_text(baseline=\"bottom\", dy=-4).encode(\n    text=alt.Text(\"calc_sum_inc:N\"),\n    y=\"calc_sum_inc:Q\",\n)\ntext_neg_values_bot_of_bar = base_chart.mark_text(baseline=\"top\", dy=4).encode(\n    text=alt.Text(\"calc_sum_dec:N\"),\n    y=\"calc_sum_dec:Q\",\n)\ntext_bar_values_mid_of_bar = base_chart.mark_text(baseline=\"middle\").encode(\n    text=alt.Text(\"calc_text_amount:N\"),\n    y=\"calc_center:Q\",\n    color=alt.value(\"white\"),\n)\n\nalt.layer(\n    bar,\n    rule,\n    text_pos_values_top_of_bar,\n    text_neg_values_bot_of_bar,\n    text_bar_values_mid_of_bar\n).properties(\n    width=800,\n    height=450\n)",
        "reference_path": "./vis_bench/img/Advanced Calculations___waterfall_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "document_management",
        "chart_category": "Distributions",
        "chart_type": "faceted_histogram",
        "NLQ": "I like this visualization showing horsepower distribution by car origin, but I need something different. Could you create a faceted histogram showing access counts for different document types? I'd like to see how access counts are distributed, with a separate histogram for each document type stacked vertically.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/document_management.sqlite')\n\nquery = '''\nSELECT \n    document_type_code AS Document_Type,\n    access_count AS Access_Count\nFROM \n    Documents\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    alt.X(\"Access_Count:Q\").bin(maxbins=30),\n    y=\"count()\",\n    row=\"Document_Type\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Distributions___faceted_histogram.png"
    },
    {
        "type": "type_B",
        "db_id": "document_management",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_point_markers",
        "NLQ": "I like this stock price chart, but could you create a similar line chart with points to show document access counts over time instead? I'd like to see how different document types (like Advertisement, Book, CV, and Paper) are being accessed each month. Please add a clear title like \"Total Access Count of Documents by Type Over Time\" and make sure the y-axis shows the total access count. Also, could you add a grid to make it easier to read the values?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/document_management.sqlite')\n\nquery = '''\nSELECT \n    strftime('%Y-%m', T1.document_code) AS month,\n    T1.document_type_code AS document_type,\n    SUM(T1.access_count) AS total_access_count\nFROM \n    Documents AS T1\nGROUP BY \n    month, document_type\nORDER BY \n    month ASC;\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_line(point=True).encode(\n    x=alt.X('month:T', title='Month'),\n    y=alt.Y('total_access_count:Q', title='Total Access Count'),\n    color=alt.Color('document_type:N', title='Document Type')\n).properties(\n    title='Total Access Count of Documents by Type Over Time'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_point_markers.png"
    },
    {
        "type": "type_B",
        "db_id": "dog_kennels",
        "chart_category": "Advanced Calculations",
        "chart_type": "waterfall_chart",
        "NLQ": "I need a waterfall chart showing our monthly treatment costs for the dog kennel. Can you use our database to pull the costs by month, starting at zero and showing how they add up over time? I'd like to see increases in red and decreases in green, with the values displayed on each bar. Make the chart wider and taller than this example, and angle the month labels so they're easier to read. Also, change the y-axis title to \"Cost of Treatment\" instead of \"Amount\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/dog_kennels.sqlite')\n\nquery = \"\"\"\nSELECT\n    STRFTIME('%Y-%m', date_of_treatment) AS treatment_month,\n    SUM(cost_of_treatment) AS monthly_cost\nFROM Treatments\nGROUP BY treatment_month\nORDER BY treatment_month;\n\"\"\"\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndata = []\ntotal_cost = 0\ndata.append({\"label\": \"Start\", \"amount\": 0})\n\nfor index, row in df.iterrows():\n    amount = row['monthly_cost']\n    total_cost += amount\n    data.append({\"label\": row['treatment_month'], \"amount\": amount})\n\ndata.append({\"label\": \"End\", \"amount\": 0})\n\nsource = pd.DataFrame(data)\n\namount = alt.datum.amount\nlabel = alt.datum.label\nwindow_lead_label = alt.datum.window_lead_label\nwindow_sum_amount = alt.datum.window_sum_amount\n\ncalc_prev_sum = alt.expr.if_(label == \"End\", 0, window_sum_amount - amount)\ncalc_amount = alt.expr.if_(label == \"End\", window_sum_amount, amount)\ncalc_text_amount = (\n    alt.expr.if_((label != \"Start\") & (label != \"End\") & calc_amount > 0, \"+\", \"\")\n    + calc_amount\n)\n\nbase_chart = alt.Chart(source).transform_window(\n    window_sum_amount=\"sum(amount)\",\n    window_lead_label=\"lead(label)\",\n).transform_calculate(\n    calc_lead=alt.expr.if_((window_lead_label == None), label, window_lead_label),\n    calc_prev_sum=calc_prev_sum,\n    calc_amount=calc_amount,\n    calc_text_amount=calc_text_amount,\n    calc_center=(window_sum_amount + calc_prev_sum) / 2,\n    calc_sum_dec=alt.expr.if_(window_sum_amount < calc_prev_sum, window_sum_amount, \"\"),\n    calc_sum_inc=alt.expr.if_(window_sum_amount > calc_prev_sum, window_sum_amount, \"\"),\n).encode(\n    x=alt.X(\"label:O\", axis=alt.Axis(title=\"Months\", labelAngle=45), sort=None)\n)\n\ncolor_coding = (\n    alt.when((label == \"Start\") | (label == \"End\"))\n    .then(alt.value(\"#878d96\"))\n    .when(calc_amount < 0)\n    .then(alt.value(\"#24a148\"))\n    .otherwise(alt.value(\"#fa4d56\"))\n)\n\nbar = base_chart.mark_bar(size=45).encode(\n    y=alt.Y(\"calc_prev_sum:Q\", title=\"Cost of Treatment\"),\n    y2=alt.Y2(\"window_sum_amount:Q\"),\n    color=color_coding,\n)\n\nrule = base_chart.mark_rule(xOffset=-22.5, x2Offset=22.5).encode(\n    y=\"window_sum_amount:Q\",\n    x2=\"calc_lead\",\n)\n\ntext_pos_values_top_of_bar = base_chart.mark_text(baseline=\"bottom\", dy=-4).encode(\n    text=alt.Text(\"calc_sum_inc:N\"),\n    y=\"calc_sum_inc:Q\",\n)\ntext_neg_values_bot_of_bar = base_chart.mark_text(baseline=\"top\", dy=4).encode(\n    text=alt.Text(\"calc_sum_dec:N\"),\n    y=\"calc_sum_dec:Q\",\n)\ntext_bar_values_mid_of_bar = base_chart.mark_text(baseline=\"middle\").encode(\n    text=alt.Text(\"calc_text_amount:N\"),\n    y=\"calc_center:Q\",\n    color=alt.value(\"white\"),\n)\n\nalt.layer(\n    bar,\n    rule,\n    text_pos_values_top_of_bar,\n    text_neg_values_bot_of_bar,\n    text_bar_values_mid_of_bar\n).properties(\n    width=800,\n    height=450\n)",
        "reference_path": "./vis_bench/img/Advanced Calculations___waterfall_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "dorm_1",
        "chart_category": "Advanced Calculations",
        "chart_type": "waterfall_chart",
        "NLQ": "I came across this waterfall chart that looks really professional, and I'd like to use a similar style to show the cumulative student capacity of our dormitories. Can you create one using the dorm names and their capacities from the Dorm table? I want to title it \"Cumulative Student Capacity Across Dormitories\" and show how each dorm contributes to the total capacity. Please use red for the increasing bars, gray for the start and total bars, and angle the dormitory labels for better readability. Also, make the chart wider than it is tall.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/dorm_1.sqlite')\n\nquery = '''\nSELECT dorm_name, student_capacity\nFROM Dorm\nORDER BY student_capacity;\n'''\n\ndf_dorm = pd.read_sql_query(query, conn)\nconn.close()\n\ndata = []\ndata.append({\"label\": \"Start\", \"amount\": 0})\nfor index, row in df_dorm.iterrows():\n    data.append({\"label\": row['dorm_name'], \"amount\": row['student_capacity']})\ntotal_capacity = df_dorm['student_capacity'].sum()\ndata.append({\"label\": \"Total\", \"amount\": total_capacity})\n\nsource = pd.DataFrame(data)\n\namount = alt.datum.amount\nlabel = alt.datum.label\nwindow_lead_label = alt.datum.window_lead_label\nwindow_sum_amount = alt.datum.window_sum_amount\n\ncalc_prev_sum = alt.expr.if_(label == \"Total\", 0, window_sum_amount - amount)\ncalc_amount = alt.expr.if_(label == \"Total\", window_sum_amount, amount)\ncalc_text_amount = (\n    alt.expr.if_((label != \"Start\") & (label != \"Total\") & calc_amount > 0, \"+\", \"\")\n    + calc_amount\n)\n\nbase_chart = alt.Chart(source).transform_window(\n    window_sum_amount=\"sum(amount)\",\n    window_lead_label=\"lead(label)\",\n).transform_calculate(\n    calc_lead=alt.expr.if_((window_lead_label == None), label, window_lead_label),\n    calc_prev_sum=calc_prev_sum,\n    calc_amount=calc_amount,\n    calc_text_amount=calc_text_amount,\n    calc_center=(window_sum_amount + calc_prev_sum) / 2,\n    calc_sum_dec=alt.expr.if_(window_sum_amount < calc_prev_sum, window_sum_amount, \"\"),\n    calc_sum_inc=alt.expr.if_(window_sum_amount > calc_prev_sum, window_sum_amount, \"\"),\n).encode(\n    x=alt.X(\"label:O\", axis=alt.Axis(title=\"Dormitory\", labelAngle=45), sort=None)\n)\n\ncolor_coding = (\n    alt.when((label == \"Start\") | (label == \"Total\"))\n    .then(alt.value(\"#878d96\"))\n    .when(calc_amount < 0)\n    .then(alt.value(\"#24a148\"))\n    .otherwise(alt.value(\"#fa4d56\"))\n)\n\nbar = base_chart.mark_bar(size=45).encode(\n    y=alt.Y(\"calc_prev_sum:Q\", title=\"Student Capacity\"),\n    y2=alt.Y2(\"window_sum_amount:Q\"),\n    color=color_coding,\n)\n\nrule = base_chart.mark_rule(xOffset=-22.5, x2Offset=22.5).encode(\n    y=\"window_sum_amount:Q\",\n    x2=\"calc_lead\",\n)\n\ntext_pos_values_top_of_bar = base_chart.mark_text(baseline=\"bottom\", dy=-4).encode(\n    text=alt.Text(\"calc_sum_inc:N\"),\n    y=\"calc_sum_inc:Q\",\n)\ntext_neg_values_bot_of_bar = base_chart.mark_text(baseline=\"top\", dy=4).encode(\n    text=alt.Text(\"calc_sum_dec:N\"),\n    y=\"calc_sum_dec:Q\",\n)\ntext_bar_values_mid_of_bar = base_chart.mark_text(baseline=\"middle\").encode(\n    text=alt.Text(\"calc_text_amount:N\"),\n    y=\"calc_center:Q\",\n    color=alt.value(\"white\"),\n)\n\nchart = alt.layer(\n    bar,\n    rule,\n    text_pos_values_top_of_bar,\n    text_neg_values_bot_of_bar,\n    text_bar_values_mid_of_bar\n).properties(\n    title='Cumulative Student Capacity Across Dormitories',\n    width=800,\n    height=450\n)\n\nchart",
        "reference_path": "./vis_bench/img/Advanced Calculations___waterfall_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "dorm_1",
        "chart_category": "Distributions",
        "chart_type": "heat_lane_chart",
        "NLQ": "Can you create a chart showing the distribution of student ages across different dorms? I'd like to see the dorm names listed vertically on the left side, with student ages shown horizontally. Use a blue-teal color scheme to indicate the number of students in each age group. Please title it \"Distribution of Student Ages Across Dorm Capacities\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/dorm_1.sqlite')\n\nquery = '''\nSELECT \n    Dorm.dorm_name AS dorm_name,\n    Dorm.student_capacity AS capacity,\n    Student.Age AS age\nFROM \n    Lives_in\nJOIN \n    Student ON Lives_in.stuid = Student.StuID\nJOIN \n    Dorm ON Lives_in.dormid = Dorm.dormid\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df, title=\"Distribution of Student Ages Across Dorm Capacities\", height=100, width=400).encode(\n    alt.X(\"bin_Age_start:Q\")\n        .title(\"Student Age\")\n        .axis(grid=False),\n    alt.X2(\"bin_Age_end:Q\"),\n    alt.Y(\"dorm_name:N\").title(\"Dorm Name\"),\n    alt.Y2(\"y2\"),\n).transform_bin(\n    [\"bin_Age_start\", \"bin_Age_end\"],\n    field='age'\n).transform_aggregate(\n    count='count()',\n    groupby=[\"bin_Age_start\", \"bin_Age_end\", \"dorm_name\"]\n).transform_bin(\n    [\"bin_count_start\", \"bin_count_end\"],\n    field='count'\n).transform_calculate(\n    y=\"datum.bin_count_end/2\",\n    y2=\"-datum.bin_count_end/2\",\n).transform_joinaggregate(\n    max_bin_count_end=\"max(bin_count_end)\",\n)\n\nlayer1 = chart.mark_bar(xOffset=1, x2Offset=-1, cornerRadius=3).encode(\n    alt.Color(\"max_bin_count_end:O\")\n        .title(\"Number of Students\")\n        .scale(scheme=\"lighttealblue\")\n)\nlayer2 = chart.mark_bar(xOffset=1, x2Offset=-1, yOffset=-3, y2Offset=3).encode(\n    alt.Color(\"bin_count_end:O\").title(\"Number of Students\")\n)\n\nlayer1 + layer2",
        "reference_path": "./vis_bench/img/Distributions___heat_lane_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "dorm_1",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_sequence_generator",
        "NLQ": "I need to create a simple line chart showing student count over time. Instead of the sine and cosine waves in the reference image, I want a straight line that increases over time from 0 to about 40. Please use a grid background, label the x-axis as \"time\" going from 0 to 10, and the y-axis as \"value\". Move the legend to the top right corner. I only need one line for now, but I'll eventually want to show different dorms and genders from our database.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/dorm_1.sqlite')\n\nquery = '''\nSELECT \n    T2.dorm_name AS dorm_name,\n    T2.gender AS gender,\n    COUNT(T1.stuid) AS student_count\nFROM \n    Lives_in AS T1\nJOIN \n    Dorm AS T2 ON T1.dormid = T2.dormid\nGROUP BY \n    T2.dorm_name, T2.gender\nORDER BY \n    T2.gender, T2.dorm_name;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ntime_sequence = alt.sequence(start=0, stop=10, step=0.5, as_='time')\n\nchart = alt.Chart(time_sequence).mark_line().transform_calculate(\n    student_count_simulated=f'datum.time * {df[\"student_count\"].mean()}'\n).transform_fold(\n    ['student_count_simulated']\n).encode(\n    x='time:Q',\n    y='value:Q',\n    color='gender:N',\n    detail='dorm_name:N'\n).transform_lookup(\n    lookup='dorm_name',\n    from_=alt.LookupData(data=df, key='dorm_name', fields=['gender', 'student_count'])\n)\n\nchart",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_sequence_generator.png"
    },
    {
        "type": "type_B",
        "db_id": "driving_school",
        "chart_category": "Advanced Calculations",
        "chart_type": "wilkinson_dot_plot",
        "NLQ": "Can you create a dot plot showing the distribution of lesson prices by vehicle type from our driving school database? I'd like to see different colors for each vehicle type (car, truck, van), add a title \"Distribution of Lesson Prices by Vehicle Type\", and label the x-axis as \"Lesson Price\" with a proper scale from 0 to 500.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/driving_school.sqlite')\n\nquery = '''\nSELECT V.vehicle_details AS vehicle_type, L.price\nFROM Lessons AS L\nJOIN Vehicles AS V ON L.vehicle_id = V.vehicle_id\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df, height=100).mark_circle(opacity=1).transform_window(\n    id='rank()',\n    groupby=['vehicle_type', 'price']\n).encode(\n    alt.X('price:Q', title='Lesson Price'),\n    alt.Y('id:O').axis(None).sort('descending'),\n    alt.Color('vehicle_type:N', title='Vehicle Type')\n).properties(\n    title='Distribution of Lesson Prices by Vehicle Type'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Advanced Calculations___wilkinson_dot_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "driving_school",
        "chart_category": "Distributions",
        "chart_type": "heat_lane_chart",
        "NLQ": "I came across this Heat Lane Chart that looks really clean and professional. Can you create something similar to show how driving lesson prices vary across different vehicle types? I'd like to see the price ranges for each vehicle type clearly. Change the title to \"Distribution of Lesson Prices by Vehicle Type\" and use a blue color scheme. Make it wider and shorter than the reference image, and show the number of lessons instead of number of models.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/driving_school.sqlite')\n\nquery = '''\nSELECT \n    Vehicles.vehicle_details AS vehicle_type, \n    Lessons.price AS lesson_price\nFROM \n    Lessons\nJOIN \n    Vehicles ON Lessons.vehicle_id = Vehicles.vehicle_id\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df, title=\"Distribution of Lesson Prices by Vehicle Type\", height=100, width=300).encode(\n    alt.X(\"bin_price_start:Q\")\n        .title(\"Lesson Price\")\n        .axis(grid=False),\n    alt.X2(\"bin_price_end:Q\"),\n    alt.Y(\"vehicle_type:N\").title(\"Vehicle Type\"),\n    alt.Y2(\"y2\"),\n).transform_bin(\n    [\"bin_price_start\", \"bin_price_end\"],\n    field='lesson_price',\n    bin=alt.Bin(maxbins=20)\n).transform_aggregate(\n    count='count()',\n    groupby=[\"vehicle_type\", \"bin_price_start\", \"bin_price_end\"]\n).transform_bin(\n    [\"bin_count_start\", \"bin_count_end\"],\n    field='count'\n).transform_calculate(\n    y=\"datum.bin_count_end/2\",\n    y2=\"-datum.bin_count_end/2\",\n).transform_joinaggregate(\n    max_bin_count_end=\"max(bin_count_end)\",\n    groupby=[\"vehicle_type\"]\n)\n\nlayer1 = chart.mark_bar(xOffset=1, x2Offset=-1, cornerRadius=3).encode(\n    alt.Color(\"max_bin_count_end:O\")\n        .title(\"Number of Lessons\")\n        .scale(scheme=\"lighttealblue\")\n)\nlayer2 = chart.mark_bar(xOffset=1, x2Offset=-1, yOffset=-3, y2Offset=3).encode(\n    alt.Color(\"bin_count_end:O\").title(\"Number of Lessons\")\n)\n\nlayer1 + layer2",
        "reference_path": "./vis_bench/img/Distributions___heat_lane_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "election",
        "chart_category": "Advanced Calculations",
        "chart_type": "wilkinson_dot_plot",
        "NLQ": "I came across this Wilkinson dot plot image that I really like the style of. Could you create something similar to show how many delegates each political party has, using the data from the election and party tables? I want to see which parties have more representation and compare them visually. Please put the party names on the x-axis and make the dots blue.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/election.sqlite')\n\nquery = '''\nSELECT p.Party, COUNT(e.Delegate) AS Delegate_Count\nFROM election AS e\nJOIN party AS p ON e.Party = p.Party_ID\nGROUP BY p.Party\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_circle(opacity=1).transform_window(\n    id='rank()',\n    groupby=['Party']\n).encode(\n    alt.X('Party:N', title='Political Party'),\n    alt.Y('id:O').axis(None).sort('descending')\n)\n\nchart",
        "reference_path": "./vis_bench/img/Advanced Calculations___wilkinson_dot_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "election",
        "chart_category": "Distributions",
        "chart_type": "heat_lane_chart",
        "NLQ": "I like this chart showing car horsepower distribution. Could you create a similar visualization but show population distribution by zip code instead? Use data from the county table, make the chart more compact in height, use a light teal-blue color scheme, and change the title to \"Population Distribution by Zip Code\". Also, can you make the bars have rounded corners?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/election.sqlite')\n\nquery = '''\nSELECT Zip_code, Population\nFROM county\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df, title=\"Population Distribution by Zip Code\", height=100, width=300).encode(\n    alt.X(\"bin_Population_start:Q\")\n        .title(\"Population\")\n        .axis(grid=False),\n    alt.X2(\"bin_Population_end:Q\"),\n    alt.Y(\"Zip_code:N\").title(\"Zip Code\"),\n).transform_bin(\n    [\"bin_Population_start\", \"bin_Population_end\"],\n    field='Population',\n    bin=alt.Bin(maxbins=20)\n).transform_aggregate(\n    count='count()',\n    groupby=[\"Zip_code\", \"bin_Population_start\", \"bin_Population_end\"]\n).transform_calculate(\n    y_offset=\"datum.count / 2\",\n    y2_offset=\"-datum.count / 2\",\n).mark_bar(xOffset=1, x2Offset=-1, cornerRadius=3).encode(\n    alt.Color(\"count:Q\")\n        .title(\"Number of Counties\")\n        .scale(scheme=\"lighttealblue\")\n)\n\nchart",
        "reference_path": "./vis_bench/img/Distributions___heat_lane_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "election_representative",
        "chart_category": "Advanced Calculations",
        "chart_type": "wilkinson_dot_plot",
        "NLQ": "I like this dot plot, but could you make one that shows the number of seats won by each political party? Please arrange the parties horizontally along the x-axis instead of using numbers, and sort them from the party with the most seats to the least. Also, make the dots stack vertically for each party.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/election_representative.sqlite')\nquery = '''\nSELECT r.Party, SUM(e.Seats) AS Total_Seats\nFROM election AS e\nJOIN representative AS r ON e.Representative_ID = r.Representative_ID\nGROUP BY r.Party\nORDER BY Total_Seats DESC\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndot_data = []\nfor _, row in df.iterrows():\n    dot_data.extend([row['Party']] * int(row['Total_Seats']))\n\ndot_df = pd.DataFrame({'Party': dot_data})\n\nchart = alt.Chart(dot_df, height=100).mark_circle(opacity=1).transform_window(\n    id='rank()',\n    groupby=['Party']\n).encode(\n    alt.X('Party:N', title='Political Party'),\n    alt.Y('id:O').axis(None).sort('descending')\n)\n\nchart",
        "reference_path": "./vis_bench/img/Advanced Calculations___wilkinson_dot_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "employee_hire_evaluation",
        "chart_category": "Area Charts",
        "chart_type": "area_chart_with_gradient",
        "NLQ": "I came across this area chart with a gradient fill that looks really professional. Can you create something similar to show the total bonuses awarded to employees from Bristol over the years, with the trend highlighted using a dark blue to white gradient instead of green?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/employee_hire_evaluation.sqlite')\n\nquery = '''\nSELECT e.City, ev.Year_awarded, SUM(ev.Bonus) AS Total_Bonus\nFROM employee AS e\nJOIN evaluation AS ev ON e.Employee_ID = ev.Employee_ID\nWHERE e.City = 'Bristol'\nGROUP BY ev.Year_awarded\nORDER BY ev.Year_awarded\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_area(\n    line={'color': 'darkblue'},\n    color=alt.Gradient(\n        gradient='linear',\n        stops=[alt.GradientStop(color='white', offset=0),\n               alt.GradientStop(color='darkblue', offset=1)],\n        x1=1,\n        x2=1,\n        y1=1,\n        y2=0\n    )\n).encode(\n    alt.X('Year_awarded:T', title='Year'),\n    alt.Y('Total_Bonus:Q', title='Total Bonus Awarded')\n).properties(\n    title='Total Bonuses Awarded Over Years for Employees from Bristol'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Area Charts___area_chart_with_gradient.png"
    },
    {
        "type": "type_B",
        "db_id": "entertainment_awards",
        "chart_category": "Area Charts",
        "chart_type": "area_chart_with_gradient",
        "NLQ": "I came across this area chart with a gradient that looks really professional—love how it transitions from white at the bottom to dark blue at the top. Can you create something similar to show how the total number of festival audiences in the United States has changed over the years?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/entertainment_awards.sqlite')\nquery = '''\nSELECT Year, SUM(Num_of_Audience) AS Total_Audience\nFROM festival_detail\nWHERE Location = 'United States'\nGROUP BY Year\nORDER BY Year\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_area(\n    line={'color': 'darkblue'},\n    color=alt.Gradient(\n        gradient='linear',\n        stops=[alt.GradientStop(color='white', offset=0),\n               alt.GradientStop(color='darkblue', offset=1)],\n        x1=1,\n        x2=1,\n        y1=1,\n        y2=0\n    )\n).encode(\n    alt.X('Year:T', title='Year'),\n    alt.Y('Total_Audience:Q', title='Total Number of Audiences')\n)\n\nchart",
        "reference_path": "./vis_bench/img/Area Charts___area_chart_with_gradient.png"
    },
    {
        "type": "type_B",
        "db_id": "entrepreneur",
        "chart_category": "Area Charts",
        "chart_type": "area_chart_with_gradient",
        "NLQ": "I like this stock price chart with the green area fill, but can you change it to show the total money requested by entrepreneurs based on their birth dates, focusing only on Duncan Bannatyne's investments? I'd prefer a blue gradient area chart instead of green, with birth dates on the x-axis and the money amounts on the y-axis.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/entrepreneur.sqlite')\n\nquery = '''\nSELECT \n    p.Date_of_Birth AS date,\n    e.Investor AS investor,\n    SUM(e.Money_Requested) AS total_money_requested\nFROM entrepreneur AS e\nJOIN people AS p ON e.People_ID = p.People_ID\nGROUP BY p.Date_of_Birth, e.Investor\nORDER BY p.Date_of_Birth\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).transform_filter(\n    'datum.investor === \"Duncan Bannatyne\"'\n).mark_area(\n    line={'color': 'darkblue'},\n    color=alt.Gradient(\n        gradient='linear',\n        stops=[alt.GradientStop(color='white', offset=0),\n               alt.GradientStop(color='darkblue', offset=1)],\n        x1=1,\n        x2=1,\n        y1=1,\n        y2=0\n    )\n).encode(\n    alt.X('date:T', title='Date of Birth'),\n    alt.Y('total_money_requested:Q', title='Cumulative Money Requested')\n)\n\nchart",
        "reference_path": "./vis_bench/img/Area Charts___area_chart_with_gradient.png"
    },
    {
        "type": "type_B",
        "db_id": "entrepreneur",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_varying_size",
        "NLQ": "I like this line chart showing wheat prices over time, but I'd like to see something different. Could you create a chart showing how much money entrepreneurs have requested from different investors? Put the investors on the x-axis and the total money requested on the y-axis. Instead of a regular line, could you make the line thickness vary based on the amount requested, so thicker parts represent larger amounts?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/entrepreneur.sqlite')\n\nquery = '''\nSELECT \n    Investor, \n    SUM(Money_Requested) AS Total_Money_Requested\nFROM \n    entrepreneur\nGROUP BY \n    Investor\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_trail().encode(\n    x='Investor:N',\n    y='Total_Money_Requested:Q',\n    size='Total_Money_Requested:Q'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_varying_size.png"
    },
    {
        "type": "type_B",
        "db_id": "epinions_1",
        "chart_category": "Area Charts",
        "chart_type": "faceted_area_chart",
        "NLQ": "I like this chart showing stock prices over time, but could you change it to show user ratings data instead? I'd like to see the total ratings for each rank (from 1-7), with a separate area chart for each user. Please stack them vertically with the user's name on the y-axis, and add a grid to make it easier to read. Also, use different colors for each user like orange and blue.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/epinions_1.sqlite')\n\nquery = '''\nSELECT \n    ua.name AS user_name,\n    r.rank AS rank,\n    SUM(r.rating) AS total_rating\nFROM \n    review AS r\nJOIN \n    useracct AS ua ON r.u_id = ua.u_id\nGROUP BY \n    ua.name, r.rank\nORDER BY \n    ua.name, r.rank\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_area().encode(\n    x=alt.X(\"rank:Q\", title=\"Rank\"),\n    y=alt.Y(\"total_rating:Q\", title=\"Total Rating\"),\n    color=alt.Color(\"user_name:N\", title=\"User\"),\n    row=alt.Row(\"user_name:N\", title=\"User\", sort=alt.EncodingSortField(field=\"total_rating\", op=\"sum\", order=\"descending\"))\n).properties(\n    height=50,\n    width=400\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Area Charts___faceted_area_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "epinions_1",
        "chart_category": "Distributions",
        "chart_type": "histogram_with_gradient_color",
        "NLQ": "Can you create a histogram showing the distribution of trust scores from the trust table in the database? I'd like to use a pink-yellow-green color gradient to show the different trust values, with trust scores on the x-axis from 0 to 10 and the count of records on the y-axis. Please make sure to bin the trust scores into about 20 intervals.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/epinions_1.sqlite')\nquery = '''\nSELECT trust\nFROM trust\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    alt.X(\"trust:Q\").bin(maxbins=20).scale(domain=[0, 10]),\n    alt.Y('count()'),\n    alt.Color(\"trust:Q\").bin(maxbins=20).scale(scheme='pinkyellowgreen')\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___histogram_with_gradient_color.png"
    },
    {
        "type": "type_B",
        "db_id": "e_learning",
        "chart_category": "Area Charts",
        "chart_type": "faceted_area_chart",
        "NLQ": "I like this stock price visualization showing different companies, but I'd like to create something similar for our e-learning data. Can you make a faceted area chart showing the number of students completing courses over time for each subject? I'd like to see one chart stacked vertically for each subject, with completion months on the x-axis and student count on the y-axis. Please add a grid background and use different colors for each subject.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/e_learning.sqlite')\n\nquery = '''\nSELECT \n    Subjects.subject_name AS subject,\n    strftime('%Y-%m', Student_Course_Enrolment.date_of_completion) AS completion_month,\n    COUNT(Student_Course_Enrolment.student_id) AS student_count\nFROM \n    Student_Course_Enrolment\nJOIN \n    Courses ON Student_Course_Enrolment.course_id = Courses.course_id\nJOIN \n    Subjects ON Courses.subject_id = Subjects.subject_id\nWHERE \n    Student_Course_Enrolment.date_of_completion IS NOT NULL\nGROUP BY \n    Subjects.subject_name, completion_month\nORDER BY \n    Subjects.subject_name, completion_month;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_area().encode(\n    x=alt.X(\"completion_month:T\", title=\"Completion Month\"),\n    y=alt.Y(\"student_count:Q\", title=\"Number of Students\"),\n    color=alt.Color(\"subject:N\", title=\"Subject\"),\n    row=alt.Row(\"subject:N\", title=\"Subject\")\n).properties(\n    height=100,\n    width=400\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Area Charts___faceted_area_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "e_learning",
        "chart_category": "Line Charts",
        "chart_type": "multiple_series_line_chart",
        "NLQ": "I like this stock price chart, but could you create a similar line chart that shows course completion data instead? I'd like to see the number of course completions over time for different subjects like Arts, Computer Science, and Language. Please put the completion months on the x-axis, number of completions on the y-axis, and give each subject its own colored line. Also, add a title that explains what the chart is showing.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/e_learning.sqlite')\n\nquery = '''\nSELECT \n    Subjects.subject_name AS subject,\n    strftime('%Y-%m', Student_Course_Enrolment.date_of_completion) AS completion_month,\n    COUNT(Student_Course_Enrolment.registration_id) AS completions\nFROM \n    Student_Course_Enrolment\nJOIN \n    Courses ON Student_Course_Enrolment.course_id = Courses.course_id\nJOIN \n    Subjects ON Courses.subject_id = Subjects.subject_id\nWHERE \n    Student_Course_Enrolment.date_of_completion IS NOT NULL\nGROUP BY \n    Subjects.subject_name, completion_month\nORDER BY \n    completion_month ASC;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_line().encode(\n    x=alt.X('completion_month:T', title='Completion Month'),\n    y=alt.Y('completions:Q', title='Number of Completions'),\n    color=alt.Color('subject:N', title='Subject')\n).properties(\n    title='Number of Course Completions Over Time by Subject'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Line Charts___multiple_series_line_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "farm",
        "chart_category": "Area Charts",
        "chart_type": "horizon_graph",
        "NLQ": "Can you create a horizon chart showing the total cattle population over the years from 1957 to 1964? I'd like it to have a smoother, more curved line with a blue color scheme. Please use years on the x-axis and make the y-axis show total cattle with a range of 0-5000. Could you also make it wider than it is tall and add proper axis labels?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/farm.sqlite')\n\nquery = '''\nSELECT Year, Total_Cattle\nFROM farm\nORDER BY Year\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\narea1 = alt.Chart(df).mark_area(\n    clip=True,\n    interpolate='monotone',\n    opacity=0.6\n).encode(\n    alt.X('Year:O').scale(zero=False, nice=False),\n    alt.Y('Total_Cattle:Q').scale(domain=[0, 5000]).title('Total Cattle (0-5000)'),\n).properties(\n    width=500,\n    height=75\n)\n\narea2 = area1.encode(\n    alt.Y('ny:Q').scale(domain=[0, 5000])\n).transform_calculate(\n    \"ny\", alt.datum.Total_Cattle - 5000\n)\n\narea1 + area2",
        "reference_path": "./vis_bench/img/Area Charts___horizon_graph.png"
    },
    {
        "type": "type_B",
        "db_id": "film_rank",
        "chart_category": "Area Charts",
        "chart_type": "horizon_graph",
        "NLQ": "I like this horizon graph style, but could you create one showing film gross revenue by country? Please use our film database to show total gross revenue for each country, with the top countries like China and USA. Make it a smooth area chart with a blue color scheme and proper axis labels showing the revenue amounts in dollars.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/film_rank.sqlite')\n\nquery = '''\nSELECT \n    m.Country AS Country,\n    SUM(f.Gross_in_dollar) AS Total_Gross\nFROM \n    film_market_estimation AS fme\nJOIN \n    film AS f ON fme.Film_ID = f.Film_ID\nJOIN \n    market AS m ON fme.Market_ID = m.Market_ID\nGROUP BY \n    m.Country\nORDER BY \n    Total_Gross DESC;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).mark_area(\n    clip=True,\n    interpolate='monotone',\n    opacity=0.6\n).encode(\n    alt.X('Country:N').title('Country'),\n    alt.Y('Total_Gross:Q').scale(domain=[0, df['Total_Gross'].max() / 2]).title('Gross Revenue (Top Half)'),\n).properties(\n    width=500,\n    height=75\n)\n\ntop_half = base\n\nbottom_half = base.encode(\n    alt.Y('ny:Q').scale(domain=[0, df['Total_Gross'].max() / 2]).title('Gross Revenue (Bottom Half)')\n).transform_calculate(\n    \"ny\", alt.datum.Total_Gross - df['Total_Gross'].max() / 2\n)\n\ntop_half + bottom_half",
        "reference_path": "./vis_bench/img/Area Charts___horizon_graph.png"
    },
    {
        "type": "type_B",
        "db_id": "flight_1",
        "chart_category": "Area Charts",
        "chart_type": "horizon_graph",
        "NLQ": "I like this horizon chart style, but could you create one showing the total distance flown by each aircraft type from our flight database? Use a smoother blue area chart with a 5,000 mile threshold, where distances above 5,000 would appear in the bottom panel. Please label the x-axis as \"Aircraft Type\" and the y-axis as \"Distance (miles)\" and make the chart wider but not too tall.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/flight_1.sqlite')\nquery = '''\nSELECT \n    a.name AS aircraft_name,\n    SUM(f.distance) AS total_distance\nFROM \n    flight AS f\nJOIN \n    aircraft AS a ON f.aid = a.aid\nGROUP BY \n    a.name\nORDER BY \n    total_distance DESC;\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\narea1 = alt.Chart(df).mark_area(\n    clip=True,\n    interpolate='monotone',\n    opacity=0.6\n).encode(\n    alt.X('aircraft_name:N').title('Aircraft Type'),\n    alt.Y('total_distance:Q').scale(domain=[0, 5000]).title('Distance (miles)'),\n).properties(\n    width=500,\n    height=75\n)\n\narea2 = area1.encode(\n    alt.Y('adjusted_distance:Q').scale(domain=[0, 5000])\n).transform_calculate(\n    \"adjusted_distance\", alt.datum.total_distance - 5000\n)\n\nfinal_chart = area1 + area2\nfinal_chart",
        "reference_path": "./vis_bench/img/Area Charts___horizon_graph.png"
    },
    {
        "type": "type_B",
        "db_id": "game_injury",
        "chart_category": "Area Charts",
        "chart_type": "normalized_stacked_area_chart",
        "NLQ": "I like this chart showing energy sources over time, but could you create something similar using our game data instead? I'd like to see how the proportion of different competitions (Cup, League, Supercup) has changed across seasons. Make it a normalized stacked area chart with the seasons on the x-axis and label the y-axis as \"Proportion of Games\".",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/game_injury.sqlite')\nquery = \"\"\"\nSELECT\n  Season,\n  Competition,\n  COUNT(id) AS game_count\nFROM game\nGROUP BY Season, Competition\nORDER BY Season, Competition\n\"\"\"\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_area().encode(\n    x=alt.X('Season:O', title='Season'),\n    y=alt.Y('game_count:Q', stack='normalize', title='Proportion of Games'),\n    color='Competition:N'\n).properties(\n    title='Proportion of Game Competitions Over Seasons'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Area Charts___normalized_stacked_area_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "gymnast",
        "chart_category": "Area Charts",
        "chart_type": "normalized_stacked_area_chart",
        "NLQ": "I like this chart showing energy sources, but could you create a similar normalized stacked area chart using gymnast data instead? I'd like to see how different gymnasts' points are distributed across events like Floor Exercise, Pommel Horse, Rings, Vault, Parallel Bars, and Horizontal Bar. Use Gymnast ID on the x-axis and make the title \"Normalized Distribution of Points Across Gymnastic Events\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/gymnast.sqlite')\n\nquery = '''\nSELECT \n    Gymnast_ID,\n    Floor_Exercise_Points AS Floor,\n    Pommel_Horse_Points AS Pommel_Horse,\n    Rings_Points AS Rings,\n    Vault_Points AS Vault,\n    Parallel_Bars_Points AS Parallel_Bars,\n    Horizontal_Bar_Points AS Horizontal_Bar\nFROM \n    gymnast\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndf_long = df.melt(id_vars=['Gymnast_ID'], \n                  value_vars=['Floor', 'Pommel_Horse', 'Rings', 'Vault', 'Parallel_Bars', 'Horizontal_Bar'],\n                  var_name='Event', value_name='Points')\n\nchart = alt.Chart(df_long).mark_area().encode(\n    x=alt.X(\"Gymnast_ID:N\", title=\"Gymnast ID\"),\n    y=alt.Y(\"Points:Q\").stack(\"normalize\"),\n    color=\"Event:N\"\n).properties(\n    title=\"Normalized Distribution of Points Across Gymnastic Events\"\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Area Charts___normalized_stacked_area_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "gymnast",
        "chart_category": "Distributions",
        "chart_type": "repeated_density_estimates",
        "NLQ": "I like this density plot showing distributions, but could you create one specifically for gymnast scores? I'd like to see the distribution of scores for each event (Floor, Pommel Horse, Rings, Vault, Parallel Bars, and Horizontal Bar) stacked vertically. Please use a darker blue color for the areas, focus on the score range between 8 and 10, and label the x-axis as \"Score\" instead of \"Value\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/gymnast.sqlite')\n\nquery = '''\nSELECT \n    Floor_Exercise_Points AS Floor,\n    Pommel_Horse_Points AS Pommel_Horse,\n    Rings_Points AS Rings,\n    Vault_Points AS Vault,\n    Parallel_Bars_Points AS Parallel_Bars,\n    Horizontal_Bar_Points AS Horizontal_Bar\nFROM gymnast\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).transform_fold(\n    [\"Floor\", \"Pommel_Horse\", \"Rings\", \"Vault\", \"Parallel_Bars\", \"Horizontal_Bar\"],\n    as_=[\"Event\", \"Score\"]\n).transform_density(\n    density=\"Score\",\n    bandwidth=0.1,\n    groupby=[\"Event\"],\n    extent=[8, 10]\n).mark_area().encode(\n    alt.X(\"value:Q\", title=\"Score\"),\n    alt.Y(\"density:Q\", title=\"Density\"),\n    alt.Row(\"Event:N\")\n).properties(\n    width=300, height=50\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___repeated_density_estimates.png"
    },
    {
        "type": "type_B",
        "db_id": "insurance_and_eClaims",
        "chart_category": "Bar Charts",
        "chart_type": "bar_and_tick_chart",
        "NLQ": "Can you create a chart showing the total amount claimed for each claim type as blue bars, and overlay red tick marks to show the average amount paid? I'd like to see the data from the Claim_Headers table, with claim types on the x-axis and the amounts on the y-axis.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/insurance_and_eClaims.sqlite')\n\nquery = '''\nSELECT \n    Claim_Type_Code AS claim_type,\n    SUM(Amount_Claimed) AS total_claimed,\n    AVG(Amount_Piad) AS avg_paid\nFROM \n    Claim_Headers\nGROUP BY \n    Claim_Type_Code\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbar = alt.Chart(df).mark_bar().encode(\n    x=alt.X('claim_type:N', title='Claim Type'),\n    y=alt.Y('total_claimed:Q', title='Total Amount Claimed')\n).properties(\n    width=alt.Step(40)\n)\n\ntick = alt.Chart(df).mark_tick(\n    color='red',\n    thickness=2,\n    size=40 * 0.9\n).encode(\n    x=alt.X('claim_type:N', title='Claim Type'),\n    y=alt.Y('avg_paid:Q', title='Average Amount Paid')\n)\n\nchart = bar + tick\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___bar_and_tick_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "insurance_and_eClaims",
        "chart_category": "Distributions",
        "chart_type": "ridgeline_plot",
        "NLQ": "I came across this ridgeline plot image that looks really sleek, especially how it shows distributions stacked on top of each other. Can you create something similar to visualize the distribution of claim amounts across different claim statuses using our claims data? I'd like to use a blue, green, and orange color scheme instead of the yellow, add light gray borders to each area, and make the plot horizontal with claim status labels on the left side. Also, please add a clear title at the top.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/insurance_and_eClaims.sqlite')\n\nquery = '''\nSELECT Claim_Status_Code, Amount_Claimed\nFROM Claim_Headers\nWHERE Amount_Claimed IS NOT NULL\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nstep = 20\noverlap = 1\n\nchart = alt.Chart(df, height=step).transform_density(\n    'Amount_Claimed',\n    groupby=['Claim_Status_Code'],\n    as_=['Amount_Claimed', 'density'],\n    extent=[0, df['Amount_Claimed'].max()],\n    bandwidth=50\n).mark_area(\n    interpolate='monotone',\n    fillOpacity=0.8,\n    stroke='lightgray',\n    strokeWidth=0.5\n).encode(\n    alt.X('Amount_Claimed:Q').title('Claim Amount'),\n    alt.Y('density:Q')\n        .axis(None)\n        .scale(range=[step, -step * overlap]),\n    alt.Fill('Claim_Status_Code:N')\n        .legend(None)\n        .scale(scheme='category10')\n).facet(\n    row=alt.Row('Claim_Status_Code:N')\n        .title(None)\n        .header(labelAngle=0, labelAlign='left')\n).properties(\n    title='Distribution of Claim Amounts by Claim Status',\n    bounds='flush'\n).configure_facet(\n    spacing=0\n).configure_view(\n    stroke=None\n).configure_title(\n    anchor='end'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___ridgeline_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "insurance_fnol",
        "chart_category": "Bar Charts",
        "chart_type": "bar_and_tick_chart",
        "NLQ": "I came across this bar chart with a red tick mark indicating an average, and I really like the style. Can you create something similar that shows how many claims each customer has filed, with the average number of claims marked on the chart? I'd like to see customer names on the x-axis and total claims on the y-axis.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/insurance_fnol.sqlite')\n\nquery = '''\nSELECT \n    C.Customer_name AS customer_name,\n    COUNT(Cl.Claim_ID) AS total_claims\nFROM \n    Customers AS C\nJOIN \n    First_Notification_of_Loss AS FNOL ON C.Customer_ID = FNOL.Customer_ID\nJOIN \n    Claims AS Cl ON FNOL.FNOL_ID = Cl.FNOL_ID\nGROUP BY \n    C.Customer_ID\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\naverage_claims = df['total_claims'].mean()\ndf['average_claims'] = average_claims\n\nbar = alt.Chart(df).mark_bar().encode(\n    x=alt.X('customer_name:N', title='Customer Name'),\n    y=alt.Y('total_claims:Q', title='Total Claims')\n).properties(\n    width=alt.Step(40)\n)\n\ntick = alt.Chart(df).mark_tick(\n    color='red',\n    thickness=2,\n    size=40 * 0.9\n).encode(\n    x=alt.X('customer_name:N', title='Customer Name'),\n    y=alt.Y('average_claims:Q', title='Average Claims')\n)\n\nchart = bar + tick\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___bar_and_tick_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "insurance_fnol",
        "chart_category": "Distributions",
        "chart_type": "ridgeline_plot",
        "NLQ": "I like this ridgeline plot showing temperature distributions by month. Could you create a similar visualization but showing settlement amounts distributed across different insurance policy types from our database? Use different colors for each policy type, add a clear title, and make sure the x-axis shows the settlement amounts.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/insurance_fnol.sqlite')\n\nquery = '''\nSELECT\n    ap.policy_type_code,\n    s.Settlement_Amount\nFROM\n    Available_Policies AS ap\nJOIN\n    First_Notification_of_Loss AS fnol ON ap.Policy_ID = fnol.Policy_ID\nJOIN\n    Claims AS c ON fnol.FNOL_ID = c.FNOL_ID\nJOIN\n    Settlements AS s ON c.Claim_ID = s.Claim_ID;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nstep = 20\noverlap = 1\n\nchart = alt.Chart(df, height=step).transform_bin(\n    ['bin_amount_min', 'bin_amount_max'], 'Settlement_Amount'\n).transform_aggregate(\n    value='count()', groupby=['policy_type_code', 'bin_amount_min', 'bin_amount_max']\n).transform_impute(\n    impute='value', groupby=['policy_type_code'], key='bin_amount_min', value=0\n).mark_area(\n    interpolate='monotone',\n    fillOpacity=0.8,\n    stroke='lightgray',\n    strokeWidth=0.5\n).encode(\n    alt.X('bin_amount_min:Q')\n        .bin('binned')\n        .title('Settlement Amount'),\n    alt.Y('value:Q')\n        .axis(None)\n        .scale(range=[step, -step * overlap]),\n    alt.Fill('policy_type_code:N')\n        .legend(None)\n).facet(\n    row=alt.Row('policy_type_code:N')\n        .title(None)\n        .header(labelAngle=0, labelAlign='left')\n).properties(\n    title='Distribution of Settlement Amounts by Policy Type',\n    bounds='flush'\n).configure_facet(\n    spacing=0\n).configure_view(\n    stroke=None\n).configure_title(\n    anchor='end'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___ridgeline_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "insurance_policies",
        "chart_category": "Bar Charts",
        "chart_type": "bar_and_tick_chart",
        "NLQ": "Can you create a chart showing the total amount claimed versus the total amount settled for different insurance policy types? I'd like blue bars to represent the claimed amounts and red tick marks to show the settled amounts. Please use policy type codes on the x-axis and make the y-axis show currency values. Keep the design clean and simple.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/insurance_policies.sqlite')\nquery = '''\nSELECT \n    CP.Policy_Type_Code AS Policy_Type,\n    SUM(C.Amount_Claimed) AS Total_Amount_Claimed,\n    SUM(C.Amount_Settled) AS Total_Amount_Settled\nFROM \n    Customer_Policies AS CP\nJOIN \n    Claims AS C ON CP.Policy_ID = C.Policy_ID\nGROUP BY \n    CP.Policy_Type_Code\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbar = alt.Chart(df).mark_bar().encode(\n    x='Policy_Type',\n    y='Total_Amount_Claimed'\n).properties(\n    width=alt.Step(40)\n)\n\ntick = alt.Chart(df).mark_tick(\n    color='red',\n    thickness=2,\n    size=40 * 0.9,\n).encode(\n    x='Policy_Type',\n    y='Total_Amount_Settled'\n)\n\nchart = bar + tick\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___bar_and_tick_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "insurance_policies",
        "chart_category": "Distributions",
        "chart_type": "scatter_plot_with_faceted_marginal_histograms",
        "NLQ": "Can you create a scatter plot showing the relationship between claimed amounts and settled amounts from our insurance database? I'd like to see different policy types in different colors, and include histograms on the top and right sides to show the distributions. Make the plot clean with a light background and grid lines.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/insurance_policies.sqlite')\nquery = '''\nSELECT\n    C.Amount_Claimed,\n    C.Amount_Settled,\n    CP.Policy_Type_Code\nFROM\n    Claims AS C\nJOIN\n    Customer_Policies AS CP ON C.Policy_ID = CP.Policy_ID\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df)\nbase_bar = base.mark_bar(opacity=0.3, binSpacing=0)\n\npoints = base.mark_circle().encode(\n    alt.X(\"Amount_Claimed:Q\"),\n    alt.Y(\"Amount_Settled:Q\"),\n    color=\"Policy_Type_Code:N\",\n)\n\ntop_hist = (\n    base_bar\n    .encode(\n        alt.X(\"Amount_Claimed:Q\")\n            .bin(maxbins=20).stack(None).title(\"\"),\n        alt.Y(\"count()\").stack(None).title(\"\"),\n        alt.Color(\"Policy_Type_Code:N\"),\n    )\n    .properties(height=60)\n)\n\nright_hist = (\n    base_bar\n    .encode(\n        alt.Y(\"Amount_Settled:Q\")\n            .bin(maxbins=20)\n            .stack(None)\n            .title(\"\"),\n        alt.X(\"count()\").stack(None).title(\"\"),\n        alt.Color(\"Policy_Type_Code:N\"),\n    )\n    .properties(width=60)\n)\n\nchart = top_hist & (points | right_hist)\nchart",
        "reference_path": "./vis_bench/img/Distributions___scatter_plot_with_faceted_marginal_histograms.png"
    },
    {
        "type": "type_B",
        "db_id": "journal_committee",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_highlighting_values_beyond_a_threshold",
        "NLQ": "I like this chart showing daily values with a hazardous threshold line, but could you adapt it to show journal sales by theme instead? I'd like to see which journal themes exceed 2,000 sales, with those high performers highlighted in red. Keep the blue color for the bars below the threshold, but add a dashed line at 2,000 labeled \"High Sales Threshold\" instead of \"hazardous\". Also, please add a title \"Journal Sales by Theme with Highlighted High Performers\" and make sure the axes are properly labeled.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/journal_committee.sqlite')\n\nquery = '''\nSELECT Theme, SUM(Sales) AS Total_Sales\nFROM journal\nGROUP BY Theme\nORDER BY Total_Sales DESC\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nthreshold = 2000\n\nbars = alt.Chart(df).mark_bar(color=\"steelblue\").encode(\n    x=alt.X(\"Theme:N\", title=\"Journal Theme\"),\n    y=alt.Y(\"Total_Sales:Q\", title=\"Total Sales\")\n)\n\nhighlight = bars.mark_bar(color=\"#e45755\").encode(\n    y2=alt.Y2(datum=threshold)\n).transform_filter(\n    alt.datum.Total_Sales > threshold\n)\n\nrule = alt.Chart().mark_rule(color=\"black\", strokeDash=[3, 5]).encode(\n    y=alt.Y(datum=threshold)\n)\n\nlabel = rule.mark_text(\n    x=\"width\",\n    dx=-2,\n    align=\"right\",\n    baseline=\"bottom\",\n    text=\"High Sales Threshold\"\n)\n\nchart = (bars + highlight + rule + label).properties(\n    title=\"Journal Sales by Theme with Highlighted High Performers\"\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_highlighting_values_beyond_a_threshold.png"
    },
    {
        "type": "type_B",
        "db_id": "journal_committee",
        "chart_category": "Distributions",
        "chart_type": "scatter_plot_with_faceted_marginal_histograms",
        "NLQ": "I came across this scatter plot image with histograms on the sides, and I really like how it presents data. Can you create something similar to show how editor age relates to journal sales, broken down by their work type? Make the points more transparent, add a grid to the main plot, and use a softer color palette with orange, blue and pink tones for the different work types.",
        "code": "import altair as alt\nimport sqlite3\nimport pandas as pd\n\nconn = sqlite3.connect('database/journal_committee.sqlite')\n\nquery = '''\nSELECT\n    e.Age,\n    j.Sales,\n    jc.Work_Type\nFROM\n    editor AS e\nJOIN\n    journal_committee AS jc ON e.Editor_ID = jc.Editor_ID\nJOIN\n    journal AS j ON jc.Journal_ID = j.Journal_ID;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df)\nbase_bar = base.mark_bar(opacity=0.3, binSpacing=0)\n\nxscale = alt.Scale(domain=(df['Age'].min() - 1, df['Age'].max() + 1))\nyscale = alt.Scale(domain=(df['Sales'].min() - 100, df['Sales'].max() + 100))\n\npoints = base.mark_circle().encode(\n    alt.X(\"Age:Q\").scale(xscale),\n    alt.Y(\"Sales:Q\").scale(yscale),\n    color=\"Work_Type:N\",\n)\n\ntop_hist = (\n    base_bar\n    .encode(\n        alt.X(\"Age:Q\")\n            .bin(maxbins=20, extent=xscale.domain).stack(None).title(\"\"),\n        alt.Y(\"count()\").stack(None).title(\"\"),\n        alt.Color(\"Work_Type:N\"),\n    )\n    .properties(height=60)\n)\n\nright_hist = (\n    base_bar\n    .encode(\n        alt.Y(\"Sales:Q\")\n            .bin(maxbins=20, extent=yscale.domain)\n            .stack(None)\n            .title(\"\"),\n        alt.X(\"count()\").stack(None).title(\"\"),\n        alt.Color(\"Work_Type:N\"),\n    )\n    .properties(width=60)\n)\n\nchart = top_hist & (points | right_hist)\n\nchart",
        "reference_path": "./vis_bench/img/Distributions___scatter_plot_with_faceted_marginal_histograms.png"
    },
    {
        "type": "type_B",
        "db_id": "journal_committee",
        "chart_category": "Scatter Plots",
        "chart_type": "bubble_plot",
        "NLQ": "I like this scatter plot showing car performance data, but could you create a similar visualization that shows the relationship between editors' ages and journal sales instead? Make the size of each bubble represent the number of contributions each editor has made. Also, please add a grid background and include a legend for the bubble sizes.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/journal_committee.sqlite')\nquery = '''\nSELECT \n    e.Age AS Editor_Age,\n    j.Sales AS Journal_Sales,\n    COUNT(jc.Work_Type) AS Contribution_Count\nFROM \n    editor AS e\nJOIN \n    journal_committee AS jc ON e.Editor_ID = jc.Editor_ID\nJOIN \n    journal AS j ON jc.Journal_ID = j.Journal_ID\nGROUP BY \n    e.Editor_ID, j.Journal_ID\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\nchart = alt.Chart(df).mark_point().encode(\n    x='Editor_Age:Q',\n    y='Journal_Sales:Q',\n    size='Contribution_Count:Q'\n)\nchart.show()",
        "reference_path": "./vis_bench/img/Scatter Plots___bubble_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "loan_1",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_highlighting_values_beyond_a_threshold",
        "NLQ": "Can you create a bar chart showing the number of customers for each bank branch? Use blue bars for all branches, but highlight in red the portion of any bar that exceeds 300 customers. Add a horizontal line at the 300 customer mark labeled \"Threshold (300)\" and give the chart a title \"Branches with More Than 300 Customers\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/loan_1.sqlite')\n\nquery = '''\nSELECT branch_ID, bname, no_of_customers\nFROM bank\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nthreshold = 300\n\nbars = alt.Chart(df).mark_bar(color=\"steelblue\").encode(\n    x=alt.X(\"bname:N\", title=\"Branch Name\"),\n    y=alt.Y(\"no_of_customers:Q\", title=\"Number of Customers\"),\n)\n\nhighlight = bars.mark_bar(color=\"#e45755\").encode(\n    y2=alt.Y2(datum=threshold)\n).transform_filter(\n    alt.datum.no_of_customers > threshold\n)\n\nrule = alt.Chart().mark_rule().encode(\n    y=alt.Y(datum=threshold)\n)\n\nlabel = rule.mark_text(\n    x=\"width\",\n    dx=-2,\n    align=\"right\",\n    baseline=\"bottom\",\n    text=\"Threshold (300)\"\n)\n\nchart = (bars + highlight + rule + label).properties(\n    title=\"Branches with More Than 300 Customers\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_highlighting_values_beyond_a_threshold.png"
    },
    {
        "type": "type_B",
        "db_id": "loan_1",
        "chart_category": "Distributions",
        "chart_type": "scatter_plot_with_faceted_marginal_histograms",
        "NLQ": "I like this scatter plot with histograms on the sides, but could you create one using our customer database? I'd like to see account balance on the x-axis and credit score on the y-axis, with points colored by account type (checking or saving). Also, make the histograms semi-transparent and add gridlines to the scatter plot for better readability.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/loan_1.sqlite')\n\nquery = '''\nSELECT cust_ID, acc_type, acc_bal, credit_score\nFROM customer\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df)\nbase_bar = base.mark_bar(opacity=0.3, binSpacing=0)\n\nxscale = alt.Scale(domain=(df['acc_bal'].min(), df['acc_bal'].max()))\nyscale = alt.Scale(domain=(df['credit_score'].min(), df['credit_score'].max()))\n\npoints = base.mark_circle().encode(\n    alt.X(\"acc_bal:Q\").scale(xscale),\n    alt.Y(\"credit_score:Q\").scale(yscale),\n    color=\"acc_type:N\",\n)\n\ntop_hist = (\n    base_bar\n    .encode(\n        alt.X(\"acc_bal:Q\")\n        .bin(maxbins=20, extent=xscale.domain)\n        .stack(None)\n        .title(\"Account Balance\"),\n        alt.Y(\"count()\").stack(None).title(\"\"),\n        alt.Color(\"acc_type:N\"),\n    )\n    .properties(height=60)\n)\n\nright_hist = (\n    base_bar\n    .encode(\n        alt.Y(\"credit_score:Q\")\n        .bin(maxbins=20, extent=yscale.domain)\n        .stack(None)\n        .title(\"Credit Score\"),\n        alt.X(\"count()\").stack(None).title(\"\"),\n        alt.Color(\"acc_type:N\"),\n    )\n    .properties(width=60)\n)\n\ntop_hist & (points | right_hist)",
        "reference_path": "./vis_bench/img/Distributions___scatter_plot_with_faceted_marginal_histograms.png"
    },
    {
        "type": "type_B",
        "db_id": "loan_1",
        "chart_category": "Scatter Plots",
        "chart_type": "faceted_scatter_plot",
        "NLQ": "I like this scatter plot showing data by different regions, but could you create a similar layout showing the relationship between number of loans and credit score for customers, broken down by state? Make each subplot small and simple with just the basic points.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/loan_1.sqlite')\n\nquery = '''\nSELECT c.no_of_loans, c.credit_score, c.state\nFROM customer AS c\nWHERE c.no_of_loans IS NOT NULL AND c.credit_score IS NOT NULL\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df, width=100, height=100).mark_point().encode(\n    x=\"no_of_loans:Q\",\n    y=\"credit_score:Q\",\n    row=\"state:N\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Scatter Plots___faceted_scatter_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "local_govt_in_alabama",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_highlighted_bar",
        "NLQ": "I like this chart showing wheat production over time, but could you change it to show the number of events organized by each organizer instead? Make the title \"Number of Events Organized by Each Organizer\" and highlight the organizer with the most events in orange, keeping the rest in blue.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/local_govt_in_alabama.sqlite')\n\nquery = '''\nSELECT \n    P.Participant_Details AS Organizer,\n    COUNT(E.Event_ID) AS Event_Count\nFROM \n    Participants AS P\nJOIN \n    Participants_in_Events AS PE ON P.Participant_ID = PE.Participant_ID\nJOIN \n    Events AS E ON PE.Event_ID = E.Event_ID\nWHERE \n    P.Participant_Type_Code = 'Organizer'\nGROUP BY \n    P.Participant_Details\nORDER BY \n    Event_Count DESC\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nhighlighted_organizer = df.loc[df['Event_Count'].idxmax(), 'Organizer']\n\ncolor = alt.when(alt.datum.Organizer == highlighted_organizer).then(alt.value(\"orange\")).otherwise(alt.value(\"steelblue\"))\n\nchart = alt.Chart(df).mark_bar().encode(\n    x=alt.X('Organizer:N', title='Organizer'),\n    y=alt.Y('Event_Count:Q', title='Number of Events Organized'),\n    color=color\n).properties(width=600, title=\"Number of Events Organized by Each Organizer\")\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_highlighted_bar.png"
    },
    {
        "type": "type_B",
        "db_id": "local_govt_in_alabama",
        "chart_category": "Distributions",
        "chart_type": "stacked_density_estimates",
        "NLQ": "I like this stacked density chart showing flower measurements. Can you create a similar chart but using Service IDs from the Services table, showing how they're distributed across different Service Type Codes? Make the chart narrower and shorter, remove the legend title, and place the legend at the top right instead of inside the chart.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/local_govt_in_alabama.sqlite')\nquery = '''\nSELECT Service_ID, Service_Type_Code\nFROM Services\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).transform_fold(\n    fold=['Service_ID'],\n    as_=['Measurement_type', 'value']\n).transform_density(\n    density='value',\n    bandwidth=0.3,\n    groupby=['Service_Type_Code'],\n    extent=[0, 10],\n    counts=True,\n    steps=200\n).mark_area().encode(\n    alt.X('value:Q'),\n    alt.Y('density:Q').stack('zero'),\n    alt.Color('Service_Type_Code:N')\n).properties(width=400, height=100)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___stacked_density_estimates.png"
    },
    {
        "type": "type_B",
        "db_id": "local_govt_in_alabama",
        "chart_category": "Scatter Plots",
        "chart_type": "faceted_scatter_plot",
        "NLQ": "Can you create a faceted scatter plot showing the relationship between number of participants and success rates for different service types? I'd like each service type to have its own row panel, with the number of participants on the x-axis and success rate percentage on the y-axis. Please add grid lines and set the y-axis to go from 0 to 80%.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/local_govt_in_alabama.sqlite')\n\nquery = '''\nSELECT \n    S.Service_Type_Code,\n    COUNT(DISTINCT P.Participant_ID) AS Participant_Count,\n    AVG(CASE WHEN E.Event_Details = 'Success' THEN 1 ELSE 0 END) * 100 AS Success_Rate\nFROM \n    Events AS E\nJOIN \n    Services AS S ON E.Service_ID = S.Service_ID\nJOIN \n    Participants_in_Events AS PE ON E.Event_ID = PE.Event_ID\nJOIN \n    Participants AS P ON PE.Participant_ID = P.Participant_ID\nGROUP BY \n    S.Service_Type_Code\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_point().encode(\n    x=alt.X(\"Participant_Count:Q\", title=\"Number of Participants\"),\n    y=alt.Y(\"Success_Rate:Q\", title=\"Success Rate (%)\"),\n    row=alt.Row(\"Service_Type_Code:N\", title=\"Service Type\")\n).properties(\n    width=200,\n    height=200\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Scatter Plots___faceted_scatter_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "local_govt_mdm",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_highlighted_bar",
        "NLQ": "I like this wheat production chart, but could you change it to show customer counts by source system from our CMI_Cross_References database table instead? Keep the same bar chart style with blue bars, but highlight the 'Rent' source system in orange to make it stand out. Also, change the title to \"Number of Customers by Source System\" and update the axis labels accordingly.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/local_govt_mdm.sqlite')\n\nquery = '''\nSELECT \n    source_system_code, \n    COUNT(master_customer_id) AS customer_count\nFROM \n    CMI_Cross_References\nGROUP BY \n    source_system_code\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ncolor = alt.condition(\n    alt.datum.source_system_code == 'Rent',\n    alt.value('orange'),\n    alt.value('steelblue')\n)\n\nchart = alt.Chart(df).mark_bar().encode(\n    x=alt.X('source_system_code:N', title='Source System'),\n    y=alt.Y('customer_count:Q', title='Number of Customers'),\n    color=color\n).properties(\n    width=600,\n    title='Number of Customers by Source System'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_highlighted_bar.png"
    },
    {
        "type": "type_B",
        "db_id": "local_govt_mdm",
        "chart_category": "Distributions",
        "chart_type": "stacked_density_estimates",
        "NLQ": "I came across this visualization image that uses stacked density plots to show distributions, and I really like the style. Can you create something similar to display how customer cross-reference IDs are spread across different service types like Council Tax, Business Rates, and others? Add a clear title at the top, move the legend to the right side, use different colors for each service type, and adjust the x-axis to show values from 0 to 110.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/local_govt_mdm.sqlite')\nqueries = {\n    'CouncilTax': 'SELECT cmi_cross_ref_id FROM Council_Tax',\n    'BusinessRates': 'SELECT cmi_cross_ref_id FROM Business_Rates',\n    'BenefitsOverpayments': 'SELECT cmi_cross_ref_id FROM Benefits_Overpayments',\n    'ParkingFines': 'SELECT cmi_cross_ref_id FROM Parking_Fines',\n    'RentArrears': 'SELECT cmi_cross_ref_id FROM Rent_Arrears',\n    'ElectoralRegister': 'SELECT cmi_cross_ref_id FROM Electoral_Register'\n}\n\ndataframes = []\nfor measurement_type, query in queries.items():\n    df = pd.read_sql_query(query, conn)\n    df['Measurement_type'] = measurement_type\n    dataframes.append(df)\n\nsource = pd.concat(dataframes)\nsource = source.rename(columns={'cmi_cross_ref_id': 'value'})\nconn.close()\n\nchart = alt.Chart(source).transform_fold(\n    ['value'],\n    as_=['Measurement_type_fold', 'value']\n).transform_density(\n    density='value',\n    bandwidth=5,\n    groupby=['Measurement_type'],\n    extent=[0, 110],\n    counts=True,\n    steps=200\n).mark_area().encode(\n    alt.X('value:Q'),\n    alt.Y('density:Q').stack('zero'),\n    alt.Color('Measurement_type:N')\n).properties(\n    width=400,\n    height=200,\n    title='Stacked Density Estimates of Customer Cross-Reference IDs by Service Type'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Distributions___stacked_density_estimates.png"
    },
    {
        "type": "type_B",
        "db_id": "local_govt_mdm",
        "chart_category": "Scatter Plots",
        "chart_type": "multifeature_scatter_plot",
        "NLQ": "I came across this scatter plot image that I really like the style of—it uses different colors and sizes for the points to show multiple dimensions. Could you create something similar to visualize how council tax records relate to rent arrears, with the number of council tax records on one axis and rent arrears on the other? It would be great if the points could also be colored by source system and sized by the total cross-references tied to each customer.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/local_govt_mdm.sqlite')\n\nquery = '''\nSELECT \n    T1.master_customer_id,\n    COUNT(DISTINCT T2.council_tax_id) AS council_tax_count,\n    COUNT(DISTINCT T3.council_tax_id) AS rent_arrears_count,\n    T4.source_system_code,\n    COUNT(T4.cmi_cross_ref_id) AS total_cross_refs\nFROM \n    Customer_Master_Index AS T1\nLEFT JOIN \n    Council_Tax AS T2 ON T2.cmi_cross_ref_id IN (\n        SELECT cmi_cross_ref_id FROM CMI_Cross_References WHERE master_customer_id = T1.master_customer_id\n    )\nLEFT JOIN \n    Rent_Arrears AS T3 ON T3.cmi_cross_ref_id IN (\n        SELECT cmi_cross_ref_id FROM CMI_Cross_References WHERE master_customer_id = T1.master_customer_id\n    )\nLEFT JOIN \n    CMI_Cross_References AS T4 ON T4.master_customer_id = T1.master_customer_id\nGROUP BY \n    T1.master_customer_id, T4.source_system_code\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_circle().encode(\n    alt.X('council_tax_count').scale(zero=False),\n    alt.Y('rent_arrears_count').scale(zero=False, padding=1),\n    color='source_system_code',\n    size='total_cross_refs'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Scatter Plots___multifeature_scatter_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "manufactory_1",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_highlighted_segment",
        "NLQ": "I like this chart showing wheat production over time with a threshold line. Could you create a similar style chart but showing manufacturer revenue data instead? I'd like to see which manufacturers have revenue above 100 billion dollars, with those portions highlighted in red. Please use a dashed line for the threshold and add a clear title that explains what we're looking at.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/manufactory_1.sqlite')\n\nquery = '''\nSELECT Name, Revenue\nFROM Manufacturers\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nthreshold_value = 100\nthreshold_df = pd.DataFrame([{\"threshold\": threshold_value}])\n\nbars = alt.Chart(df).mark_bar().encode(\n    x=alt.X(\"Name:N\", title=\"Manufacturer\"),\n    y=alt.Y(\"Revenue:Q\", title=\"Revenue (in billions)\")\n)\n\nhighlight = alt.Chart(df).mark_bar(color=\"#e45755\").encode(\n    x=alt.X(\"Name:N\", title=\"Manufacturer\"),\n    y=alt.Y(\"baseline:Q\", title=\"Revenue (in billions)\"),\n    y2=alt.Y2(\"Revenue:Q\")\n).transform_filter(\n    alt.datum.Revenue > threshold_value\n).transform_calculate(\n    baseline=f\"{threshold_value}\"\n)\n\nrule = alt.Chart(threshold_df).mark_rule(color=\"black\", strokeDash=[3, 5]).encode(\n    y=\"threshold:Q\"\n)\n\nchart = (bars + highlight + rule).properties(width=600, title=\"Manufacturer Revenue with Highlighted Threshold\")\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_highlighted_segment.png"
    },
    {
        "type": "type_B",
        "db_id": "manufactory_1",
        "chart_category": "Scatter Plots",
        "chart_type": "multifeature_scatter_plot",
        "NLQ": "I came across this scatter plot image that I really like the style of—it uses point sizes and colors effectively. Can you create something similar showing how manufacturers' revenue relates to their products' average price, with point sizes indicating the number of products and colors representing their headquarters locations? Please title it \"Manufacturer Revenue vs. Average Product Price\" and make sure to label the axes accordingly.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/manufactory_1.sqlite')\n\nquery = '''\nSELECT \n    M.Revenue AS Revenue,\n    AVG(P.Price) AS AvgProductPrice,\n    COUNT(P.Code) AS ProductCount,\n    M.Headquarter AS Headquarter\nFROM \n    Manufacturers AS M\nJOIN \n    Products AS P ON M.Code = P.Manufacturer\nGROUP BY \n    M.Code\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_circle().encode(\n    alt.X('Revenue').scale(zero=False).title('Manufacturer Revenue'),\n    alt.Y('AvgProductPrice').scale(zero=False, padding=1).title('Average Product Price'),\n    color='Headquarter',\n    size='ProductCount'\n).properties(\n    title='Manufacturer Revenue vs. Average Product Price'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Scatter Plots___multifeature_scatter_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "manufacturer",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_highlighted_segment",
        "NLQ": "Can you create a bar chart showing the number of factories for each manufacturer? I'd like to highlight manufacturers that have more than 20 factories in red, with the portion above 20 in a different color. Also, add a dashed horizontal line at the 20 factory threshold and give it a title \"Number of Factories by Manufacturer\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/manufacturer.sqlite')\nquery = '''\nSELECT Name, Num_of_Factories\nFROM manufacturer\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nthreshold_value = 20\nthreshold_df = pd.DataFrame([{\"threshold\": threshold_value}])\n\nbars = alt.Chart(df).mark_bar().encode(\n    x=alt.X('Name:N', title='Manufacturer'),\n    y=alt.Y('Num_of_Factories:Q', title='Number of Factories')\n)\n\nhighlight = alt.Chart(df).mark_bar(color=\"#e45755\").encode(\n    x='Name:N',\n    y='baseline:Q',\n    y2='Num_of_Factories:Q'\n).transform_filter(\n    alt.datum.Num_of_Factories > threshold_value\n).transform_calculate(\"baseline\", str(threshold_value))\n\nrule = alt.Chart(threshold_df).mark_rule(color=\"black\", strokeDash=[3, 5]).encode(\n    y='threshold:Q'\n)\n\nchart = (bars + highlight + rule).properties(width=600, title=\"Number of Factories by Manufacturer\")\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_highlighted_segment.png"
    },
    {
        "type": "type_B",
        "db_id": "match_season",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_highlighted_segment",
        "NLQ": "Can you create a bar chart showing the number of players drafted per season from the match_season database? I'd like to see a horizontal dashed line at the 10-player threshold and have any bars that exceed this threshold highlighted in red. Please include a clear title that explains what the chart is showing.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/match_season.sqlite')\nquery = '''\nSELECT Season, COUNT(Player) AS Player_Count\nFROM match_season\nGROUP BY Season\nORDER BY Season\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nthreshold = pd.DataFrame([{\"threshold\": 10}])\n\nbars = alt.Chart(df).mark_bar().encode(\n    x=alt.X(\"Season:O\", title=\"Season\"),\n    y=alt.Y(\"Player_Count:Q\", title=\"Number of Players Drafted\")\n)\n\nhighlight = alt.Chart(df).mark_bar(color=\"#e45755\").encode(\n    x='Season:O',\n    y='baseline:Q',\n    y2='Player_Count:Q'\n).transform_filter(\n    alt.datum.Player_Count > 10\n).transform_calculate(\"baseline\", \"10\")\n\nrule = alt.Chart(threshold).mark_rule(color=\"black\", strokeDash=[3, 5]).encode(\n    y='threshold:Q'\n)\n\nchart = (bars + highlight + rule).properties(width=600, title=\"Players Drafted Per Season with Highlighted Threshold\")\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_highlighted_segment.png"
    },
    {
        "type": "type_B",
        "db_id": "match_season",
        "chart_category": "Distributions",
        "chart_type": "table_bubble_plot_github_punch_card",
        "NLQ": "I like this GitHub commits visualization, but can you create a similar bubble chart using the match_season database? I'd like to see seasons listed vertically on the y-axis and team IDs horizontally on the x-axis, with the bubble size representing how many players each team had per season. Please make it simple with blue circles and a clean layout.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/match_season.sqlite')\nquery = '''\nSELECT \n    Season AS season,\n    Team AS team_id,\n    COUNT(Player) AS player_count\nFROM match_season\nGROUP BY Season, Team\nORDER BY Season, Team\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_circle().encode(\n    x=alt.X('team_id:O', title='Team ID'),\n    y=alt.Y('season:O', title='Season'),\n    size=alt.Size('player_count:Q', title='Player Count')\n)\n\nchart",
        "reference_path": "./vis_bench/img/Distributions___table_bubble_plot_github_punch_card.png"
    },
    {
        "type": "type_B",
        "db_id": "medicine_enzyme_interaction",
        "chart_category": "Distributions",
        "chart_type": "table_bubble_plot_github_punch_card",
        "NLQ": "I came across this bubble plot visualization that I really like—it uses size and a blue color scale to represent data. Can you create something similar showing how many medicines interact with enzymes, grouped by enzyme location and interaction type?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/medicine_enzyme_interaction.sqlite')\n\nquery = '''\nSELECT \n    e.Location AS enzyme_location,\n    mei.interaction_type,\n    COUNT(m.id) AS medicine_count\nFROM \n    medicine_enzyme_interaction AS mei\nJOIN \n    enzyme AS e ON mei.enzyme_id = e.id\nJOIN \n    medicine AS m ON mei.medicine_id = m.id\nGROUP BY \n    e.Location, mei.interaction_type\nORDER BY \n    e.Location, mei.interaction_type;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_circle().encode(\n    x=alt.X('enzyme_location:N', title='Enzyme Location'),\n    y=alt.Y('interaction_type:N', title='Interaction Type'),\n    size=alt.Size('medicine_count:Q', title='Medicine Count'),\n    color=alt.Color('medicine_count:Q', scale=alt.Scale(scheme='blues'))\n).properties(\n    title='Count of Medicines Interacting with Enzymes by Location and Interaction Type'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___table_bubble_plot_github_punch_card.png"
    },
    {
        "type": "type_B",
        "db_id": "medicine_enzyme_interaction",
        "chart_category": "Scatter Plots",
        "chart_type": "scatter_matrix",
        "NLQ": "Can you create a scatter matrix showing the relationships between enzymes and medicines? I'd like to see enzyme names on one axis and medicine names on the other, with points colored by their interaction type (like activator or inhibitor). Make it interactive so I can hover over points to see details like whether the medicines are FDA-approved.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/medicine_enzyme_interaction.sqlite')\nquery = '''\nSELECT \n    e.name AS enzyme_name, \n    m.name AS medicine_name, \n    m.FDA_approved, \n    mei.interaction_type\nFROM \n    medicine_enzyme_interaction AS mei\nJOIN \n    enzyme AS e ON mei.enzyme_id = e.id\nJOIN \n    medicine AS m ON mei.medicine_id = m.id\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_circle().encode(\n    alt.X(alt.repeat(\"column\"), type='nominal'),\n    alt.Y(alt.repeat(\"row\"), type='nominal'),\n    color='interaction_type:N',\n    tooltip=['enzyme_name', 'medicine_name', 'FDA_approved', 'interaction_type']\n).properties(\n    width=150,\n    height=150\n).repeat(\n    row=['enzyme_name', 'medicine_name'],\n    column=['medicine_name', 'enzyme_name']\n).interactive()\n\nchart.show()",
        "reference_path": "./vis_bench/img/Scatter Plots___scatter_matrix.png"
    },
    {
        "type": "type_B",
        "db_id": "mountain_photos",
        "chart_category": "Distributions",
        "chart_type": "table_bubble_plot_github_punch_card",
        "NLQ": "I came across this bubble chart that looks like a GitHub punch card, and I really like its style. Can you create something similar to show how many photos are taken on each mountain, organized by the day of the week and hour of the day? The bubbles should represent the number of photos, and use colors to separate color photos from black-and-white ones.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/mountain_photos.sqlite')\n\nquery = '''\nSELECT \n    m.name AS mountain_name,\n    strftime('%w', p.id) AS day_of_week,\n    strftime('%H', p.id) AS hour_of_day,\n    p.color AS photo_color,\n    COUNT(*) AS photo_count\nFROM photos AS p\nJOIN mountain AS m ON p.mountain_id = m.id\nGROUP BY m.name, day_of_week, hour_of_day, p.color\nORDER BY m.name, day_of_week, hour_of_day\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_circle().encode(\n    x=alt.X('hour_of_day:O', title='Hour of Day'),\n    y=alt.Y('day_of_week:O', title='Day of Week', sort=['0', '1', '2', '3', '4', '5', '6']),\n    size=alt.Size('photo_count:Q', title='Number of Photos'),\n    color=alt.Color('photo_color:N', title='Photo Color')\n).properties(\n    title='Photos Taken by Mountain, Day, and Hour'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___table_bubble_plot_github_punch_card.png"
    },
    {
        "type": "type_B",
        "db_id": "movie_1",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_labels",
        "NLQ": "I came across this bar chart with labels that looks really clean and professional. Can you create something similar for me? I'd like to see the average ratings of different movies, sorted from highest to lowest, with the movie titles on the y-axis and their ratings displayed on the bars. Could you add a title \"Average Movie Ratings\" at the top and make sure the ratings are shown with two decimal places?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/movie_1.sqlite')\n\nquery = '''\nSELECT \n    M.title AS MovieTitle,\n    AVG(R.stars) AS AverageRating\nFROM \n    Rating AS R\nJOIN \n    Movie AS M ON R.mID = M.mID\nGROUP BY \n    M.mID, M.title\nORDER BY \n    AverageRating DESC;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    x=alt.X('AverageRating:Q', title='Average Rating'),\n    y=alt.Y('MovieTitle:N', sort='-x', title='Movie Title'),\n    text=alt.Text('AverageRating:Q', format='.2f')\n)\n\nchart = base.mark_bar() + base.mark_text(align='left', dx=2)\nchart.properties(title=\"Average Movie Ratings\")",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_labels.png"
    },
    {
        "type": "type_B",
        "db_id": "movie_1",
        "chart_category": "Distributions",
        "chart_type": "violin_plot",
        "NLQ": "Can you turn this violin plot sideways and arrange it as a series of columns? I'd like to see how movie ratings (from 1-5 stars) are distributed across different years. Put the year labels at the bottom, remove the density axis labels, and use different colors for each year.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/movie_1.sqlite')\n\nquery = '''\nSELECT \n    Movie.year AS year, \n    Rating.stars AS stars\nFROM \n    Rating\nJOIN \n    Movie ON Rating.mID = Movie.mID\nWHERE \n    Rating.stars IS NOT NULL\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).transform_density(\n    'stars',\n    as_=['stars', 'density'],\n    extent=[1, 5],\n    groupby=['year']\n).mark_area(orient='horizontal').encode(\n    alt.X('density:Q')\n        .stack('center')\n        .impute(None)\n        .title(None)\n        .axis(labels=False, values=[0], grid=False, ticks=True),\n    alt.Y('stars:Q', title='Rating Stars'),\n    alt.Color('year:N', title='Year'),\n    alt.Column('year:N')\n        .spacing(0)\n        .header(titleOrient='bottom', labelOrient='bottom', labelPadding=0)\n).configure_view(\n    stroke=None\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___violin_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "museum_visit",
        "chart_category": "Distributions",
        "chart_type": "violin_plot",
        "NLQ": "I came across this really cool violin plot that shows data density in a smooth, flowing way. Can you create something similar to visualize how much visitors are spending at different museums? I'd love to see the total spending broken down by each museum. Could you arrange the museums side by side and show the spending distribution for each one? Also, please put the museum names at the bottom of the chart.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/museum_visit.sqlite')\nquery = '''\nSELECT \n    m.Name AS Museum_Name,\n    v.Total_spent\nFROM \n    visit AS v\nJOIN \n    museum AS m\nON \n    v.Museum_ID = m.Museum_ID\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).transform_density(\n    'Total_spent',\n    as_=['Total_spent', 'density'],\n    extent=[0, df['Total_spent'].max()],\n    groupby=['Museum_Name']\n).mark_area(orient='horizontal').encode(\n    alt.X('density:Q')\n        .stack('center')\n        .impute(None)\n        .title(None)\n        .axis(labels=False, values=[0], grid=False, ticks=True),\n    alt.Y('Total_spent:Q', title='Total Spent'),\n    alt.Color('Museum_Name:N', title='Museum'),\n    alt.Column('Museum_Name:N')\n        .spacing(0)\n        .header(titleOrient='bottom', labelOrient='bottom', labelPadding=0)\n).configure_view(\n    stroke=None\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___violin_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "musical",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_labels_based_on_measured_luminance",
        "NLQ": "I like this chart showing yield by site, but could you create a similar horizontal bar chart showing the number of nominations for each nominee? Make sure to sort it with the highest number of nominations at the top, use a blue color gradient for the bars, and include the nomination count as text on each bar.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/musical.sqlite')\n\nquery = '''\nSELECT Nominee, COUNT(*) AS NominationCount\nFROM musical\nGROUP BY Nominee\nORDER BY NominationCount DESC;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    x=alt.X('NominationCount:Q').stack('zero'),\n    y=alt.Y('Nominee:O').sort('-x'),\n    text=alt.Text('NominationCount:Q', format='.0f')\n)\n\nbars = base.mark_bar(\n    tooltip=alt.expr(\"luminance(scale('color', datum.NominationCount))\")\n).encode(\n    color='NominationCount:Q'\n)\n\ntext = base.mark_text(\n    align='right',\n    dx=-3,\n    color=alt.expr(\"luminance(scale('color', datum.NominationCount)) > 0.5 ? 'black' : 'white'\")\n)\n\nbars + text",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_labels_based_on_measured_luminance.png"
    },
    {
        "type": "type_B",
        "db_id": "musical",
        "chart_category": "Distributions",
        "chart_type": "violin_plot",
        "NLQ": "I came across this violin plot that looks really sleek, especially how it shows distributions. Could you create something similar to visualize the ages of actors in Tony Award-nominated musicals, grouped by each musical? I'd like to see the violins displayed horizontally instead of vertically, with the musical names at the bottom. Also, could you remove the x-axis labels and focus on just Les Misérables and The Phantom of the Opera? I think it would be a great way to see the data.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/musical.sqlite')\n\nquery = '''\nSELECT m.Name AS Musical_Name, a.age AS Actor_Age\nFROM musical AS m\nJOIN actor AS a ON m.Musical_ID = a.Musical_ID\nWHERE m.Award = 'Tony Award' AND m.Result = 'Nominated'\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).transform_density(\n    'Actor_Age',\n    as_=['Actor_Age', 'density'],\n    extent=[15, 70],\n    groupby=['Musical_Name']\n).mark_area(orient='horizontal').encode(\n    alt.X('density:Q')\n        .stack('center')\n        .impute(None)\n        .title(None)\n        .axis(labels=False, values=[0], grid=False, ticks=True),\n    alt.Y('Actor_Age:Q', title='Actor Age'),\n    alt.Color('Musical_Name:N', legend=alt.Legend(title=\"Musical\")),\n    alt.Column('Musical_Name:N')\n        .spacing(0)\n        .header(titleOrient='bottom', labelOrient='bottom', labelPadding=0)\n).configure_view(\n    stroke=None\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___violin_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "music_1",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_labels_based_on_measured_luminance",
        "NLQ": "Can you create a horizontal bar chart showing the total number of songs for each genre from our music database? I'd like the bars to be sorted from highest to lowest count, colored by the song count with a blue gradient, and include the actual count values as labels inside the bars. Make sure the text color adjusts automatically for readability against the bar color.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/music_1.sqlite')\n\nquery = '''\nSELECT \n    g.g_name AS genre_name, \n    COUNT(s.song_name) AS song_count\nFROM \n    genre AS g\nLEFT JOIN \n    song AS s ON g.g_name = s.genre_is\nGROUP BY \n    g.g_name\nORDER BY \n    song_count DESC;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    x=alt.X('song_count:Q', title='Total Number of Songs'),\n    y=alt.Y('genre_name:O', title='Genre', sort='-x'),\n    text=alt.Text('song_count:Q', format='.0f')\n)\n\nbars = base.mark_bar(\n    tooltip=alt.expr(\"luminance(scale('color', datum.song_count))\")\n).encode(\n    color='song_count:Q'\n)\n\ntext = base.mark_text(\n    align='right',\n    dx=-3,\n    color=alt.expr(\"luminance(scale('color', datum.song_count)) > 0.5 ? 'black' : 'white'\")\n)\n\nchart = bars + text\nchart.properties(title=\"Total Number of Songs per Genre\")",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_labels_based_on_measured_luminance.png"
    },
    {
        "type": "type_B",
        "db_id": "music_4",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_line_at_mean",
        "NLQ": "Can you create a bar chart showing the number of top songs for different artists? I'd like to see the artist names on the x-axis and the song count on the y-axis. Also, please add a red horizontal line showing the average number of songs across all artists.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/music_4.sqlite')\n\nquery = '''\nSELECT \n    a.Artist, COUNT(v.Song) AS Song_Count\nFROM \n    artist AS a\nJOIN \n    volume AS v ON a.Artist_ID = v.Artist_ID\nGROUP BY \n    a.Artist\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbar = alt.Chart(df).mark_bar().encode(\n    x=alt.X('Artist:N', title='Artist'),\n    y=alt.Y('Song_Count:Q', title='Number of Songs on Top')\n)\n\nrule = alt.Chart(df).mark_rule(color='red').encode(\n    y='mean(Song_Count):Q'\n)\n\n(bar + rule).properties(width=600)",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_line_at_mean.png"
    },
    {
        "type": "type_B",
        "db_id": "network_1",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_line_at_mean",
        "NLQ": "I came across this bar chart that uses a red line to show the average, and I really like the style. Can you create something similar to visualize how many friends each student has, along with the overall average number of friends? Use the Highschooler and Friend tables for the data. Make sure to label the x-axis as \"Student Name\" and the y-axis as \"Number of Friends\" and title it \"Number of Friends per Student with Average Line\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/network_1.sqlite')\n\nquery = '''\nSELECT \n    T1.ID AS student_id, \n    T1.name AS student_name, \n    COUNT(T2.friend_id) AS friend_count\nFROM \n    Highschooler AS T1\nLEFT JOIN \n    Friend AS T2 ON T1.ID = T2.student_id\nGROUP BY \n    T1.ID, T1.name\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbar = alt.Chart(df).mark_bar().encode(\n    x=alt.X('student_name:N', title='Student Name'),\n    y=alt.Y('friend_count:Q', title='Number of Friends')\n)\n\nrule = alt.Chart(df).mark_rule(color='red').encode(\n    y='mean(friend_count):Q'\n)\n\nchart = (bar + rule).properties(\n    width=600,\n    title='Number of Friends per Student with Average Line'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_line_at_mean.png"
    },
    {
        "type": "type_B",
        "db_id": "network_2",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_line_at_mean",
        "NLQ": "I came across this bar chart with a red line showing the average, and I really like how clear it looks. Can you create something similar to visualize the average length of friendships for people in different job roles, using our Person and PersonFriend tables?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/network_2.sqlite')\n\nquery = '''\nSELECT \n    P.job AS job_title,\n    AVG(PF.year) AS avg_friendship_years\nFROM \n    PersonFriend AS PF\nJOIN \n    Person AS P ON PF.name = P.name\nGROUP BY \n    P.job\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbar = alt.Chart(df).mark_bar().encode(\n    x=alt.X('job_title:N', title='Job Title'),\n    y=alt.Y('avg_friendship_years:Q', title='Average Friendship Duration (Years)')\n)\n\nmean_value = df['avg_friendship_years'].mean()\nrule = alt.Chart(df).mark_rule(color='red').encode(\n    y=alt.Y(f'{mean_value}:Q', title='Overall Average')\n)\n\nchart = (bar + rule).properties(\n    width=600,\n    title='Average Friendship Duration by Job Title'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_line_at_mean.png"
    },
    {
        "type": "type_B",
        "db_id": "news_report",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_line_on_dual_axis",
        "NLQ": "I like this chart showing wheat production and wages over time, but I need something different for my news report. Could you create a chart that shows the number of events per year as blue bars and overlay a red line showing the average experience of journalists covering those events? Please use data from our news database and title it \"Events per Year and Average Journalist Experience.\"",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/news_report.sqlite')\n\nquery = '''\nSELECT\n    CAST(SUBSTR(T1.Date, LENGTH(T1.Date) - 3) AS INTEGER) AS EventYear,\n    COUNT(T1.Event_ID) AS NumberOfEvents,\n    AVG(T3.Years_working) AS AverageJournalistExperience\nFROM\n    event AS T1\nJOIN\n    news_report AS T2 ON T1.Event_ID = T2.Event_ID\nJOIN\n    journalist AS T3 ON T2.journalist_ID = T3.journalist_ID\nGROUP BY\n    EventYear\nORDER BY\n    EventYear;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    x=alt.X('EventYear:O', title='Event Year')\n)\n\nbars = base.mark_bar().encode(\n    y=alt.Y('NumberOfEvents:Q', title='Number of Events')\n)\n\nline = base.mark_line(color='red').encode(\n    y=alt.Y('AverageJournalistExperience:Q', title='Average Journalist Experience')\n)\n\nchart = (bars + line).resolve_scale(\n    y='independent'\n).properties(\n    title='Events per Year and Average Journalist Experience'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_line_on_dual_axis.png"
    },
    {
        "type": "type_B",
        "db_id": "orchestra",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_line_on_dual_axis",
        "NLQ": "I need a chart showing average attendance for different performance types as blue bars, with a red line overlaid showing average official ratings in millions. Could you use separate y-axes for the two metrics, with attendance on the left and ratings on the right? Also, please make the chart wider and add gridlines to make it easier to read the values.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/orchestra.sqlite')\nquery = \"\"\"\nSELECT\n    P.Type,\n    AVG(S.Attendance) AS Average_Attendance,\n    AVG(P.\"Official_ratings_(millions)\") AS Average_Official_Ratings\nFROM Performance AS P\nJOIN Show AS S\n    ON P.Performance_ID = S.Performance_ID\nGROUP BY\n    P.Type;\n\"\"\"\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    x='Type:N'\n).properties(\n    width=600\n)\n\nbar = base.mark_bar().encode(\n    y='Average_Attendance:Q'\n)\n\nline = base.mark_line(color='red').encode(\n    y='Average_Official_Ratings:Q'\n)\n\n(bar + line).resolve_scale(\n    y='independent'\n)",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_line_on_dual_axis.png"
    },
    {
        "type": "type_B",
        "db_id": "party_host",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_line_on_dual_axis",
        "NLQ": "I like this chart showing wheat production and wages over time, but could you create a similar dual-axis chart that shows the total number of hosts for each party theme as blue bars, with a red line showing the average number of years those themes have been active? Please sort the themes by the number of hosts in descending order.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/party_host.sqlite')\n\nquery = '''\nSELECT \n    p.Party_Theme,\n    SUM(p.Number_of_hosts) AS Total_Hosts,\n    AVG(CAST(p.Last_year AS INT) - CAST(p.First_year AS INT)) AS Avg_Active_Years\nFROM \n    party AS p\nGROUP BY \n    p.Party_Theme\nORDER BY \n    Total_Hosts DESC;\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nbase = alt.Chart(df).encode(x=alt.X('Party_Theme:N', title='Party Theme'))\n\nbar = base.mark_bar().encode(\n    y=alt.Y('Total_Hosts:Q', title='Total Number of Hosts')\n)\n\nline = base.mark_line(color='red').encode(\n    y=alt.Y('Avg_Active_Years:Q', title='Average Active Years')\n)\n\nchart = (bar + line).resolve_scale(y='independent').properties(width=600)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_line_on_dual_axis.png"
    },
    {
        "type": "type_B",
        "db_id": "party_people",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_negative_values",
        "NLQ": "I came across this bar chart that uses different colors for positive and negative values, and I really like the style. Can you create something similar to show the net change in political party membership over the years, using the member table's In_office column to calculate membership changes year by year? Instead of showing monthly data like in the reference chart, I'd like to see yearly data with actual years on the x-axis, and please title it \"Net Change in Political Party Membership Over Time\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/party_people.sqlite')\n\nquery = '''\nWITH MembershipYears AS (\n    SELECT \n        CAST(SUBSTR(In_office, 1, 4) AS INTEGER) AS StartYear,\n        CASE \n            WHEN Instr(In_office, '–') > 0 THEN \n                CASE \n                    WHEN SUBSTR(In_office, Instr(In_office, '–') + 1) = 'present' THEN strftime('%Y', 'now')\n                    ELSE CAST(SUBSTR(In_office, Instr(In_office, '–') + 1) AS INTEGER)\n                END\n            ELSE CAST(SUBSTR(In_office, 1, 4) AS INTEGER)\n        END AS EndYear\n    FROM member\n),\nYearlyMembership AS (\n    SELECT \n        Year,\n        SUM(CASE WHEN Year BETWEEN StartYear AND EndYear THEN 1 ELSE -1 END) AS NetChange\n    FROM MembershipYears,\n         (SELECT DISTINCT CAST(SUBSTR(In_office, 1, 4) AS INTEGER) AS Year FROM member)\n    GROUP BY Year\n)\nSELECT Year, NetChange\nFROM YearlyMembership\nORDER BY Year;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\npredicate = alt.datum.NetChange > 0\ncolor = alt.when(predicate).then(alt.value(\"steelblue\")).otherwise(alt.value(\"orange\"))\n\nchart = alt.Chart(df).mark_bar().encode(\n    x=alt.X(\"Year:O\", title=\"Year\"),\n    y=alt.Y(\"NetChange:Q\", title=\"Net Change in Membership\"),\n    color=color\n).properties(width=600, title=\"Net Change in Political Party Membership Over Time\")\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_negative_values.png"
    },
    {
        "type": "type_B",
        "db_id": "pets_1",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_range",
        "NLQ": "I came across this bar chart that clearly shows ranges with minimum and maximum values marked on each bar—can we create something like that to show the weight range for each type of pet in our Pets table? It would be great if it highlights the lowest and highest weights for pets like cats, dogs, etc. Could you make the bars horizontal with rounded corners, use a blue color scheme, and add a clear title and subtitle? Also, please display the actual minimum and maximum weight values as text labels at each end of the bars.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/pets_1.sqlite')\n\nquery = '''\nSELECT \n    Pets.PetType,\n    MIN(Pets.weight) AS min_weight,\n    MAX(Pets.weight) AS max_weight\nFROM \n    Pets\nGROUP BY \n    Pets.PetType\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nbar = alt.Chart(df).mark_bar(cornerRadius=10, height=15).encode(\n    x=alt.X('min_weight:Q').scale(domain=[0, df['max_weight'].max() + 2]).title('Weight Range (kg)'),\n    x2='max_weight:Q',\n    y=alt.Y('PetType:O').title('Pet Type')\n)\n\ntext_min = alt.Chart(df).mark_text(align='right', dx=-5).encode(\n    x='min_weight:Q',\n    y=alt.Y('PetType:O'),\n    text='min_weight:Q'\n)\n\ntext_max = alt.Chart(df).mark_text(align='left', dx=5).encode(\n    x='max_weight:Q',\n    y=alt.Y('PetType:O'),\n    text='max_weight:Q'\n)\n\n(bar + text_min + text_max).properties(\n    title=alt.Title(text='Weight Range by Pet Type', subtitle='Minimum and Maximum Weight for Each Pet Type')\n)",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_range.png"
    },
    {
        "type": "type_B",
        "db_id": "pets_1",
        "chart_category": "Scatter Plots",
        "chart_type": "simple_scatter_plot_with_labels",
        "NLQ": "I came across this scatter plot image that I really like the style of. Can you create something similar showing the relationship between pet age and weight, with each point labeled by its PetID using the Pets table?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/pets_1.sqlite')\nquery = '''\nSELECT pet_age, weight, PetID\nFROM Pets\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndf['PetID'] = df['PetID'].astype(str)\n\npoints = alt.Chart(df).mark_point().encode(\n    x='pet_age:Q',\n    y='weight:Q'\n)\n\ntext = points.mark_text(\n    align='left',\n    baseline='middle',\n    dx=7\n).encode(\n    text='PetID:N'\n)\n\npoints + text",
        "reference_path": "./vis_bench/img/Scatter Plots___simple_scatter_plot_with_labels.png"
    },
    {
        "type": "type_B",
        "db_id": "phone_1",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_range",
        "NLQ": "I came across this bar chart that shows ranges with labels, and I really like its clean style. Could you create something similar to visualize the lowest and highest RAM values for each year phones were launched, using data from the `chip_model` table? It'd be great if the years are on the y-axis and the RAM range is on the x-axis, with labels for the min and max values. Also, could you add a title \"RAM Range by Launch Year\" with a subtitle explaining it shows minimum and maximum RAM for each year? And make the bars thinner with rounded corners in a blue color.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/phone_1.sqlite')\n\nquery = '''\nSELECT \n    Launch_year, \n    MIN(RAM_MiB) AS min_ram, \n    MAX(RAM_MiB) AS max_ram\nFROM chip_model\nGROUP BY Launch_year\nORDER BY Launch_year\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbar = alt.Chart(df).mark_bar(cornerRadius=10, height=10).encode(\n    x=alt.X('min_ram:Q').scale(domain=[0, df['max_ram'].max() + 10]).title('RAM Range (MiB)'),\n    x2='max_ram:Q',\n    y=alt.Y('Launch_year:O').title('Launch Year')\n)\n\ntext_min = alt.Chart(df).mark_text(align='right', dx=-5).encode(\n    x='min_ram:Q',\n    y=alt.Y('Launch_year:O'),\n    text='min_ram:Q'\n)\n\ntext_max = alt.Chart(df).mark_text(align='left', dx=5).encode(\n    x='max_ram:Q',\n    y=alt.Y('Launch_year:O'),\n    text='max_ram:Q'\n)\n\n(bar + text_min + text_max).properties(\n    title=alt.Title(text='RAM Range by Launch Year', subtitle='Minimum and Maximum RAM for Each Year')\n)",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_range.png"
    },
    {
        "type": "type_B",
        "db_id": "phone_market",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_range",
        "NLQ": "I came across this bar chart image that I really like—it shows ranges with labels on each bar. Could you create something similar for me, but with the price range of phones grouped by their memory size in GB? Each bar should stretch from the lowest to the highest price for that memory size, and it'd be great if you could label the minimum and maximum prices. Also, could you make the bars thinner and add rounded corners? Please add a title \"Price Range by Memory Size\" with a subtitle \"Phone Market Analysis\" and include gridlines in the background.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/phone_market.sqlite')\n\nquery = '''\nSELECT \n    Memory_in_G, \n    MIN(Price) AS min_price, \n    MAX(Price) AS max_price\nFROM phone\nGROUP BY Memory_in_G\nORDER BY Memory_in_G\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbar = alt.Chart(df).mark_bar(cornerRadius=10, height=10).encode(\n    x=alt.X('min_price:Q').scale(domain=[0, df['max_price'].max() + 100]).title('Price Range ($)'),\n    x2='max_price:Q',\n    y=alt.Y('Memory_in_G:O').title('Memory Size (GB)')\n)\n\ntext_min = alt.Chart(df).mark_text(align='right', dx=-5).encode(\n    x='min_price:Q',\n    y=alt.Y('Memory_in_G:O'),\n    text='min_price:Q'\n)\n\ntext_max = alt.Chart(df).mark_text(align='left', dx=5).encode(\n    x='max_price:Q',\n    y=alt.Y('Memory_in_G:O'),\n    text='max_price:Q'\n)\n\n(bar + text_min + text_max).properties(\n    title=alt.Title(text='Price Range by Memory Size', subtitle='Phone Market Analysis')\n)",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_range.png"
    },
    {
        "type": "type_B",
        "db_id": "poker_player",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_rolling_mean",
        "NLQ": "I came across this bar chart that has a red line showing a trend, and I really like the style. Can you create something similar for me but using the earnings of poker players from the `poker_player` table, with their IDs on the x-axis? It would be great if the red line could show the rolling average of the earnings.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/poker_player.sqlite')\nquery = '''\nSELECT Poker_Player_ID, Earnings\nFROM poker_player\nORDER BY Poker_Player_ID\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbar = alt.Chart(df).mark_bar().encode(\n    x='Poker_Player_ID:O',\n    y='Earnings:Q'\n)\n\nline = alt.Chart(df).mark_line(color='red').transform_window(\n    rolling_mean='mean(Earnings)',\n    frame=[-9, 0]\n).encode(\n    x='Poker_Player_ID:O',\n    y='rolling_mean:Q'\n)\n\nchart = (bar + line).properties(\n    title='Poker Player Earnings with Rolling Mean',\n    width=600\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_rolling_mean.png"
    },
    {
        "type": "type_B",
        "db_id": "products_gen_characteristics",
        "chart_category": "Simple Charts",
        "chart_type": "simple_heatmap",
        "NLQ": "I came across this simple heatmap image that I really like the look of. Can you create a similar one that shows how product categories are spread across different color codes, with the color intensity representing the number of products in each combination? Use the product and color data from our database.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/products_gen_characteristics.sqlite')\n\nquery = '''\nSELECT \n    Ref_Colors.color_code,\n    Ref_Product_Categories.product_category_description,\n    COUNT(Products.product_id) AS product_count\nFROM Products\nJOIN Ref_Colors ON Products.color_code = Ref_Colors.color_code\nJOIN Ref_Product_Categories ON Products.product_category_code = Ref_Product_Categories.product_category_code\nGROUP BY Ref_Colors.color_code, Ref_Product_Categories.product_category_description\nORDER BY Ref_Colors.color_code, Ref_Product_Categories.product_category_description;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nheatmap = alt.Chart(df).mark_rect().encode(\n    x=alt.X('color_code:N', title='Color Code'),\n    y=alt.Y('product_category_description:N', title='Product Category'),\n    color=alt.Color('product_count:Q', title='Product Count')\n).properties(\n    title='Distribution of Product Categories by Color'\n)\n\nheatmap",
        "reference_path": "./vis_bench/img/Simple Charts___simple_heatmap.png"
    },
    {
        "type": "type_B",
        "db_id": "product_catalog",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_rounded_edges",
        "NLQ": "I came across this bar chart with rounded edges that looks really polished, and I'd love to use a similar style to visualize our product catalog data. Can you create one that shows the total number of products in each catalog, grouped by their catalog levels, with the catalog names on the x-axis and product counts on the y-axis? Also, add a proper title \"Total Number of Products by Catalog and Level\" and move the legend to the right side of the chart.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/product_catalog.sqlite')\n\nquery = '''\nSELECT \n    T1.catalog_id,\n    T2.catalog_name,\n    T1.catalog_level_number,\n    COUNT(T3.catalog_entry_id) AS product_count\nFROM \n    Catalog_Structure AS T1\nJOIN \n    Catalogs AS T2 ON T1.catalog_id = T2.catalog_id\nLEFT JOIN \n    Catalog_Contents AS T3 ON T1.catalog_id = T3.catalog_level_number\nGROUP BY \n    T1.catalog_id, T1.catalog_level_number\nORDER BY \n    T1.catalog_id, T1.catalog_level_number;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar(\n    cornerRadiusTopLeft=3,\n    cornerRadiusTopRight=3\n).encode(\n    x=alt.X('catalog_name:N', title='Catalog Name'),\n    y=alt.Y('product_count:Q', title='Number of Products'),\n    color=alt.Color('catalog_level_number:N', title='Catalog Level')\n).properties(\n    title='Total Number of Products by Catalog and Level'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_rounded_edges.png"
    },
    {
        "type": "type_B",
        "db_id": "product_catalog",
        "chart_category": "Simple Charts",
        "chart_type": "simple_histogram",
        "NLQ": "I came across this simple histogram that has a clean and professional look. Can you create something similar to show how many products fall into different price ranges in dollars from the Catalog_Contents table?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/product_catalog.sqlite')\n\nquery = '''\nSELECT price_in_dollars\nFROM Catalog_Contents\nWHERE price_in_dollars IS NOT NULL\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    alt.X(\"price_in_dollars:Q\", bin=True, title=\"Price in Dollars\"),\n    y='count()', \n    tooltip=['count()']\n).properties(\n    title=\"Distribution of Product Prices in Dollars\"\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Simple Charts___simple_histogram.png"
    },
    {
        "type": "type_B",
        "db_id": "program_share",
        "chart_category": "Simple Charts",
        "chart_type": "simple_histogram",
        "NLQ": "I came across this simple histogram that looks clean and professional. Can you create something similar to visualize the distribution of share percentages across all programs and channels using the broadcast_share, channel, and program tables?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/program_share.sqlite')\n\nquery = '''\nSELECT bs.Share_in_percent\nFROM broadcast_share AS bs\nJOIN channel AS c ON bs.Channel_ID = c.Channel_ID\nJOIN program AS p ON bs.Program_ID = p.Program_ID\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    alt.X(\"Share_in_percent:Q\", bin=True, title=\"Share Percentage\"),\n    y='count()', \n    tooltip=['count()']\n).properties(\n    title=\"Distribution of Share Percentages Across Programs and Channels\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Simple Charts___simple_histogram.png"
    },
    {
        "type": "type_B",
        "db_id": "protein_institute",
        "chart_category": "Simple Charts",
        "chart_type": "simple_histogram",
        "NLQ": "I came across this simple histogram that looks clean and professional. Can you create something similar to show how the number of floors is distributed for buildings that were once the tallest? I'd like to see the frequency breakdown.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/protein_institute.sqlite')\n\nquery = '''\nSELECT Floors\nFROM building\nWHERE Years_as_tallest IS NOT NULL AND Years_as_tallest != ''\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    alt.X(\"Floors:Q\", bin=True, title=\"Number of Floors\"),\n    y='count()',\n    tooltip=['Floors:Q', 'count()']\n).properties(\n    title=\"Distribution of Building Floors That Were Once the Tallest\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Simple Charts___simple_histogram.png"
    },
    {
        "type": "type_B",
        "db_id": "race_track",
        "chart_category": "Simple Charts",
        "chart_type": "simple_line_chart",
        "NLQ": "I like this sine wave chart, but could you use it to show me real data about race tracks instead? I'd like to see how many races each track has hosted, with the track names on the x-axis and the race count on the y-axis. Please use data from the race and track tables in the database.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/race_track.sqlite')\n\nquery = '''\nSELECT \n    t.Name AS Track_Name,\n    COUNT(r.Race_ID) AS Race_Count\nFROM \n    track AS t\nLEFT JOIN \n    race AS r ON t.Track_ID = r.Track_ID\nGROUP BY \n    t.Track_ID\nORDER BY \n    t.Track_ID\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_line().encode(\n    x='Track_Name:N',\n    y='Race_Count:Q'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Simple Charts___simple_line_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "railway",
        "chart_category": "Bar Charts",
        "chart_type": "calculating_percentage_of_total",
        "NLQ": "I came across this bar chart that shows percentages really clearly, and I love the way it looks. Can you create something similar for me but using our railway data to show what percentage of trains come from each location? It would be great if we could use the `railway` and `train` tables for this.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/railway.sqlite')\n\nquery = '''\nSELECT \n    T1.Location AS Location,\n    COUNT(T2.Train_ID) AS Train_Count\nFROM \n    railway AS T1\nJOIN \n    train AS T2 ON T1.Railway_ID = T2.Railway_ID\nGROUP BY \n    T1.Location\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).transform_joinaggregate(\n    TotalTrains='sum(Train_Count)',\n).transform_calculate(\n    PercentOfTotal=\"datum.Train_Count / datum.TotalTrains\"\n).mark_bar().encode(\n    alt.X('PercentOfTotal:Q').axis(format='.0%'),\n    y='Location:N'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___calculating_percentage_of_total.png"
    },
    {
        "type": "type_B",
        "db_id": "railway",
        "chart_category": "Simple Charts",
        "chart_type": "simple_line_chart",
        "NLQ": "I came across this simple line chart that looks clean and professional. Can you create something similar to show how the number of trains managed by railways has changed over the years, using the 'Built' year as the timeline? The data should come from the railway and train tables. Add a clear title at the top and label the axes properly.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/railway.sqlite')\n\nquery = '''\nSELECT \n    r.Built AS Year,\n    COUNT(t.Train_ID) AS Train_Count\nFROM \n    railway AS r\nLEFT JOIN \n    train AS t ON r.Railway_ID = t.Railway_ID\nWHERE \n    r.Built != '' AND r.Built != 'Unknown'\nGROUP BY \n    r.Built\nORDER BY \n    CAST(r.Built AS INTEGER)\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_line().encode(\n    x=alt.X('Year:N', title='Year Built'),\n    y=alt.Y('Train_Count:Q', title='Number of Trains')\n).properties(\n    title=\"Number of Trains Managed by Railways Over Time\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Simple Charts___simple_line_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "riding_club",
        "chart_category": "Simple Charts",
        "chart_type": "simple_scatter_plot_with_tooltips",
        "NLQ": "I like this scatter plot showing the relationship between horsepower and miles per gallon by car origin. Could you create a similar scatter plot but instead show the relationship between gold medals and total points for riding clubs? I'd like to see the points color-coded by region, and I'd like to be able to hover over each point to see the club name, region, gold medal count, and total points.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/riding_club.sqlite')\n\nquery = '''\nSELECT \n    c.Club_name, \n    c.Region, \n    m.Gold, \n    m.Points\nFROM \n    club AS c\nJOIN \n    match_result AS m\nON \n    c.Club_ID = m.Club_ID\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nscatter_plot = alt.Chart(df).mark_circle(size=60).encode(\n    x='Gold:Q',\n    y='Points:Q',\n    color='Region:N',\n    tooltip=['Club_name:N', 'Region:N', 'Gold:Q', 'Points:Q']\n).interactive()\n\nscatter_plot",
        "reference_path": "./vis_bench/img/Simple Charts___simple_scatter_plot_with_tooltips.png"
    },
    {
        "type": "type_B",
        "db_id": "sakila_1",
        "chart_category": "Bar Charts",
        "chart_type": "diverging_stacked_bar_chart",
        "NLQ": "I like this survey response visualization, but could you create a similar chart showing film ratings distribution across different movie categories? Instead of survey responses, use film ratings like G, PG, PG-13, R, and NC-17, and show the percentage breakdown for each film category from the Sakila database. Also, could you use a red-to-blue color scheme for the ratings instead of the current colors?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/sakila_1.sqlite')\n\nquery = '''\nSELECT \n    c.name AS category_name,\n    f.rating,\n    COUNT(*) AS count\nFROM \n    film AS f\nJOIN \n    film_category AS fc ON f.film_id = fc.film_id\nJOIN \n    category AS c ON fc.category_id = c.category_id\nGROUP BY \n    c.name, f.rating\nORDER BY \n    c.name, f.rating\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nrating_order = {'G': -2, 'PG': -1, 'PG-13': 0, 'R': 1, 'NC-17': 2}\ndf['type_code'] = df['rating'].map(rating_order)\n\ndef compute_percentages(group):\n    group = group.set_index('type_code').sort_index()\n    perc = (group['count'] / group['count'].sum()) * 100\n    group['percentage'] = perc\n    group['percentage_end'] = perc.cumsum() - (perc[-2] + perc[-1] + perc[0] / 2)\n    group['percentage_start'] = group['percentage_end'] - perc\n    return group\n\ndf = df.groupby('category_name').apply(compute_percentages).reset_index(drop=True)\n\ncolor_scale = alt.Scale(\n    domain=['G', 'PG', 'PG-13', 'R', 'NC-17'],\n    range=[\"#c30d24\", \"#f3a583\", \"#cccccc\", \"#94c6da\", \"#1770ab\"]\n)\n\ny_axis = alt.Axis(title=\"Film Category\", offset=5, ticks=False, minExtent=60, domain=False)\n\nchart = alt.Chart(df).mark_bar().encode(\n    x=alt.X(\"percentage_start:Q\", title=\"Percentage\"),\n    x2=\"percentage_end:Q\",\n    y=alt.Y(\"category_name:N\").axis(y_axis),\n    color=alt.Color(\"rating:N\").title(\"Rating\").scale(color_scale)\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___diverging_stacked_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "soccer_2",
        "chart_category": "Bar Charts",
        "chart_type": "grouped_bar_chart_with_xoffset",
        "NLQ": "I like this grouped bar chart showing player tryout decisions, but can you create a similar one using our soccer database? I'd like to see the count of players grouped by college on the x-axis, with bars for different positions side by side, and use colors to show whether the decision was \"yes\" or \"no\". Please use the Tryout table for this data.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/soccer_2.sqlite')\nquery = '''\nSELECT \n    T.cName AS College,\n    T.pPos AS Position,\n    T.decision AS Decision,\n    COUNT(T.pID) AS PlayerCount\nFROM Tryout AS T\nGROUP BY T.cName, T.pPos, T.decision\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x=\"College:N\",\n    y=\"PlayerCount:Q\",\n    xOffset=\"Position:N\",\n    color=\"Decision:N\"\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___grouped_bar_chart_with_xoffset.png"
    },
    {
        "type": "type_B",
        "db_id": "solvency_ii",
        "chart_category": "Bar Charts",
        "chart_type": "grouped_bar_chart_with_xoffset",
        "NLQ": "I like this grouped bar chart, but can you create one using our Solvency II database? I need to see the total number of products for each event type, broken down by product type. Please use a clear title like \"Total Products by Event Type and Product Type\" and make sure the axes are properly labeled.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/solvency_ii.sqlite')\n\nquery = '''\nSELECT \n    E.Event_Type_Code AS EventType,\n    P.Product_Type_Code AS ProductType,\n    COUNT(PE.Product_ID) AS ProductCount\nFROM \n    Events AS E\nJOIN \n    Products_in_Events AS PE ON E.Event_ID = PE.Event_ID\nJOIN \n    Products AS P ON PE.Product_ID = P.Product_ID\nGROUP BY \n    E.Event_Type_Code, P.Product_Type_Code\nORDER BY \n    E.Event_Type_Code, P.Product_Type_Code;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x=alt.X(\"EventType:N\", title=\"Event Type\"),\n    y=alt.Y(\"ProductCount:Q\", title=\"Total Number of Products\"),\n    xOffset=\"ProductType:N\",\n    color=\"ProductType:N\"\n).properties(\n    title=\"Total Products by Event Type and Product Type\"\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___grouped_bar_chart_with_xoffset.png"
    },
    {
        "type": "type_B",
        "db_id": "solvency_ii",
        "chart_category": "Tables",
        "chart_type": "lasagna_plot_dense_time-series_heatmap",
        "NLQ": "I like this heatmap showing stock prices, but could you create a similar one using our event data instead? I'd like to see total product prices for different event types (like Ceremonies, Conferences, Seminars, and Trade Shows) over time. Please add a descriptive title, make the y-axis show the event types clearly, and use a viridis color scheme to represent the total prices. Also, could you format the x-axis to show year-month and angle the labels so they're easier to read?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/solvency_ii.sqlite')\nquery = '''\nSELECT \n    E.Event_Type_Code AS Event_Type,\n    strftime('%Y-%m', A.Address_Details) AS Month,\n    SUM(P.Product_Price) AS Total_Price\nFROM \n    Events AS E\nJOIN \n    Products_in_Events AS PE ON E.Event_ID = PE.Event_ID\nJOIN \n    Products AS P ON PE.Product_ID = P.Product_ID\nJOIN \n    Addresses AS A ON E.Address_ID = A.Address_ID\nGROUP BY \n    E.Event_Type_Code, strftime('%Y-%m', A.Address_Details)\nORDER BY \n    Month, Event_Type;\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df, width=400, height=200).mark_rect().encode(\n    alt.X(\"Month:O\").title(\"Time (Year-Month)\").axis(labelAngle=-45),\n    alt.Y(\"Event_Type:N\").title(\"Event Type\"),\n    alt.Color(\"Total_Price:Q\").title(\"Total Price\").scale(scheme=\"viridis\")\n).properties(\n    title=\"Heatmap of Total Product Prices by Event Type Over Time\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Tables___lasagna_plot_dense_time-series_heatmap.png"
    },
    {
        "type": "type_B",
        "db_id": "station_weather",
        "chart_category": "Bar Charts",
        "chart_type": "grouped_bar_chart_with_xoffset_and_overlapping_bars",
        "NLQ": "I like this grouped bar chart showing high and low values. Could you create a similar chart but with high and low temperatures for each day of the week from station 1? Please show the actual temperature values above each bar, use blue for high temperatures and orange for low temperatures, and make sure the y-axis starts at zero to properly show the temperature range.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/station_weather.sqlite')\nquery = '''\nSELECT \n    day_of_week AS day,\n    high_temperature AS temperature,\n    'High' AS temp_type\nFROM \n    weekly_weather\nWHERE \n    station_id = 1\nUNION ALL\nSELECT \n    day_of_week AS day,\n    low_temperature AS temperature,\n    'Low' AS temp_type\nFROM \n    weekly_weather\nWHERE \n    station_id = 1\nORDER BY \n    day\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df, width=alt.Step(20)).encode(\n    x=\"day:N\",\n    y=\"temperature:Q\",\n    xOffset=alt.XOffset(\"temp_type:N\").scale(paddingOuter=0.5),\n)\n\nchart = alt.layer(\n    base.mark_bar(size=20, stroke=\"white\", fillOpacity=0.9).encode(fill=\"temp_type:N\"),\n    base.mark_text(dy=-5).encode(text=\"temperature:Q\"),\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___grouped_bar_chart_with_xoffset_and_overlapping_bars.png"
    },
    {
        "type": "type_B",
        "db_id": "store_1",
        "chart_category": "Bar Charts",
        "chart_type": "grouped_bar_chart_with_xoffset_and_overlapping_bars",
        "NLQ": "I like this grouped bar chart showing sales data, but could you modify it to show total sales by music genre for the top 5 countries with the highest sales? Please use a title like \"Total Sales by Genre and Country\" and label the y-axis as \"Total Sales\". Also, display the actual sales numbers above each bar, and change the colors to use blue for Latin and orange for Rock genres.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/store_1.sqlite')\n\nquery = '''\nWITH CountrySales AS (\n    SELECT\n        c.country,\n        g.name AS genre,\n        SUM(il.unit_price * il.quantity) AS total_sales,\n        RANK() OVER (ORDER BY SUM(il.unit_price * il.quantity) DESC) as country_rank\n    FROM customers c\n    JOIN invoices i ON c.id = i.customer_id\n    JOIN invoice_lines il ON i.id = il.invoice_id\n    JOIN tracks t ON il.track_id = t.id\n    JOIN genres g ON t.genre_id = g.id\n    GROUP BY c.country, g.name\n)\nSELECT\n    cs.country,\n    cs.genre,\n    cs.total_sales\nFROM CountrySales cs\nWHERE country_rank <= 5;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df, width=alt.Step(12)).encode(\n    x=alt.X(\"country:N\", title=\"Country\"),\n    y=alt.Y(\"total_sales:Q\", title=\"Total Sales\"),\n    xOffset=alt.XOffset(\"genre:N\", title=\"Genre\").scale(paddingOuter=0.5),\n)\n\nalt.layer(\n    base.mark_bar(size=20, stroke=\"white\", fillOpacity=0.9).encode(fill=alt.Color(\"genre:N\", title=\"Genre\")),\n    base.mark_text(dy=-5).encode(text=alt.Text(\"total_sales:Q\", format=\".2f\")),\n).properties(\n    title=\"Total Sales by Genre and Country (Top 5 Countries)\"\n)",
        "reference_path": "./vis_bench/img/Bar Charts___grouped_bar_chart_with_xoffset_and_overlapping_bars.png"
    },
    {
        "type": "type_B",
        "db_id": "theme_gallery",
        "chart_category": "Bar Charts",
        "chart_type": "horizontal_grouped_bar_chart",
        "NLQ": "I like this horizontal bar chart showing exhibition themes, but could you split it up by theme and show the attendance for each year with different colors? Also, can you arrange it vertically with each theme as a separate row so it's easier to compare attendance across years for the same theme?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/theme_gallery.sqlite')\n\nquery = '''\nSELECT \n    e.Theme AS Theme, \n    e.Year AS Year, \n    SUM(er.Attendance) AS Total_Attendance\nFROM \n    exhibition AS e\nJOIN \n    exhibition_record AS er ON e.Exhibition_ID = er.Exhibition_ID\nGROUP BY \n    e.Theme, e.Year\nORDER BY \n    e.Theme, e.Year\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='Total_Attendance:Q',\n    y='Theme:N',\n    color='Year:N',\n    row='Theme:N'\n).properties(\n    width=600,\n    height=100\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___horizontal_grouped_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "tracking_grants_for_research",
        "chart_category": "Bar Charts",
        "chart_type": "horizontal_grouped_bar_chart",
        "NLQ": "I like this horizontal bar chart showing wheat production over years. Could you create a similar chart but instead show total grant amounts by organization type? I want to see which types of organizations receive the most funding in our research grants database.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/tracking_grants_for_research.sqlite')\nquery = '''\nSELECT \n    ot.organisation_type_description AS Organisation_Type,\n    SUM(g.grant_amount) AS Total_Grant_Amount\nFROM \n    Grants AS g\nJOIN \n    Organisations AS o ON g.organisation_id = o.organisation_id\nJOIN \n    Organisation_Types AS ot ON o.organisation_type = ot.organisation_type\nGROUP BY \n    ot.organisation_type_description\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\nchart = alt.Chart(df).mark_bar().encode(\n    x='Total_Grant_Amount:Q',\n    y='Organisation_Type:N'\n).properties(\n    height=400,\n    title=\"Total Grant Amounts by Organisation Type\"\n)\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___horizontal_grouped_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "tracking_share_transactions",
        "chart_category": "Bar Charts",
        "chart_type": "horizontal_stacked_bar_chart",
        "NLQ": "Can you create a horizontal bar chart showing total transaction amounts by investor? I'd like to see the transactions broken down by type (Purchase and Sale) with different colors for each type. Please use a clean, simple design with a grid in the background and a legend on the right side.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/tracking_share_transactions.sqlite')\nquery = '''\nSELECT \n    I.Investor_details AS investor,\n    RT.transaction_type_description AS transaction_type,\n    SUM(T.amount_of_transaction) AS total_amount\nFROM \n    Transactions AS T\nJOIN \n    Investors AS I ON T.investor_id = I.investor_id\nJOIN \n    Ref_Transaction_Types AS RT ON T.transaction_type_code = RT.transaction_type_code\nGROUP BY \n    I.Investor_details, RT.transaction_type_description\nORDER BY \n    I.Investor_details\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='sum(total_amount):Q',\n    y='investor:N',\n    color='transaction_type:N'\n).properties(\n    title=\"Total Transaction Amounts by Investor and Type\"\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___horizontal_stacked_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "tracking_share_transactions",
        "chart_category": "Uncertainties And Trends",
        "chart_type": "error_bars_with_standard_deviation",
        "NLQ": "I came across this error bar chart that looks really professional, and I'd love to use a similar style to show the average transaction amounts along with their variability, grouped by transaction type. Can you pull the transaction data from the Transactions table and match it with the descriptions in the Ref_Transaction_Types table to create this? I need to see Purchase and Sale transaction types, with the mean transaction amount shown as black dots and standard deviation as horizontal error bars. Please make sure the x-axis shows the transaction amount with negative values for some transactions.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\ndatabase_path = 'database/tracking_share_transactions.sqlite'\nconn = sqlite3.connect(database_path)\n\nquery = '''\nSELECT\n    T2.transaction_type_description,\n    T1.amount_of_transaction\nFROM Transactions AS T1\nJOIN Ref_Transaction_Types AS T2 ON T1.transaction_type_code = T2.transaction_type_code;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nerror_bars = alt.Chart(df).mark_errorbar(extent='stdev').encode(\n    x=alt.X('amount_of_transaction', scale=alt.Scale(zero=False), title='Transaction Amount'),\n    y=alt.Y('transaction_type_description', title='Transaction Type')\n)\n\npoints = alt.Chart(df).mark_point(filled=True, color='black').encode(\n    x=alt.X('mean(amount_of_transaction)', title='Mean Transaction Amount'),\n    y=alt.Y('transaction_type_description', title='Transaction Type'),\n)\n\nerror_bars + points",
        "reference_path": "./vis_bench/img/Uncertainties And Trends___error_bars_with_standard_deviation.png"
    },
    {
        "type": "type_B",
        "db_id": "tracking_software_problems",
        "chart_category": "Bar Charts",
        "chart_type": "horizontal_stacked_bar_chart",
        "NLQ": "I like this horizontal bar chart showing problem categories. Could you create a similar chart that shows the distribution of software problems by category, with each bar broken down by status (like Reported and Solved)? Use blue for Reported issues and orange for Solved ones.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/tracking_software_problems.sqlite')\n\nquery = '''\nSELECT \n    pcc.problem_category_description AS category,\n    psc.problem_status_description AS status,\n    COUNT(*) AS count\nFROM \n    Problem_Log AS pl\nJOIN \n    Problem_Category_Codes AS pcc ON pl.problem_category_code = pcc.problem_category_code\nJOIN \n    Problem_Status_Codes AS psc ON pl.problem_status_code = psc.problem_status_code\nGROUP BY \n    pcc.problem_category_description, psc.problem_status_description\nORDER BY \n    pcc.problem_category_description, psc.problem_status_description;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='sum(count):Q',\n    y='category:N',\n    color='status:N'\n).properties(\n    title=\"Problem Distribution by Category and Status\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___horizontal_stacked_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "train_station",
        "chart_category": "Bar Charts",
        "chart_type": "layered_bar_chart",
        "NLQ": "Can you create a bar chart showing passenger traffic data for London train stations? I'd like to see both entry/exit counts and interchange numbers for each station displayed as non-stacked bars side by side, using different colors to distinguish between the two traffic types. Make the bars semi-transparent and include a legend.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/train_station.sqlite')\n\nquery = '''\nSELECT \n    Name AS Station_Name,\n    Annual_entry_exit AS Entry_Exit,\n    Annual_interchanges AS Interchanges\nFROM \n    station\nWHERE \n    Location = 'London'\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndf_melted = df.melt(id_vars='Station_Name', value_vars=['Entry_Exit', 'Interchanges'], \n                    var_name='Traffic_Type', value_name='Passenger_Count')\n\nchart = alt.Chart(df_melted).mark_bar(opacity=0.7).encode(\n    x='Station_Name:N',\n    y=alt.Y('Passenger_Count:Q').stack(None),\n    color='Traffic_Type:N'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___layered_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "tvshow",
        "chart_category": "Bar Charts",
        "chart_type": "layered_bar_chart",
        "NLQ": "I like this chart showing TV series viewership, but could you make it so the bars for each series are unstacked and overlapping instead? I want to see the individual rating categories side by side for each show, with the bars slightly transparent. Also, remove the grid lines and just keep the series names on the x-axis.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/tvshow.sqlite')\n\nquery = '''\nSELECT \n    T2.series_name AS Series_Name,\n    T1.Rating,\n    SUM(CAST(T1.Viewers_m AS REAL)) AS Total_Viewers\nFROM \n    TV_series AS T1\nJOIN \n    TV_Channel AS T2\nON \n    T1.Channel = T2.id\nGROUP BY \n    T2.series_name, T1.Rating\nORDER BY \n    T2.series_name, T1.Rating;\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_bar(opacity=0.7).encode(\n    x='Series_Name:N',\n    y=alt.Y('Total_Viewers:Q').stack(None),\n    color='Rating:N'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___layered_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "twitter_1",
        "chart_category": "Bar Charts",
        "chart_type": "layered_bar_chart",
        "NLQ": "I like this stacked bar chart showing energy generation, but I'd like to create something similar for Twitter data instead. Can you make a chart showing tweets by popular users with over a million followers, broken down by day of the week? Use different colors for each user and make the bars semi-transparent. Title it \"Tweets by Users with >1M Followers Grouped by Day of Week\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/twitter_1.sqlite')\n\nquery = '''\nSELECT \n    strftime('%w', t.createdate) AS day_of_week,\n    u.name AS user_name,\n    COUNT(t.id) AS tweet_count\nFROM \n    tweets AS t\nJOIN \n    user_profiles AS u ON t.uid = u.uid\nWHERE \n    u.followers > 1000000\nGROUP BY \n    day_of_week, user_name\nORDER BY \n    day_of_week;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nweekday_map = {\n    '0': 'Sunday',\n    '1': 'Monday',\n    '2': 'Tuesday',\n    '3': 'Wednesday',\n    '4': 'Thursday',\n    '5': 'Friday',\n    '6': 'Saturday'\n}\ndf['day_of_week'] = df['day_of_week'].map(weekday_map)\n\nchart = alt.Chart(df).mark_bar(opacity=0.7).encode(\n    x=alt.X('day_of_week:N', title='Day of Week'),\n    y=alt.Y('tweet_count:Q', title='Number of Tweets').stack(None),\n    color=alt.Color('user_name:N', title='User')\n).properties(\n    title='Tweets by Users with >1M Followers Grouped by Day of Week'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___layered_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "twitter_1",
        "chart_category": "Uncertainties And Trends",
        "chart_type": "line_chart_with_confidence_interval_band",
        "NLQ": "I came across this line chart with a shaded band around it, and I really like how it shows trends along with some variability. Can you create something similar to visualize the average number of followers for users who tweet each day over time, using our tweets and user profiles data? Make sure to title it \"Average Followers per Day with Confidence Interval\" and label the y-axis as \"Followers\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/twitter_1.sqlite')\n\nquery = '''\nSELECT \n    DATE(t.createdate) AS date, \n    AVG(up.followers) AS avg_followers, \n    up.followers AS individual_followers\nFROM \n    tweets AS t\nJOIN \n    user_profiles AS up \nON \n    t.uid = up.uid\nGROUP BY \n    DATE(t.createdate), up.uid\nORDER BY \n    DATE(t.createdate)\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nline = alt.Chart(df).mark_line().encode(\n    x='date:T',\n    y='mean(avg_followers):Q'\n)\n\nband = alt.Chart(df).mark_errorband(extent='ci').encode(\n    x='date:T',\n    y=alt.Y('individual_followers:Q').title('Followers')\n)\n\nchart = band + line\nchart.properties(title=\"Average Followers per Day with Confidence Interval\")",
        "reference_path": "./vis_bench/img/Uncertainties And Trends___line_chart_with_confidence_interval_band.png"
    },
    {
        "type": "type_B",
        "db_id": "university_basketball",
        "chart_category": "Bar Charts",
        "chart_type": "normalized_stacked_bar_chart",
        "NLQ": "I came across this bar chart that uses a normalized stacked design, and I really like how it compares categories visually. Could you create something similar to show the ACC home versus road win percentages for each basketball team from the `basketball_match` table? Use blue for home wins and orange for road wins, and make the chart horizontal with team names on the y-axis. Also, change the title to \"Normalized Comparison of ACC Home vs Road Wins\" and show percentages on the x-axis.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/university_basketball.sqlite')\nquery = '''\nSELECT \n    Team_Name,\n    CAST(SUBSTR(ACC_Home, 1, INSTR(ACC_Home, '–') - 1) AS INT) AS ACC_Home_Wins,\n    CAST(SUBSTR(ACC_Road, 1, INSTR(ACC_Road, '–') - 1) AS INT) AS ACC_Road_Wins\nFROM basketball_match\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndf_long = df.melt(id_vars=['Team_Name'], \n                  value_vars=['ACC_Home_Wins', 'ACC_Road_Wins'],\n                  var_name='Game_Location', \n                  value_name='Wins')\n\nchart = alt.Chart(df_long).mark_bar().encode(\n    x=alt.X('sum(Wins)').stack(\"normalize\"),\n    y='Team_Name:N',\n    color='Game_Location:N'\n).properties(\n    title=\"Normalized Comparison of ACC Home vs Road Wins\"\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___normalized_stacked_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "voter_1",
        "chart_category": "Bar Charts",
        "chart_type": "normalized_stacked_bar_chart",
        "NLQ": "I came across this really clean bar chart design—love how it uses stacked colors to show proportions. Can you recreate something like that to show how votes are split across states for each contestant? Ideally, the x-axis would show percentages, and the y-axis would list the contestants.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/voter_1.sqlite')\n\nquery = '''\nSELECT \n    CONTESTANTS.contestant_name AS contestant,\n    VOTES.state AS state,\n    COUNT(VOTES.vote_id) AS vote_count\nFROM VOTES\nJOIN CONTESTANTS ON VOTES.contestant_number = CONTESTANTS.contestant_number\nGROUP BY CONTESTANTS.contestant_name, VOTES.state\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x=alt.X('sum(vote_count)').stack(\"normalize\").title('Percentage of Votes'),\n    y='contestant:N',\n    color='state:N'\n).properties(\n    title='Vote Distribution Across States for Each Contestant'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___normalized_stacked_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "voter_2",
        "chart_category": "Bar Charts",
        "chart_type": "normalized_stacked_bar_chart",
        "NLQ": "I like this stacked bar chart showing barley yield by variety, but I need something similar for our voting data. Could you create a horizontal normalized stacked bar chart showing the proportion of votes for President, Vice President, and Secretary across different election cycles? I'd like to see Spring and Fall election cycles on the y-axis, with the proportions of different vote types shown as percentages on the x-axis.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/voter_2.sqlite')\n\nquery = '''\nSELECT \n    Election_Cycle,\n    SUM(President_Vote) AS Total_President_Votes,\n    SUM(Vice_President_Vote) AS Total_Vice_President_Votes,\n    SUM(Secretary_Vote) AS Total_Secretary_Votes\nFROM Voting_record\nGROUP BY Election_Cycle\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndf_melted = df.melt(id_vars=['Election_Cycle'], \n                    value_vars=['Total_President_Votes', 'Total_Vice_President_Votes', 'Total_Secretary_Votes'],\n                    var_name='Vote_Type', value_name='Total_Votes')\n\nchart = alt.Chart(df_melted).mark_bar().encode(\n    x=alt.X('sum(Total_Votes)').stack(\"normalize\"),\n    y='Election_Cycle',\n    color='Vote_Type'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___normalized_stacked_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "voter_2",
        "chart_category": "Uncertainties And Trends",
        "chart_type": "polynomial_fit_plot_with_regression_transform",
        "NLQ": "I came across this scatter plot image that uses trend lines to show patterns, and I really like its style. Can you create something similar to visualize how student age relates to advisor ID from the Student table, with polynomial trend lines of degree 1, 3, and 5? But make these changes: remove the title, put the legend on the right side instead of in the chart, use a grid background, and don't label the points as \"Data Points\" in the legend.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/voter_2.sqlite')\nquery = '''\nSELECT Age, Advisor FROM Student;\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\ndf.rename(columns={'Age': 'x', 'Advisor': 'y'}, inplace=True)\ndegree_list = [1, 3, 5]\n\nbase = alt.Chart(df).mark_circle(color=\"black\").encode(\n    alt.X(\"x\"),\n    alt.Y(\"y\")\n)\n\npolynomial_fit = [\n    base.transform_regression(\n        \"x\", \"y\", method=\"poly\", order=order, as_=[\"x\", str(order)]\n    )\n    .mark_line()\n    .transform_fold([str(order)], as_=[\"degree\", \"y\"])\n    .encode(alt.Color(\"degree:N\"))\n    for order in degree_list\n]\n\nchart = alt.layer(base, *polynomial_fit)\n\nchart",
        "reference_path": "./vis_bench/img/Uncertainties And Trends___polynomial_fit_plot_with_regression_transform.png"
    },
    {
        "type": "type_B",
        "db_id": "workshop_paper",
        "chart_category": "Bar Charts",
        "chart_type": "sorted_bar_chart",
        "NLQ": "Can you create a similar horizontal bar chart showing average submission scores for different colleges? I'd like to see the colleges sorted from highest to lowest score, remove the title, and use a simpler blue color scheme.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/workshop_paper.sqlite')\n\nquery = '''\nSELECT College, AVG(Scores) AS Average_Score\nFROM submission\nGROUP BY College\nORDER BY Average_Score DESC\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='Average_Score:Q',\n    y=alt.Y('College:N').sort('-x')\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___sorted_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "world_1",
        "chart_category": "Bar Charts",
        "chart_type": "sorted_bar_chart",
        "NLQ": "I like this bar chart showing yield by site. Could you create something similar but instead show the 10 most populated cities from the city table in the database? Keep the same horizontal bar style with cities sorted by population in descending order, but remove the title and make the chart a bit simpler and cleaner.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/world_1.sqlite')\nquery = '''\nSELECT Name, Population\nFROM city\nORDER BY Population DESC\nLIMIT 10\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='Population:Q',\n    y=alt.Y('Name:N').sort('-x')\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___sorted_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "world_1",
        "chart_category": "Uncertainties And Trends",
        "chart_type": "scatter_plot_with_loess_lines",
        "NLQ": "I like this scatter plot showing the relationship between x and y variables, but could you create a similar one specifically for European countries? I'd like to see how population relates to GNP, with each point representing a country. Make the dots semi-transparent blue circles and add a smooth trend line to show the pattern. Please use proper labels for the axes - Population on the x-axis and Gross National Product on the y-axis.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/world_1.sqlite')\nquery = '''\nSELECT \n    country.Population, \n    country.GNP, \n    country.Continent\nFROM \n    country\nWHERE \n    country.Continent = 'Europe' AND country.GNP IS NOT NULL AND country.Population > 0\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).mark_circle(opacity=0.7).encode(\n    alt.X('Population:Q', title='Population'),\n    alt.Y('GNP:Q', title='Gross National Product (GNP)'),\n    alt.Color('Continent:N', title='Continent')\n)\nchart = base + base.transform_loess('Population', 'GNP', groupby=['Continent']).mark_line(size=3)\nchart.properties(width=600, height=400)",
        "reference_path": "./vis_bench/img/Uncertainties And Trends___scatter_plot_with_loess_lines.png"
    },
    {
        "type": "type_B",
        "db_id": "wrestler",
        "chart_category": "Bar Charts",
        "chart_type": "stacked_bar_chart",
        "NLQ": "Can you create a stacked bar chart showing the total days wrestlers held their reigns by location? Use different colors to represent different event types, and put the locations on the x-axis instead of varieties. Also, remove the title and make the y-axis show the actual values without abbreviating them.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/wrestler.sqlite')\n\nquery = '''\nSELECT Location, Event, SUM(CAST(Days_held AS INT)) AS Total_Days_Held\nFROM wrestler\nGROUP BY Location, Event\nORDER BY Location, Event\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='Location:N',\n    y='Total_Days_Held:Q',\n    color='Event:N'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___stacked_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "wrestler",
        "chart_category": "Uncertainties And Trends",
        "chart_type": "scatter_plot_with_loess_lines",
        "NLQ": "Can you create a scatter plot with trend lines showing the relationship between how many days wrestlers held their titles and their elimination times in seconds? I'd like to see this broken down by team, with different colors for each team, and I only want data from live events. Please make the points semi-transparent and add a descriptive title.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/wrestler.sqlite')\n\nquery = '''\nSELECT \n    w.Days_held AS Days_Held,\n    CAST(substr(e.Time, 4, 2) AS INTEGER) * 60 + CAST(substr(e.Time, 7, 2) AS INTEGER) AS Elimination_Time_Seconds,\n    e.Team AS Team\nFROM \n    wrestler AS w\nJOIN \n    Elimination AS e\nON \n    w.Wrestler_ID = e.Wrestler_ID\nWHERE \n    w.Event = 'Live event'\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).mark_circle(opacity=0.5).encode(\n    alt.X('Days_Held:Q', title='Days Held'),\n    alt.Y('Elimination_Time_Seconds:Q', title='Elimination Time (Seconds)'),\n    alt.Color('Team:N', title='Team')\n)\n\nchart = base + base.transform_loess('Days_Held', 'Elimination_Time_Seconds', groupby=['Team']).mark_line(size=4)\n\nchart.properties(\n    title=\"Relationship Between Days Held and Elimination Time by Team\"\n)",
        "reference_path": "./vis_bench/img/Uncertainties And Trends___scatter_plot_with_loess_lines.png"
    },
    {
        "type": "type_B",
        "db_id": "apartment_rentals",
        "chart_category": "Bar Charts",
        "chart_type": "stacked_bar_chart_with_sorted_segments",
        "NLQ": "Can you create a horizontal stacked bar chart showing the total number of apartments by building type, with each bar broken down by facility code? I'd like to see Studio, Flat, and Duplex building types, with the facilities like Broadband and Swimming Pool shown in different colors. Please put the building types on the y-axis and the apartment count on the x-axis, and include a title \"Total Apartments by Building Type and Facilities\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/apartment_rentals.sqlite')\n\nquery = '''\nSELECT \n    AB.building_description AS building_type,\n    AF.facility_code,\n    COUNT(AF.apt_id) AS apartment_count\nFROM \n    Apartment_Buildings AS AB\nJOIN \n    Apartments AS A ON AB.building_id = A.building_id\nJOIN \n    Apartment_Facilities AS AF ON A.apt_id = AF.apt_id\nGROUP BY \n    AB.building_description, AF.facility_code\nORDER BY \n    AB.building_description, AF.facility_code\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='sum(apartment_count):Q',\n    y='building_type:N',\n    color='facility_code:N',\n    order=alt.Order(\n        'facility_code:N',\n        sort='ascending'\n    )\n).properties(\n    title=\"Total Apartments by Building Type and Facilities\"\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___stacked_bar_chart_with_sorted_segments.png"
    },
    {
        "type": "type_B",
        "db_id": "architecture",
        "chart_category": "Bar Charts",
        "chart_type": "stacked_bar_chart_with_sorted_segments",
        "NLQ": "Can you change this stacked bar chart to a horizontal bar chart showing the total length of bridges by architect nationality? I'd like the nationalities listed on the y-axis and the total length in meters on the x-axis. Also, please color-code each nationality and add a legend on the right side.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/architecture.sqlite')\n\nquery = '''\nSELECT \n    a.nationality AS nationality,\n    SUM(b.length_meters) AS total_length_meters\nFROM \n    architect AS a\nJOIN \n    bridge AS b ON a.id = b.architect_id\nGROUP BY \n    a.nationality\nORDER BY \n    a.nationality ASC;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='sum(total_length_meters):Q',\n    y='nationality:N',\n    color='nationality:N',\n    order=alt.Order(\n        'nationality',\n        sort='ascending'\n    )\n).properties(\n    title=\"Total Length of Bridges by Architect Nationality\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___stacked_bar_chart_with_sorted_segments.png"
    },
    {
        "type": "type_B",
        "db_id": "battle_death",
        "chart_category": "Bar Charts",
        "chart_type": "stacked_bar_chart_with_text_overlay",
        "NLQ": "I like this stacked bar chart showing yield by variety and site, but I need something different. Can you create a horizontal bar chart showing total killed and injured for each battle from the battle and death tables? Make the bars blue with darker blue indicating more injured people, and add the number of killed as white text on each bar. Also, put the battle names on the y-axis and title it \"Total Killed and Injured in Battles\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/battle_death.sqlite')\n\nquery = '''\nSELECT \n    b.name AS battle_name,\n    SUM(d.killed) AS total_killed,\n    SUM(d.injured) AS total_injured\nFROM \n    battle AS b\nJOIN \n    death AS d ON b.id = d.caused_by_ship_id\nGROUP BY \n    b.name\nORDER BY \n    total_killed DESC, total_injured DESC;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbars = alt.Chart(df).mark_bar().encode(\n    x=alt.X('total_killed:Q', stack='zero', title='Total Killed and Injured'),\n    y=alt.Y('battle_name:N', title='Battle Name'),\n    color=alt.Color('total_injured:Q', scale=alt.Scale(scheme='blues'), title='Injured')\n)\n\ntext = alt.Chart(df).mark_text(dx=-15, dy=3, color='white').encode(\n    x=alt.X('total_killed:Q', stack='zero'),\n    y=alt.Y('battle_name:N'),\n    detail='total_injured:Q',\n    text=alt.Text('total_killed:Q', format='.0f')\n)\n\n(bars + text).properties(\n    title='Total Killed and Injured in Battles'\n)",
        "reference_path": "./vis_bench/img/Bar Charts___stacked_bar_chart_with_text_overlay.png"
    },
    {
        "type": "type_B",
        "db_id": "behavior_monitoring",
        "chart_category": "Circular Plots",
        "chart_type": "donut_chart",
        "NLQ": "I came across this donut chart design that I really like. Can you create a similar one showing the breakdown of different behavior incident types, with each slice representing the proportion of incidents? It would be great to visualize the data from the Behavior_Incident and Ref_Incident_Type tables. Instead of using numbered categories, please use the actual incident type descriptions like Disturbance, Noise, and Violence.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/behavior_monitoring.sqlite')\n\nquery = '''\nSELECT \n    Ref_Incident_Type.incident_type_description AS incident_type,\n    COUNT(Behavior_Incident.incident_id) AS incident_count\nFROM \n    Behavior_Incident\nJOIN \n    Ref_Incident_Type ON Behavior_Incident.incident_type_code = Ref_Incident_Type.incident_type_code\nGROUP BY \n    Ref_Incident_Type.incident_type_description\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\ndonut_chart = alt.Chart(df).mark_arc(innerRadius=50).encode(\n    theta=\"incident_count:Q\",\n    color=\"incident_type:N\"\n)\n\ndonut_chart",
        "reference_path": "./vis_bench/img/Circular Plots___donut_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "bike_1",
        "chart_category": "Circular Plots",
        "chart_type": "donut_chart",
        "NLQ": "I like this donut chart style. Could you create one showing the number of bike trips by city from our bike-sharing database? I'd like to see which cities have the most trips, with the city names in the legend instead of numbers, and add tooltips so we can see the exact trip counts when hovering over each segment.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/bike_1.sqlite')\n\nquery = '''\nSELECT s.city, COUNT(t.id) AS trip_count\nFROM trip AS t\nJOIN station AS s ON t.start_station_id = s.id\nGROUP BY s.city\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_arc(innerRadius=50).encode(\n    theta=\"trip_count\",\n    color=\"city:N\",\n    tooltip=[\"city\", \"trip_count\"]\n)\n\nchart",
        "reference_path": "./vis_bench/img/Circular Plots___donut_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "body_builder",
        "chart_category": "Circular Plots",
        "chart_type": "donut_chart",
        "NLQ": "I like this donut chart style. Could you create one showing the total weight lifted by bodybuilders from different birthplaces? Instead of using numbers for categories, please use the actual birthplace names and put the legend on the right side of the chart.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/body_builder.sqlite')\nquery = '''\nSELECT p.Birth_Place AS BirthPlace, SUM(b.Total) AS TotalWeightLifted\nFROM body_builder AS b\nJOIN people AS p ON b.People_ID = p.People_ID\nGROUP BY p.Birth_Place\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_arc(innerRadius=50).encode(\n    theta=\"TotalWeightLifted:Q\",\n    color=\"BirthPlace:N\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Circular Plots___donut_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "book_2",
        "chart_category": "Circular Plots",
        "chart_type": "pacman_chart",
        "NLQ": "Can you flip the Pac-Man chart so the mouth is facing right instead of left? I'd like it to look like the classic Pac-Man character.",
        "code": "import numpy as np\nimport altair as alt\nimport sqlite3\nimport pandas as pd\n\nconn = sqlite3.connect('database/book_2.sqlite')\nquery = \"SELECT COUNT(*) FROM publication\"\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart().mark_arc(color=\"gold\").encode(\n    theta=alt.ThetaDatum((5 / 8) * np.pi).scale(None),\n    theta2=alt.Theta2Datum((19 / 8) * np.pi),\n    radius=alt.RadiusDatum(100).scale(None),\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Circular Plots___pacman_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "city_record",
        "chart_category": "Circular Plots",
        "chart_type": "pie_chart",
        "NLQ": "I came across this pie chart design that looks really clear and professional. Could you use it to show the GDP distribution for the top 5 cities with the highest GDP from the city table? I'd love to see how each city's share compares to the total. Instead of using numbers for the legend, please use the actual city names.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/city_record.sqlite')\n\nquery = '''\nSELECT City, GDP\nFROM city\nORDER BY GDP DESC\nLIMIT 5\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_arc().encode(\n    theta=\"GDP\",\n    color=\"City\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Circular Plots___pie_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "climbing",
        "chart_category": "Circular Plots",
        "chart_type": "pie_chart_with_labels",
        "NLQ": "Can you create a pie chart showing the total points earned by climbers at different mountains? Instead of using letters like in the example, please use the actual mountain names as labels and place them outside the pie slices. Also, remove the legend since the labels will show which mountain is which.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/climbing.sqlite')\n\nquery = '''\nSELECT \n    m.Name AS Mountain_Name, \n    SUM(c.Points) AS Total_Points\nFROM climber AS c\nJOIN mountain AS m ON c.Mountain_ID = m.Mountain_ID\nGROUP BY m.Name\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    alt.Theta(\"Total_Points:Q\").stack(True),\n    alt.Color(\"Mountain_Name:N\").legend(None)\n)\n\npie = base.mark_arc(outerRadius=120)\ntext = base.mark_text(radius=140, size=20).encode(text=\"Mountain_Name:N\")\n\nchart = pie + text\nchart",
        "reference_path": "./vis_bench/img/Circular Plots___pie_chart_with_labels.png"
    },
    {
        "type": "type_B",
        "db_id": "club_1",
        "chart_category": "Circular Plots",
        "chart_type": "pie_chart_with_labels",
        "NLQ": "Can you create a simple pie chart showing the gender distribution of students? I'd like to see just male and female counts from the Student table, with the labels \"M\" and \"F\" displayed outside the pie slices instead of using a legend.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/club_1.sqlite')\n\nquery = '''\nSELECT Sex, COUNT(*) AS count\nFROM Student\nGROUP BY Sex;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    alt.Theta(\"count:Q\").stack(True),\n    alt.Color(\"Sex:N\").legend(None)\n)\n\npie = base.mark_arc(outerRadius=120)\ntext = base.mark_text(radius=140, size=20).encode(text=\"Sex:N\")\n\nchart = pie + text\nchart",
        "reference_path": "./vis_bench/img/Circular Plots___pie_chart_with_labels.png"
    },
    {
        "type": "type_B",
        "db_id": "coffee_shop",
        "chart_category": "Circular Plots",
        "chart_type": "pie_chart_with_labels",
        "NLQ": "Can you create a simple pie chart showing just our membership card types? I'd like the labels to be placed directly next to each slice instead of using letters, and I only need to see the breakdown between Black and White membership cards. Make the chart cleaner with fewer colors - just blue for Black cards and orange for White cards.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/coffee_shop.sqlite')\n\nquery = '''\nSELECT Membership_card, COUNT(*) AS count\nFROM member\nGROUP BY Membership_card;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    alt.Theta(\"count:Q\").stack(True),\n    alt.Color(\"Membership_card:N\").legend(None)\n)\n\npie = base.mark_arc(outerRadius=120)\ntext = base.mark_text(radius=140, size=20).encode(text=\"Membership_card:N\")\n\nchart = pie + text\n\nchart",
        "reference_path": "./vis_bench/img/Circular Plots___pie_chart_with_labels.png"
    },
    {
        "type": "type_B",
        "db_id": "college_3",
        "chart_category": "Circular Plots",
        "chart_type": "polar_bar_chart",
        "NLQ": "I like this polar chart showing observations throughout the day, but could you change it to show the number of courses offered by each department? Use data from the Department and Course tables, put the department names around the outside instead of times, and change the title to \"Number of Courses Offered by Each Department\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\nimport math\n\nconn = sqlite3.connect('database\\college_3.sqlite')\nquery = \"\"\"\nSELECT D.DName, COUNT(C.CID) AS CourseCount\nFROM Department AS D\nLEFT JOIN Course AS C ON D.DNO = C.DNO\nGROUP BY D.DName;\n\"\"\"\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nnum_departments = len(df)\ndf['angle'] = (2 * math.pi / num_departments) * df.index\n\npolar_bars = alt.Chart(df).mark_arc(stroke='white', tooltip=True).encode(\n    theta=alt.Theta(\"angle:Q\", scale=alt.Scale(domain=[0, 2 * math.pi])),\n    radius=alt.Radius('CourseCount:Q').scale(type='linear'),\n    color=alt.Color('CourseCount:Q', legend=None),\n    radius2=alt.datum(1)\n)\n\nmax_count = df['CourseCount'].max()\naxis_rings = alt.Chart(pd.DataFrame({\"ring\": range(0, int(max_count) + 2, 2)})).mark_arc(stroke='lightgrey', fill=None).encode(\n    theta=alt.value(2 * math.pi),\n    radius=alt.Radius('ring:Q').stack(False)\n)\naxis_rings_labels = axis_rings.mark_text(color='grey', radiusOffset=5, align='left').encode(\n    text=\"ring:Q\",\n    theta=alt.value(math.pi / 4)\n)\n\naxis_lines_data = []\nfor i in range(num_departments):\n  angle = (2*math.pi/num_departments) * i\n  axis_lines_data.append({'radius':max_count+2, 'theta': angle, 'DName':df['DName'][i]})\naxis_lines_df = pd.DataFrame(axis_lines_data)\n\naxis_lines = alt.Chart(axis_lines_df).mark_arc(stroke='lightgrey', fill=None).encode(\n  theta=alt.Theta('theta:Q').stack(True),\n    radius=alt.Radius('radius:Q'),\n    radius2=alt.datum(1)\n)\n\naxis_lines_labels = axis_lines.mark_text(\n    color='grey',\n    radiusOffset=10,\n).encode(\n    text=\"DName:N\",\n    theta=alt.Theta('theta:Q')\n)\n\nchart = alt.layer(\n    axis_rings,\n    polar_bars,\n    axis_rings_labels,\n    axis_lines,\n    axis_lines_labels\n).properties(\n    title='Number of Courses Offered by Each Department'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Circular Plots___polar_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "college_3",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_custom_order",
        "NLQ": "I like this line chart showing gas mileage, but could you create a similar one showing average grade points for Computer Science courses? I'd like to see the trend across different courses with the course IDs on the x-axis. Please add a clear title, proper axis labels, and include points on the line to mark each course. Also, make sure the y-axis starts at 0 to properly show the grade point scale.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/college_3.sqlite')\n\nquery = '''\nSELECT \n    Course.CID AS CourseID,\n    Course.CName AS CourseName,\n    Enrolled_in.Grade,\n    Gradeconversion.gradepoint AS GradePoint\nFROM \n    Enrolled_in\nJOIN \n    Course ON Enrolled_in.CID = Course.CID\nJOIN \n    Gradeconversion ON Enrolled_in.Grade = Gradeconversion.lettergrade\nWHERE \n    Course.DNO = 600\nORDER BY \n    Course.CID;\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\ngrouped_df = df.groupby(['CourseID', 'CourseName'], as_index=False).agg({'GradePoint': 'mean'})\n\nchart = alt.Chart(grouped_df).mark_line(point=True).encode(\n    x=alt.X(\"CourseID:N\").title(\"Course ID\"),\n    y=alt.Y(\"GradePoint:Q\").title(\"Average Grade Points\"),\n    order=\"CourseID\",\n    tooltip=[\"CourseID\", \"CourseName\", \"GradePoint\"]\n).properties(\n    title=\"Trend of Average Grade Points by Course in Computer Science Department\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_custom_order.png"
    },
    {
        "type": "type_B",
        "db_id": "company_1",
        "chart_category": "Circular Plots",
        "chart_type": "radial_chart",
        "NLQ": "I came across this circular chart that looks really clean and professional. Could you create something similar to show how employees are distributed across different departments, using the employee and department tables? Maybe make it a radial chart like this one? Also, could you add the employee count numbers next to each slice and make the slices different sizes based on the count?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/company_1.sqlite')\n\nquery = '''\nSELECT D.Dname, COUNT(E.Ssn) AS EmployeeCount\nFROM employee AS E\nJOIN department AS D ON E.Dno = D.Dnumber\nGROUP BY D.Dname;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    alt.Theta(\"EmployeeCount:Q\").stack(True),\n    alt.Radius(\"EmployeeCount\").scale(type=\"sqrt\", zero=True, rangeMin=20),\n    color=\"Dname:N\",\n)\n\nc1 = base.mark_arc(innerRadius=20, stroke=\"#fff\")\nc2 = base.mark_text(radiusOffset=10).encode(text=\"EmployeeCount:Q\")\nchart = c1 + c2\n\nchart",
        "reference_path": "./vis_bench/img/Circular Plots___radial_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "company_office",
        "chart_category": "Circular Plots",
        "chart_type": "radial_chart",
        "NLQ": "I came across this circular chart that looks really professional. Can you create something similar to show how the number of companies moving into buildings varies by city and year? It should use the data from the Office_locations and buildings tables. Make the size of each segment reflect the number of companies, add a title \"Companies Moving Into Buildings by City and Year\", and display the actual count values on each segment. Also, use blue for Mexico City and orange for Monterrey.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/company_office.sqlite')\n\nquery = '''\nSELECT \n    b.City AS city,\n    o.move_in_year AS year,\n    COUNT(o.company_id) AS company_count\nFROM \n    Office_locations AS o\nJOIN \n    buildings AS b ON o.building_id = b.id\nGROUP BY \n    b.City, o.move_in_year\nORDER BY \n    b.City, o.move_in_year;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    alt.Theta(\"company_count:Q\").stack(True),\n    alt.Radius(\"company_count\").scale(type=\"sqrt\", zero=True, rangeMin=20),\n    color=\"city:N\",\n    tooltip=[\"city:N\", \"year:Q\", \"company_count:Q\"]\n)\n\nc1 = base.mark_arc(innerRadius=20, stroke=\"#fff\")\nc2 = base.mark_text(radiusOffset=10).encode(text=\"company_count:Q\")\n\nchart = c1 + c2\nchart.properties(title=\"Companies Moving Into Buildings by City and Year\")",
        "reference_path": "./vis_bench/img/Circular Plots___radial_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "county_public_safety",
        "chart_category": "Distributions",
        "chart_type": "2d_histogram_heatmap",
        "NLQ": "I need a heatmap showing the relationship between crime rates and residents per police officer across counties. Can you use a blue-green color scheme and make the bins more granular - about 60 bins for crime rate on the x-axis and 40 bins for residents per officer on the y-axis? I want to see where the data points cluster together.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/county_public_safety.sqlite')\n\nquery = '''\nSELECT Crime_rate, Residents_per_officer\nFROM county_public_safety\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_rect().encode(\n    alt.X('Crime_rate:Q').bin(maxbins=60),\n    alt.Y('Residents_per_officer:Q').bin(maxbins=40),\n    alt.Color('count():Q').scale(scheme='greenblue')\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___2d_histogram_heatmap.png"
    },
    {
        "type": "type_B",
        "db_id": "cre_Doc_Tracking_DB",
        "chart_category": "Distributions",
        "chart_type": "boxplot_with_minmax_whiskers",
        "NLQ": "I like this population distribution chart, but could you create a similar boxplot showing storage duration for different document types from our database? I want to see how long each document type (like Book, Paper, Report) stays in storage, with the y-axis showing days. Please use a blue color scheme instead of the black and orange.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/cre_Doc_Tracking_DB.sqlite')\n\nquery = '''\nSELECT \n    T1.Document_Type_Name,\n    (julianday(T2.Date_Stored) - julianday(T3.Date_in_Location_From)) AS Storage_Duration\nFROM \n    Ref_Document_Types AS T1\nJOIN \n    All_Documents AS T2 ON T1.Document_Type_Code = T2.Document_Type_Code\nJOIN \n    Document_Locations AS T3 ON T2.Document_ID = T3.Document_ID\nWHERE \n    T3.Date_in_Location_From IS NOT NULL AND T2.Date_Stored IS NOT NULL\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_boxplot(extent='min-max').encode(\n    x=alt.X('Document_Type_Name:N', title='Document Type'),\n    y=alt.Y('Storage_Duration:Q', title='Storage Duration (Days)')\n)\n\nchart",
        "reference_path": "./vis_bench/img/Distributions___boxplot_with_minmax_whiskers.png"
    },
    {
        "type": "type_B",
        "db_id": "customers_campaigns_ecommerce",
        "chart_category": "Distributions",
        "chart_type": "distributions_and_medians_of_likert_scale_ratings",
        "NLQ": "Can you create a bubble chart showing the distribution of item order quantities for different product categories? I'd like to see blue circles representing orders, with the size showing the number of orders. Please include the median for each category as a black tick mark, and add \"Low Quantity\" and \"High Quantity\" labels on the sides. Make the product categories appear on the y-axis and the order quantities on the x-axis, with a title that explains what we're looking at.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/customers_campaigns_ecommerce.sqlite')\n\nquery = '''\nSELECT p.product_category, CAST(oi.item_order_quantity AS INTEGER) AS item_order_quantity\nFROM Order_Items AS oi\nJOIN Products AS p ON oi.product_id = p.product_id\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nmedians_df = df.groupby('product_category')['item_order_quantity'].median().reset_index()\nmedians_df.columns = ['product_category', 'median_quantity']\nmedians_df['lo'] = 'Low Quantity'\nmedians_df['hi'] = 'High Quantity'\n\ny_axis = alt.Y(\"product_category\").axis(\n    title=\"Product Category\",\n    offset=50,\n    labelFontWeight=\"bold\",\n    ticks=False,\n    grid=True,\n    domain=False,\n)\n\nbase = alt.Chart(medians_df).encode(y_axis)\n\nbubbles = (\n    alt.Chart(df)\n    .mark_circle(color=\"#6EB4FD\")\n    .encode(\n        alt.X(\"item_order_quantity:Q\").title(\"Item Order Quantity\"),\n        y_axis,\n        alt.Size(\"count()\").legend(offset=75, title=\"Number of Orders\"),\n        tooltip=[alt.Tooltip(\"count()\").title(\"Number of Orders\")],\n    )\n)\n\nticks = base.mark_tick(color=\"black\").encode(\n    alt.X(\"median_quantity:Q\").axis(grid=False)\n)\n\ntexts_lo = base.mark_text(align=\"right\", x=-5).encode(text=\"lo\")\ntexts_hi = base.mark_text(align=\"left\", x=255).encode(text=\"hi\")\n\nchart = (bubbles + ticks + texts_lo + texts_hi).properties(\n    title=\"Distribution of Item Order Quantities by Product Category\", width=300, height=200\n).configure_view(stroke=None)\n\nchart",
        "reference_path": "./vis_bench/img/Distributions___distributions_and_medians_of_likert_scale_ratings.png"
    },
    {
        "type": "type_B",
        "db_id": "customers_card_transactions",
        "chart_category": "Distributions",
        "chart_type": "distributions_and_medians_of_likert_scale_ratings",
        "NLQ": "I came across this visualization image that shows ratings with medians and distributions, and I really like the style. Can you create something similar to compare customer satisfaction ratings for \"Payment\" and \"Refund\" transactions from the Financial_Transactions table, using transaction amounts to determine the ratings? Make the bubbles blue, add \"Very Dissatisfied\" on the left and \"Very Satisfied\" on the right of each row, and title it \"Customer Ratings for Transaction Types\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/customers_card_transactions.sqlite')\n\nquery = '''\nSELECT \n    T1.transaction_type AS transaction_type,\n    CASE \n        WHEN T1.transaction_amount > 1000 THEN 5\n        WHEN T1.transaction_amount BETWEEN 500 AND 1000 THEN 4\n        WHEN T1.transaction_amount BETWEEN 200 AND 499 THEN 3\n        WHEN T1.transaction_amount BETWEEN 100 AND 199 THEN 2\n        ELSE 1\n    END AS rating\nFROM Financial_Transactions AS T1\nWHERE T1.transaction_type IN ('Payment', 'Refund')\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nmedians = df.groupby('transaction_type')['rating'].median().reset_index()\nmedians.columns = ['name', 'median']\nmedians['lo'] = 'Very Dissatisfied'\nmedians['hi'] = 'Very Satisfied'\n\nvalues = df.rename(columns={'transaction_type': 'name', 'rating': 'value'})\n\ny_axis = alt.Y(\"name\").axis(\n    title=None,\n    offset=50,\n    labelFontWeight=\"bold\",\n    ticks=False,\n    grid=True,\n    domain=False,\n)\n\nbase = alt.Chart(medians).encode(y_axis)\n\nbubbles = (\n    alt.Chart(values)\n    .mark_circle(color=\"#6EB4FD\")\n    .encode(\n        alt.X(\"value:Q\").title(None),\n        y_axis,\n        alt.Size(\"count()\").legend(offset=75, title=\"Number of ratings\"),\n        tooltip=[alt.Tooltip(\"count()\").title(\"Number of ratings\")],\n    )\n)\n\nticks = base.mark_tick(color=\"black\").encode(\n    alt.X(\"median:Q\")\n    .axis(grid=False, values=[1, 2, 3, 4, 5], format=\".0f\")\n    .scale(domain=[0, 6]),\n)\n\ntexts_lo = base.mark_text(align=\"right\", x=-5).encode(text=\"lo\")\ntexts_hi = base.mark_text(align=\"left\", x=255).encode(text=\"hi\")\n\n(bubbles + ticks + texts_lo + texts_hi).properties(\n    title=\"Customer Ratings for Transaction Types\", width=250, height=175\n).configure_view(stroke=None)",
        "reference_path": "./vis_bench/img/Distributions___distributions_and_medians_of_likert_scale_ratings.png"
    },
    {
        "type": "type_B",
        "db_id": "hr_1",
        "chart_category": "Distributions",
        "chart_type": "repeated_density_estimates",
        "NLQ": "I like this density plot, but could you create a similar one showing salary distributions for each job title in our HR database? I'd like to see how salaries are spread across different positions, with each job title in its own row. Please use a blue color scheme and extend the x-axis to about $25,000 to capture all salary ranges.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/hr_1.sqlite')\n\nquery = '''\nSELECT e.SALARY, j.JOB_TITLE\nFROM employees AS e\nJOIN jobs AS j ON e.JOB_ID = j.JOB_ID\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).transform_fold(\n    ['SALARY'],\n    as_=['Measurement_type', 'value']\n).transform_density(\n    density='value',\n    bandwidth=500,\n    groupby=['JOB_TITLE'],\n    extent=[0, 25000]\n).mark_area().encode(\n    alt.X(\"value:Q\", title=\"Salary\"),\n    alt.Y(\"density:Q\", title=\"Density\"),\n    alt.Row(\"JOB_TITLE:N\", title=\"Job Title\")\n).properties(\n    width=300, height=50\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___repeated_density_estimates.png"
    },
    {
        "type": "type_B",
        "db_id": "hr_1",
        "chart_category": "Scatter Plots",
        "chart_type": "brushing_scatter_plot_to_show_data_on_a_table",
        "NLQ": "Can you create an interactive scatter plot showing employee salary vs. commission percentage? I'd like to be able to select points on the chart and see the corresponding employee details like first name, last name, job title, and department in a table next to the chart. Use blue points for selected data and gray for unselected points.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/hr_1.sqlite')\nquery = '''\nSELECT \n    e.FIRST_NAME,\n    e.LAST_NAME,\n    e.SALARY,\n    e.COMMISSION_PCT,\n    j.JOB_TITLE,\n    d.DEPARTMENT_NAME\nFROM \n    employees AS e\nJOIN \n    jobs AS j ON e.JOB_ID = j.JOB_ID\nJOIN \n    departments AS d ON e.DEPARTMENT_ID = d.DEPARTMENT_ID\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbrush = alt.selection_interval()\npoints = alt.Chart(df).mark_point().encode(\n    x=alt.X('SALARY:Q', title='Salary'),\n    y=alt.Y('COMMISSION_PCT:Q', title='Commission Percentage'),\n    color=alt.condition(brush, alt.value(\"steelblue\"), alt.value(\"grey\"))\n).add_params(brush)\n\nranked_text = alt.Chart(df).mark_text(align='right').encode(\n    y=alt.Y('row_number:O').axis(None)\n).transform_filter(\n    brush\n).transform_window(\n    row_number='row_number()'\n).transform_filter(\n    alt.datum.row_number < 15\n)\n\nfirst_name = ranked_text.encode(text='FIRST_NAME:N').properties(\n    title=alt.Title(text='First Name', align='right')\n)\nlast_name = ranked_text.encode(text='LAST_NAME:N').properties(\n    title=alt.Title(text='Last Name', align='right')\n)\njob_title = ranked_text.encode(text='JOB_TITLE:N').properties(\n    title=alt.Title(text='Job Title', align='right')\n)\ndepartment_name = ranked_text.encode(text='DEPARTMENT_NAME:N').properties(\n    title=alt.Title(text='Department', align='right')\n)\ntext = alt.hconcat(first_name, last_name, job_title, department_name)\n\nchart = alt.hconcat(\n    points,\n    text\n).resolve_legend(\n    color=\"independent\"\n).configure_view(\n    stroke=None\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Scatter Plots___brushing_scatter_plot_to_show_data_on_a_table.png"
    },
    {
        "type": "type_B",
        "db_id": "products_for_hire",
        "chart_category": "Simple Charts",
        "chart_type": "simple_heatmap",
        "NLQ": "I came across this simple heatmap image that I really like the look of. Can you create something similar to show how the total amount payable for bookings changes over time, broken down by month and year using data from the Bookings table? Make sure to include a clear title and label the axes as \"Month\" and \"Year\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/products_for_hire.sqlite')\n\nquery = '''\nSELECT \n    strftime('%Y', booking_start_date) AS year,\n    strftime('%m', booking_start_date) AS month,\n    SUM(amount_payable) AS total_amount_payable\nFROM Bookings\nGROUP BY year, month\nORDER BY year, month\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nheatmap = alt.Chart(df).mark_rect().encode(\n    x=alt.X('month:O', title='Month'),\n    y=alt.Y('year:O', title='Year'),\n    color=alt.Color('total_amount_payable:Q', title='Total Amount Payable')\n).properties(\n    title='Total Amount Payable by Month and Year'\n)\n\nheatmap",
        "reference_path": "./vis_bench/img/Simple Charts___simple_heatmap.png"
    },
    {
        "type": "type_B",
        "db_id": "roller_coaster",
        "chart_category": "Simple Charts",
        "chart_type": "simple_scatter_plot_with_tooltips",
        "NLQ": "I like this scatter plot showing roller coaster data, but could you create a similar one that shows height on the x-axis and speed on the y-axis instead? I'd like to see the points colored by country, and it would be helpful if you could make the circles a bit larger and add tooltips that show each coaster's name, park, height, and speed when hovering over them. Also, could you make the chart interactive?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/roller_coaster.sqlite')\n\nquery = '''\nSELECT \n    r.Name AS Coaster_Name,\n    r.Park,\n    r.Height,\n    CAST(r.Speed AS REAL) AS Speed,\n    c.Name AS Country\nFROM \n    roller_coaster AS r\nJOIN \n    country AS c\nON \n    r.Country_ID = c.Country_ID\nWHERE \n    r.Height IS NOT NULL AND r.Speed IS NOT NULL\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_circle(size=60).encode(\n    x='Height:Q',\n    y='Speed:Q',\n    color='Country:N',\n    tooltip=['Coaster_Name:N', 'Park:N', 'Height:Q', 'Speed:Q']\n).interactive()\n\nchart.show()",
        "reference_path": "./vis_bench/img/Simple Charts___simple_scatter_plot_with_tooltips.png"
    },
    {
        "type": "type_B",
        "db_id": "local_govt_and_lot",
        "chart_category": "Scatter Plots",
        "chart_type": "faceted_scatter_plot",
        "NLQ": "I need a simple scatter plot showing the number of satisfied residents for each service type (Check, Cleaning, Moving Out), separated by property types (flat, house). Can you make it a faceted view with property types as rows and put the resident count on the x-axis? Keep it clean with just circle markers.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/local_govt_and_lot.sqlite')\n\nquery = '''\nSELECT \n    T1.service_type_code AS Service_Type,\n    COUNT(T2.resident_id) AS Resident_Count,\n    T3.property_type_code AS Property_Type\nFROM \n    Services AS T1\nJOIN \n    Residents_Services AS T2 ON T1.service_id = T2.service_id\nJOIN \n    Properties AS T3 ON T2.property_id = T3.property_id\nWHERE \n    T1.service_details = 'Satisfied'\nGROUP BY \n    T1.service_type_code, T3.property_type_code\nORDER BY \n    T1.service_type_code, T3.property_type_code;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df, width=100, height=100).mark_point().encode(\n    x=\"Resident_Count:Q\",\n    y=\"Service_Type:N\",\n    row=\"Property_Type:N\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Scatter Plots___faceted_scatter_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "machine_repair",
        "chart_category": "Scatter Plots",
        "chart_type": "multifeature_scatter_plot",
        "NLQ": "I like this scatter plot showing iris flower data, but I need a similar chart for machine data instead. Can you create a scatter plot showing machine making year on the x-axis and value points on the y-axis? Use the machine class for the color and make the dot size represent the quality rank. Only include machines made after 1990.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/machine_repair.sqlite')\n\nquery = '''\nSELECT Making_Year, value_points, Class, quality_rank\nFROM machine\nWHERE Making_Year > 1990\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_circle().encode(\n    alt.X('Making_Year').scale(zero=False),\n    alt.Y('value_points').scale(zero=False, padding=1),\n    color='Class',\n    size='quality_rank'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Scatter Plots___multifeature_scatter_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "activity_1",
        "chart_category": "Bar Charts",
        "chart_type": "stacked_bar_chart",
        "NLQ": "Can you create a stacked bar chart showing the number of students and faculty participating in each campus activity? I'd like to see the activities listed on the x-axis, with the count on the y-axis, and different colors for students versus faculty members. Please use the Activity, Participates_in, and Faculty_Participates_in tables from the database.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/activity_1.sqlite')\n\nquery = '''\nSELECT \n    A.activity_name,\n    COUNT(DISTINCT P.stuid) AS student_count,\n    COUNT(DISTINCT F.FacID) AS faculty_count\nFROM \n    Activity AS A\nLEFT JOIN \n    Participates_in AS P ON A.actid = P.actid\nLEFT JOIN \n    Faculty_Participates_in AS F ON A.actid = F.actid\nGROUP BY \n    A.activity_name\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndf_melted = df.melt(id_vars=['activity_name'], \n                    value_vars=['student_count', 'faculty_count'], \n                    var_name='participant_type', \n                    value_name='count')\n\nchart = alt.Chart(df_melted).mark_bar().encode(\n    x='activity_name:N',\n    y='sum(count):Q',\n    color='participant_type:N'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___stacked_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "allergy_1",
        "chart_category": "Advanced Calculations",
        "chart_type": "calculate_residuals",
        "NLQ": "I came across this scatter plot image that uses color to highlight deviations, and it looks perfect for my needs. Can you create something similar showing students' ages from the Student table, with their deviation from the average age on the y-axis and ages on the x-axis? I'd love it if the points were colored by how much they deviate, just like in the image. Could you also add a title \"Student Age Deviation from Average\" and use the viridis color scheme instead of the blue-brown one in the reference image?",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/allergy_1.sqlite')\n\nquery = '''\nSELECT Age\nFROM Student;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_point().transform_joinaggregate(\n    Average_Age='mean(Age)'\n).transform_calculate(\n    Age_Delta='datum.Age - datum.Average_Age'\n).encode(\n    x=alt.X('Age:Q').title('Student Age'),\n    y=alt.Y('Age_Delta:Q').title('Age Delta (Age - Average Age)'),\n    color=alt.Color('Age_Delta:Q').title('Age Delta').scale(scheme='viridis')\n).properties(\n    title='Student Age Deviation from Average'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Advanced Calculations___calculate_residuals.png"
    },
    {
        "type": "type_B",
        "db_id": "allergy_1",
        "chart_category": "Bar Charts",
        "chart_type": "stacked_bar_chart_with_sorted_segments",
        "NLQ": "I like this chart showing allergy types, but can you flip it so the majors are shown on the y-axis instead of the x-axis? Also, please sort the majors alphabetically rather than by their numeric codes.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/allergy_1.sqlite')\n\nquery = '''\nSELECT \n    S.Major AS Major,\n    AT.AllergyType AS AllergyType,\n    COUNT(*) AS StudentCount\nFROM \n    Student AS S\nJOIN \n    Has_Allergy AS HA ON S.StuID = HA.StuID\nJOIN \n    Allergy_Type AS AT ON HA.Allergy = AT.Allergy\nGROUP BY \n    S.Major, AT.AllergyType\nORDER BY \n    S.Major, AT.AllergyType\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='sum(StudentCount):Q',\n    y='Major:N',\n    color='AllergyType:N',\n    order=alt.Order(\n        'AllergyType',\n        sort='ascending'\n    )\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___stacked_bar_chart_with_sorted_segments.png"
    },
    {
        "type": "type_B",
        "db_id": "baseball_1",
        "chart_category": "Bar Charts",
        "chart_type": "stacked_bar_chart_with_text_overlay",
        "NLQ": "Could you flip this chart to show years on the y-axis instead of the x-axis? I'd like to see the data as horizontal bars with years going from top to bottom. Also, please add white text labels directly on the bars showing the exact number of home runs for each league, and change the title to \"Total Home Runs by League Over the Years\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/baseball_1.sqlite')\n\nquery = '''\nSELECT \n    year,\n    league_id,\n    SUM(hr) AS total_hr\nFROM \n    batting\nWHERE \n    league_id IN ('NL', 'AL') AND hr IS NOT NULL\nGROUP BY \n    year, league_id\nORDER BY \n    year ASC;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbars = alt.Chart(df).mark_bar().encode(\n    x=alt.X('sum(total_hr):Q').stack('zero').title('Total Home Runs'),\n    y=alt.Y('year:N').title('Year'),\n    color=alt.Color('league_id:N').title('League')\n)\n\ntext = alt.Chart(df).mark_text(dx=-15, dy=3, color='white').encode(\n    x=alt.X('sum(total_hr):Q').stack('zero'),\n    y=alt.Y('year:N'),\n    detail='league_id:N',\n    text=alt.Text('sum(total_hr):Q', format='.0f')\n)\n\nchart = bars + text\nchart.properties(title=\"Total Home Runs by League Over the Years\")",
        "reference_path": "./vis_bench/img/Bar Charts___stacked_bar_chart_with_text_overlay.png"
    },
    {
        "type": "type_B",
        "db_id": "chinook_1",
        "chart_category": "Circular Plots",
        "chart_type": "pie_chart",
        "NLQ": "I like this pie chart showing categories, but could you create one using actual music data from the database? I'd like to see the distribution of tracks by genre names instead of just numbered categories, with each genre having its own color in the legend.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/chinook_1.sqlite')\n\nquery = '''\nSELECT \n    g.Name AS GenreName,\n    COUNT(t.TrackId) AS TrackCount\nFROM \n    Track AS t\nJOIN \n    Genre AS g ON t.GenreId = g.GenreId\nGROUP BY \n    g.Name\nORDER BY \n    TrackCount DESC;\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_arc().encode(\n    theta=\"TrackCount\",\n    color=\"GenreName\"\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Circular Plots___pie_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "chinook_1",
        "chart_category": "Advanced Calculations",
        "chart_type": "gantt_chart",
        "NLQ": "Can you create a horizontal bar chart showing how long each employee has been with our company? I'd like to see all employees' full names listed on the left side, with bars showing their tenure from hire date until now. Please title it \"Employee Tenure at the Company\" and make it simple with just the years on the x-axis.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\nfrom datetime import datetime\n\nconn = sqlite3.connect('database/chinook_1.sqlite')\n\nquery = '''\nSELECT \n    EmployeeId,\n    FirstName || ' ' || LastName AS FullName,\n    HireDate\nFROM \n    Employee\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\ntoday = datetime.today()\ndf['start'] = df['HireDate'].apply(lambda x: datetime.strptime(x, '%Y-%m-%d %H:%M:%S').year)\ndf['end'] = today.year\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='start:O',\n    x2='end:O',\n    y=alt.Y('FullName:N', title=\"Employee Name\")\n).properties(\n    title=\"Employee Tenure at the Company\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Advanced Calculations___gantt_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "browser_web",
        "chart_category": "Line Charts",
        "chart_type": "filled_step_chart",
        "NLQ": "Can you convert this stock price chart into a step chart showing the cumulative browser market share over time? I'd like to see how the total market share of browsers has grown over the years since they became compatible with web client accelerators. Use years on the x-axis instead of dates, and change the title to \"Cumulative Browser Market Share Over Time\". Keep the light blue color for the area.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/browser_web.sqlite')\n\nquery = '''\nSELECT \n    T3.compatible_since_year AS year,\n    SUM(T2.market_share) AS cumulative_market_share\nFROM \n    accelerator_compatible_browser AS T3\nJOIN \n    browser AS T2 ON T3.browser_id = T2.id\nGROUP BY \n    T3.compatible_since_year\nORDER BY \n    T3.compatible_since_year\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_area(\n    color=\"lightblue\",\n    interpolate='step-after',\n    line=True\n).encode(\n    x=alt.X('year:O', title='Year'),\n    y=alt.Y('cumulative_market_share:Q', title='Cumulative Market Share')\n).properties(\n    title=\"Cumulative Browser Market Share Over Time\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Line Charts___filled_step_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "candidate_poll",
        "chart_category": "Advanced Calculations",
        "chart_type": "gantt_chart",
        "NLQ": "Can you create a simple horizontal bar chart showing the poll sources from the candidate table? I'd like to see each poll source (like FOX News, Newsweek) listed on the y-axis with bars extending from their candidate ID to the next ID. Please remove the title and add light grid lines in the background.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/candidate_poll.sqlite')\n\nquery = '''\nSELECT Poll_Source, Candidate_ID\nFROM candidate\nORDER BY Candidate_ID\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndf['start'] = df['Candidate_ID']\ndf['end'] = df['Candidate_ID'] + 1\ndf['task'] = df['Poll_Source']\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='start',\n    x2='end',\n    y='task'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Advanced Calculations___gantt_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "company_employee",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_custom_order",
        "NLQ": "I like this line chart showing gas prices over miles driven, but could you create a similar chart that shows the relationship between total work experience and average age of employees from different colleges? Please put total work experience in years on the x-axis and average age on the y-axis, add a descriptive title, and make sure both axes don't start at zero to better see the differences. I'd like to keep the points connected with lines like in this example.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/company_employee.sqlite')\n\nquery = '''\nSELECT \n    p.Graduation_College AS College,\n    AVG(p.Age) AS Avg_Age,\n    SUM(e.Year_working) AS Total_Experience\nFROM \n    people AS p\nJOIN \n    employment AS e ON p.People_ID = e.People_ID\nGROUP BY \n    p.Graduation_College\nORDER BY \n    AVG(p.Age)\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_line(point=True).encode(\n    x=alt.X(\"Total_Experience:Q\").scale(zero=False).title(\"Total Work Experience (Years)\"),\n    y=alt.Y(\"Avg_Age:Q\").scale(zero=False).title(\"Average Age of Employees\"),\n    order=\"Avg_Age\",\n    tooltip=[\"College\", \"Total_Experience\", \"Avg_Age\"]\n).properties(\n    title=\"Work Experience vs. Average Age by Graduation College\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_custom_order.png"
    },
    {
        "type": "type_B",
        "db_id": "company_employee",
        "chart_category": "Advanced Calculations",
        "chart_type": "layered_chart_with_dual-axis",
        "NLQ": "I like this chart showing weather data, but I need something for our company data instead. Can you create a dual-axis chart showing the total number of employees per industry as green bars and their average years of experience as a blue line? Make the bars slightly transparent and use a smooth line. Please sort the industries by the number of employees in descending order.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/company_employee.sqlite')\nquery = '''\nSELECT \n    c.Industry AS Industry,\n    COUNT(e.People_ID) AS Total_Employees,\n    AVG(e.Year_working) AS Avg_Years_Experience\nFROM \n    company AS c\nJOIN \n    employment AS e ON c.Company_ID = e.Company_ID\nGROUP BY \n    c.Industry\nORDER BY \n    Total_Employees DESC;\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    alt.X('Industry:N').title('Industry')\n)\n\nbar = base.mark_bar(color='#57A44C', opacity=0.7).encode(\n    alt.Y('Total_Employees:Q').axis(title='Total Employees', titleColor='#57A44C')\n)\n\nline = base.mark_line(stroke='#5276A7', interpolate='monotone').encode(\n    alt.Y('Avg_Years_Experience:Q').axis(title='Average Years of Experience', titleColor='#5276A7')\n)\n\nchart = alt.layer(bar, line).resolve_scale(\n    y='independent'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Advanced Calculations___layered_chart_with_dual-axis.png"
    },
    {
        "type": "type_B",
        "db_id": "concert_singer",
        "chart_category": "Distributions",
        "chart_type": "2d_histogram_heatmap",
        "NLQ": "I like this heatmap showing movie ratings, but could you create a similar one for concert data instead? I'd like to see how concerts are distributed by year and stadium capacity, using a greenblue color scheme to show the concert count. Please title it \"Distribution of Concerts by Year and Stadium Capacity\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/concert_singer.sqlite')\n\nquery = '''\nSELECT \n    c.Year AS Year,\n    s.Capacity AS Capacity\nFROM \n    concert AS c\nJOIN \n    stadium AS s\nON \n    c.Stadium_ID = s.Stadium_ID\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_rect().encode(\n    alt.X('Year:O').title('Year'),\n    alt.Y('Capacity:Q').bin(maxbins=30).title('Stadium Capacity'),\n    alt.Color('count():Q').scale(scheme='greenblue').title('Concert Count')\n).properties(\n    title='Distribution of Concerts by Year and Stadium Capacity'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___2d_histogram_heatmap.png"
    },
    {
        "type": "type_B",
        "db_id": "culture_company",
        "chart_category": "Advanced Calculations",
        "chart_type": "ranged_dot_plot",
        "NLQ": "I like this ranged dot plot style. Could you create a similar chart comparing movie budgets and worldwide earnings? Use red lines to connect the values for each movie, with darker red dots for the worldwide gross and lighter red dots for the budget. Show the movie titles on the left side and add a legend to explain what each color represents.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/culture_company.sqlite')\nquery = '''\nSELECT Title, Budget_million, Gross_worldwide\nFROM movie\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndf_melted = pd.melt(df, id_vars=['Title'], value_vars=['Budget_million', 'Gross_worldwide'], var_name='Measure', value_name='Value')\n\nchart = alt.Chart(df_melted).mark_line(color=\"#db646f\").encode(\n    y=alt.Y('Title:N'),\n    x=alt.X('Value:Q'),\n    detail='Title:N'\n)\n\npoints = alt.Chart(df_melted).mark_point(\n    size=100,\n    opacity=1,\n    filled=True,\n).encode(\n    y=alt.Y('Title:N'),\n    x=alt.X('Value:Q'),\n    color=alt.Color('Measure:N').scale(domain=['Budget_million', 'Gross_worldwide'], range=[\"#e6959c\", \"#911a24\"])\n)\n\nfinal_chart = (chart + points)\nfinal_chart",
        "reference_path": "./vis_bench/img/Advanced Calculations___ranged_dot_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "customers_and_addresses",
        "chart_category": "Advanced Calculations",
        "chart_type": "sorted_error_bars_showing_confidence_interval",
        "NLQ": "I came across this visualization image that uses sorted error bars to show confidence intervals, and I really like the style. Can you create something similar to display the average order quantity for each product, ranked from highest to lowest, using data from the Order_Items and Products tables? Could you add a grid in the background, use black dots for the data points, and label the x-axis as \"Average Order Quantity\"?",
        "code": "import altair as alt\nimport sqlite3\nimport pandas as pd\n\nconn = sqlite3.connect('database/customers_and_addresses.sqlite')\n\nquery = \"\"\"\nSELECT\n    P.product_details,\n    OI.order_quantity\nFROM Order_Items AS OI\nJOIN Products AS P\n    ON OI.product_id = P.product_id;\n\"\"\"\n\ndf = pd.read_sql_query(query, conn)\ndf['order_quantity'] = pd.to_numeric(df['order_quantity'])\n\nconn.close()\n\npoints = alt.Chart(df).mark_point(\n    filled=True,\n    color='black'\n).encode(\n    x=alt.X('mean(order_quantity)').title('Average Order Quantity'),\n    y=alt.Y('product_details').sort(\n        field='order_quantity',\n        op='mean',\n        order='descending'\n    )\n).properties(\n    width=400,\n    height=250\n)\n\nerror_bars = points.mark_rule().encode(\n    x='ci0(order_quantity)',\n    x2='ci1(order_quantity)',\n)\n\npoints + error_bars",
        "reference_path": "./vis_bench/img/Advanced Calculations___sorted_error_bars_showing_confidence_interval.png"
    },
    {
        "type": "type_B",
        "db_id": "customers_and_invoices",
        "chart_category": "Advanced Calculations",
        "chart_type": "sorted_error_bars_showing_confidence_interval",
        "NLQ": "Can you create a chart similar to this one but showing the average derived total cost for each product from our invoice line items database? I'd like to see the products sorted from highest to lowest cost, with error bars showing the confidence intervals. Please use black dots for the data points and make the x-axis title \"Average Derived Total Cost\" instead of \"Barley Yield\".",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/customers_and_invoices.sqlite')\n\nquery = '''\nSELECT product_title, derived_total_cost\nFROM Invoice_Line_Items\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\npoints = alt.Chart(df).mark_point(\n    filled=True,\n    color='black'\n).encode(\n    x=alt.X('mean(derived_total_cost)').title('Average Derived Total Cost'),\n    y=alt.Y('product_title').sort(\n        field='derived_total_cost',\n        op='mean',\n        order='descending'\n    )\n).properties(\n    width=400,\n    height=250\n)\n\nerror_bars = points.mark_rule().encode(\n    x='ci0(derived_total_cost)',\n    x2='ci1(derived_total_cost)',\n)\n\npoints + error_bars",
        "reference_path": "./vis_bench/img/Advanced Calculations___sorted_error_bars_showing_confidence_interval.png"
    },
    {
        "type": "type_B",
        "db_id": "customer_deliveries",
        "chart_category": "Advanced Calculations",
        "chart_type": "top_k_items",
        "NLQ": "Can you create a bar chart showing the 5 most expensive products from the Products table? I'd like the bars to be sorted from highest to lowest price, with a blue color gradient where darker blue represents higher prices. Please make sure to show the product names on the x-axis and their prices on the y-axis.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/customer_deliveries.sqlite')\n\nquery = '''\nSELECT product_name, product_price\nFROM Products\nORDER BY product_price DESC\nLIMIT 5\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    alt.X('product_name:N').sort('-y'),\n    alt.Y('product_price:Q'),\n    alt.Color('product_price:Q')\n).transform_window(\n    rank='rank(product_price)',\n    sort=[alt.SortField('product_price', order='descending')]\n).transform_filter(\n    (alt.datum.rank < 6)\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Advanced Calculations___top_k_items.png"
    },
    {
        "type": "type_B",
        "db_id": "debate",
        "chart_category": "Advanced Calculations",
        "chart_type": "top_k_items",
        "NLQ": "I like this chart showing movie ratings, but could you create a similar bar chart showing the top 5 debate venues by audience size instead? Please sort the venues from highest to lowest attendance, use a blue color scheme, and title it \"Top 5 Debates by Audience Size\". Make sure to label the y-axis as \"Number of Audience\" and include a color legend showing audience size.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/debate.sqlite')\n\nquery = '''\nSELECT Debate_ID, Venue, Date, Num_of_Audience\nFROM debate\nORDER BY Num_of_Audience DESC\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    alt.X('Venue:N').sort('-y'),\n    alt.Y('Num_of_Audience:Q', title='Number of Audience'),\n    alt.Color('Num_of_Audience:Q', title='Audience Size')\n).transform_window(\n    rank='rank(Num_of_Audience)',\n    sort=[alt.SortField('Num_of_Audience', order='descending')]\n).transform_filter(\n    (alt.datum.rank < 6)\n).properties(\n    title='Top 5 Debates by Audience Size'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Advanced Calculations___top_k_items.png"
    },
    {
        "type": "type_B",
        "db_id": "device",
        "chart_category": "Distributions",
        "chart_type": "faceted_histogram",
        "NLQ": "Can you create a simple histogram showing the distribution of device quantities for each software platform? I'd like to see each platform as a separate row with its own histogram, and I don't need any title or fancy styling - just a clean layout showing how quantities are distributed.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/device.sqlite')\n\nquery = '''\nSELECT \n    d.Software_Platform, \n    s.Quantity\nFROM \n    stock AS s\nJOIN \n    device AS d ON s.Device_ID = d.Device_ID\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    alt.X(\"Quantity:Q\").bin(),\n    y=\"count()\",\n    row=\"Software_Platform:N\"\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___faceted_histogram.png"
    },
    {
        "type": "type_B",
        "db_id": "dog_kennels",
        "chart_category": "Distributions",
        "chart_type": "faceted_histogram",
        "NLQ": "I like this chart showing horsepower distribution by country of origin. Could you create a similar layout but instead show the distribution of treatment costs for different dog treatment types? I'd like to see the cost ranges on the x-axis and the count of treatments on the y-axis, with each treatment type (like Physical examination, Vaccination, Tails for a Walk) in its own row.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/dog_kennels.sqlite')\nquery = '''\nSELECT \n    T1.treatment_type_description AS treatment_type,\n    T2.cost_of_treatment AS cost\nFROM \n    Treatment_Types AS T1\nJOIN \n    Treatments AS T2\nON \n    T1.treatment_type_code = T2.treatment_type_code\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    alt.X(\"cost:Q\").bin(),\n    y=\"count()\",\n    row=\"treatment_type:N\"\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___faceted_histogram.png"
    },
    {
        "type": "type_B",
        "db_id": "driving_school",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_sequence_generator",
        "NLQ": "I need to create a business chart showing cumulative payments over time from our driving school database. Can you make a line chart with payment dates on the x-axis and the running total of payment amounts on the y-axis? I'd like to see different colored lines for each payment method (like Credit Card and Direct Debit), with a grid in the background and the legend at the top right. Please label the axes as \"Payment Date\" and \"Cumulative Payment Amount\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/driving_school.sqlite')\n\nquery = '''\nSELECT \n    DATE(datetime_payment) AS payment_date,\n    payment_method_code,\n    SUM(amount_payment) AS total_payment\nFROM \n    Customer_Payments\nGROUP BY \n    payment_date, payment_method_code\nORDER BY \n    payment_date\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nline_chart = alt.Chart(df).mark_line().encode(\n    x=alt.X('payment_date:T', title='Payment Date'),\n    y=alt.Y('sum(total_payment):Q', title='Cumulative Payment Amount'),\n    color=alt.Color('payment_method_code:N', title='Payment Method')\n).transform_window(\n    cumulative_sum='sum(total_payment)',\n    frame=[None, 0],\n    groupby=['payment_method_code']\n).encode(\n    y=alt.Y('cumulative_sum:Q', title='Cumulative Payment Amount')\n)\n\nline_chart",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_sequence_generator.png"
    },
    {
        "type": "type_B",
        "db_id": "election_representative",
        "chart_category": "Distributions",
        "chart_type": "histogram_with_a_global_mean_overlay",
        "NLQ": "I came across this histogram image that overlays the average value, and I really like its clean style. Can you create something similar to show how vote percentages are distributed across elections from the `election` table, with a red line marking the average vote percentage?",
        "code": "import altair as alt\nimport sqlite3\nimport pandas as pd\n\nconn = sqlite3.connect('database/election_representative.sqlite')\nquery = '''\nSELECT Vote_Percent\nFROM election;\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df)\nbar = base.mark_bar().encode(\n    alt.X('Vote_Percent:Q', bin=alt.Bin(maxbins=30), title='Vote Percentage'),\n    alt.Y('count()', title='Frequency')\n)\nrule = base.mark_rule(color='red').encode(\n    alt.X('mean(Vote_Percent):Q', title='Average Vote Percentage'),\n    size=alt.value(5)\n)\nchart = bar + rule\nchart",
        "reference_path": "./vis_bench/img/Distributions___histogram_with_a_global_mean_overlay.png"
    },
    {
        "type": "type_B",
        "db_id": "election_representative",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_stroked_point_markers",
        "NLQ": "Can you create a line chart with points showing votes over time for different political parties using our election database? I'd like to see Democratic and Republican vote trends with a grid background, clear axis labels, and a title that says \"Votes Trend Over Time by Party.\"",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/election_representative.sqlite')\n\nquery = '''\nSELECT E.Date, E.Votes, R.Party\nFROM election AS E\nJOIN representative AS R ON E.Representative_ID = R.Representative_ID\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndef convert_to_datetime(date_str):\n    try:\n        return pd.to_datetime(date_str, format='%B %Y')\n    except ValueError:\n        try:\n            return pd.to_datetime(date_str, format='%Y')\n        except ValueError:\n            try:\n                return pd.to_datetime(date_str)\n            except:\n                return pd.to_datetime(date_str + ' January 1', format='%Y %B %d')\ndf['Date'] = df['Date'].apply(convert_to_datetime)\n\nalt.Chart(df).mark_line(point=True).encode(\n    x='Date:T',\n    y='Votes:Q',\n    color='Party:N'\n).properties(\n    title='Votes Trend Over Time by Party'\n)",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_stroked_point_markers.png"
    },
    {
        "type": "type_B",
        "db_id": "employee_hire_evaluation",
        "chart_category": "Distributions",
        "chart_type": "histogram_with_a_global_mean_overlay",
        "NLQ": "I like this histogram showing IMDB ratings, but I need one for employee ages from our database instead. Can you create a similar histogram showing the distribution of employee ages from the employee table, with a red vertical line showing the mean age? Also, please add tooltips so I can see the count and age when I hover over the bars.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/employee_hire_evaluation.sqlite')\nquery = \"SELECT Age FROM employee;\"\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df)\n\nbar = base.mark_bar().encode(\n    alt.X('Age:Q', bin=alt.Bin(maxbins=30), title='Employee Age'),\n    y='count()',\n    tooltip=['count()', 'Age']\n)\n\nrule = base.mark_rule(color='red').encode(\n    x='mean(Age):Q',\n    size=alt.value(5)\n)\n\nchart = bar + rule\n\nchart",
        "reference_path": "./vis_bench/img/Distributions___histogram_with_a_global_mean_overlay.png"
    },
    {
        "type": "type_B",
        "db_id": "entrepreneur",
        "chart_category": "Distributions",
        "chart_type": "histogram_with_gradient_color",
        "NLQ": "I came across this histogram with gradient colors that looks really cool. Can you create something similar to show the distribution of people's weights from the `people` table, with the bars shaded based on the weight values? Use a pink to yellow to green color scheme and make the x-axis show the actual weight values instead of ratings.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/entrepreneur.sqlite')\nquery = '''\nSELECT Weight\nFROM people\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nalt.Chart(df).mark_bar().encode(\n    alt.X(\"Weight:Q\").bin(maxbins=20),\n    alt.Y('count()'),\n    alt.Color(\"Weight:Q\").bin(maxbins=20).scale(scheme='pinkyellowgreen')\n)",
        "reference_path": "./vis_bench/img/Distributions___histogram_with_gradient_color.png"
    },
    {
        "type": "type_B",
        "db_id": "epinions_1",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_varying_size",
        "NLQ": "I came across this line chart image where the lines change thickness to show intensity, and I really like the style. Could you create something similar for me but using the trust ratings from the `trust` table? I'd like the x-axis to show the source user IDs and the y-axis to represent the trust ratings.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/epinions_1.sqlite')\n\nquery = '''\nSELECT \n    T.source_u_id AS source_user,\n    T.trust AS trust_rating\nFROM \n    trust AS T\nORDER BY \n    T.source_u_id\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_trail().encode(\n    x=alt.X('source_user:O', title='Source User ID'),\n    y=alt.Y('trust_rating:Q', title='Trust Rating'),\n    size=alt.Size('trust_rating:Q', title='Strength of Trust')\n)\n\nchart",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_varying_size.png"
    },
    {
        "type": "type_B",
        "db_id": "e_learning",
        "chart_category": "Distributions",
        "chart_type": "histogram_with_responsive_bins",
        "NLQ": "I came across this histogram with responsive bins that looks really clean and interactive. Can you create something similar to show how student registrations are spread out across each hour of the day, using the `date_of_registration` column from the Students table? It would be great if users could also zoom in on specific time ranges.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/e_learning.sqlite')\n\nquery = '''\nSELECT \n    strftime('%H', date_of_registration) AS hour_of_registration,\n    COUNT(*) AS registration_count\nFROM Students\nGROUP BY hour_of_registration\nORDER BY hour_of_registration\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbrush = alt.selection_interval(encodings=['x'])\n\nbase = alt.Chart(df).mark_bar().encode(\n    y='registration_count:Q'\n).properties(\n    width=600,\n    height=100\n)\n\nchart = alt.vconcat(\n    base.encode(\n        alt.X('hour_of_registration:Q')\n          .bin(maxbins=24, extent=brush)\n          .scale(domain=brush),\n        y='registration_count:Q'\n    ),\n    base.encode(\n        alt.X('hour_of_registration:Q').bin(maxbins=24),\n        y='registration_count:Q'\n    ).add_params(brush)\n)\n\nchart",
        "reference_path": "./vis_bench/img/Distributions___histogram_with_responsive_bins.png"
    },
    {
        "type": "type_B",
        "db_id": "farm",
        "chart_category": "Distributions",
        "chart_type": "histogram_with_responsive_bins",
        "NLQ": "Can you create an interactive histogram showing the distribution of total cattle across farms? I'd like to have two stacked histograms - one that I can use to select a range to zoom in on, and another that shows the zoomed view. Make it simple with blue bars and remove any titles or labels except for the x-axis showing the cattle numbers.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/farm.sqlite')\n\nquery = '''\nSELECT Total_Cattle\nFROM farm\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nbrush = alt.selection_interval(encodings=['x'])\n\nbase = alt.Chart(df).mark_bar().encode(\n    y='count():Q'\n).properties(\n    width=600,\n    height=100\n)\n\nchart = alt.vconcat(\n    base.encode(\n        alt.X('Total_Cattle:Q')\n            .bin(maxbins=30, extent=brush)\n            .scale(domain=brush)\n    ),\n    base.encode(\n        alt.X('Total_Cattle:Q').bin(maxbins=30),\n    ).add_params(brush)\n)\n\nchart",
        "reference_path": "./vis_bench/img/Distributions___histogram_with_responsive_bins.png"
    },
    {
        "type": "type_B",
        "db_id": "farm",
        "chart_category": "Line Charts",
        "chart_type": "multiple_series_line_chart",
        "NLQ": "I came across this line chart image that I really like—it shows trends with multiple lines and it's super clear. Can you create something similar to visualize how the numbers of horses and cattle have changed over time, using the `Total_Horses` and `Total_Cattle` columns from the `farm` table? Each animal should have its own line. Make the chart simpler with a light gray background grid, put the legend on the right side, and use blue for cattle and orange for horses.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/farm.sqlite')\nquery = '''\nSELECT Year, Total_Horses, Total_Cattle\nFROM farm\nORDER BY Year\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\ndf_melted = df.melt(id_vars=['Year'], value_vars=['Total_Horses', 'Total_Cattle'], \n                    var_name='Animal_Type', value_name='Count')\nchart = alt.Chart(df_melted).mark_line().encode(\n    x='Year:T',\n    y='Count:Q',\n    color='Animal_Type:N'\n)\nchart.show()",
        "reference_path": "./vis_bench/img/Line Charts___multiple_series_line_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "game_injury",
        "chart_category": "Line Charts",
        "chart_type": "step_chart",
        "NLQ": "I like the step chart style in this image, but could you create a similar one showing total injuries per season? I'd like to see seasons on the x-axis and the number of injuries on the y-axis, with a simple title \"Total Injuries Per Season\" at the top.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/game_injury.sqlite')\n\nquery = '''\nSELECT \n    g.Season AS season,\n    COUNT(i.id) AS injury_count\nFROM \n    game AS g\nJOIN \n    injury_accident AS i ON g.id = i.game_id\nGROUP BY \n    g.Season\nORDER BY \n    g.Season\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_line(interpolate='step-after').encode(\n    x=alt.X('season:O', title='Season'),\n    y=alt.Y('injury_count:Q', title='Total Injuries')\n).properties(\n    title='Total Injuries Per Season'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Line Charts___step_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "game_injury",
        "chart_category": "Distributions",
        "chart_type": "quantile-quantile_plot",
        "NLQ": "I came across this QQ-plot image that compares data against a uniform distribution, and I really like its clean and clear style. Could you create something similar for me but using the Average Attendance and Total Attendance columns from the stadium table? I'd like to see two plots side by side - one for Average Attendance and one for Total Attendance. Also, could you add proper titles to each plot and show the actual attendance values on the y-axis instead of standardized values? It would help me see if there are any unusual patterns in the attendance data.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/game_injury.sqlite')\nquery = '''\nSELECT Average_Attendance, Total_Attendance\nFROM stadium\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase_avg_attendance = alt.Chart(df).transform_quantile(\n    'Average_Attendance',\n    step=0.01,\n    as_ = ['p', 'v']\n).transform_calculate(\n    uniform = 'quantileUniform(datum.p)'\n).mark_point().encode(\n    alt.Y('v:Q', title='Average Attendance Quantiles'),\n    alt.X('uniform:Q', title='Uniform Distribution Quantiles')\n).properties(\n    title='QQ-Plot of Average Attendance vs. Uniform Distribution'\n)\n\nbase_total_attendance = alt.Chart(df).transform_quantile(\n    'Total_Attendance',\n    step=0.01,\n    as_ = ['p', 'v']\n).transform_calculate(\n    uniform = 'quantileUniform(datum.p)'\n).mark_point().encode(\n    alt.Y('v:Q', title='Total Attendance Quantiles'),\n    alt.X('uniform:Q', title='Uniform Distribution Quantiles')\n).properties(\n    title='QQ-Plot of Total Attendance vs. Uniform Distribution'\n)\n\nchart = base_avg_attendance | base_total_attendance\nchart",
        "reference_path": "./vis_bench/img/Distributions___quantile-quantile_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "insurance_and_eClaims",
        "chart_category": "Scatter Plots",
        "chart_type": "brushing_scatter_plot_to_show_data_on_a_table",
        "NLQ": "Can you create a scatter plot showing the relationship between Amount Claimed and Amount Paid from our insurance claims data? I'd like the points to be blue and when I select points on the chart, I want to see the corresponding Claim Type and Settlement Date details in a table to the right of the chart. Make sure the axes go from 0 to 900 for both values.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/insurance_and_eClaims.sqlite')\n\nquery = '''\nSELECT \n    ch.Claim_Header_ID,\n    ch.Amount_Claimed,\n    ch.Amount_Piad AS Amount_Paid,\n    ch.Claim_Type_Code,\n    ch.Date_of_Settlement\nFROM \n    Claim_Headers AS ch\nWHERE \n    ch.Amount_Claimed IS NOT NULL AND ch.Amount_Piad IS NOT NULL\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbrush = alt.selection_interval()\n\npoints = alt.Chart(df).mark_point().encode(\n    x=alt.X('Amount_Claimed:Q', title='Amount Claimed'),\n    y=alt.Y('Amount_Paid:Q', title='Amount Paid'),\n    color=alt.condition(brush, alt.value(\"steelblue\"), alt.value(\"grey\")),\n    tooltip=['Claim_Type_Code:N', 'Date_of_Settlement:T']\n).add_params(brush).properties(\n    width=400,\n    height=400\n)\n\nranked_text = alt.Chart(df).mark_text(align='right').encode(\n    y=alt.Y('row_number:O').axis(None)\n).transform_filter(\n    brush\n).transform_window(\n    row_number='row_number()'\n).transform_filter(\n    alt.datum.row_number < 15\n)\n\nclaim_type = ranked_text.encode(text='Claim_Type_Code:N').properties(\n    title=alt.Title(text='Claim Type', align='right')\n)\nsettlement_date = ranked_text.encode(text='Date_of_Settlement:T').properties(\n    title=alt.Title(text='Settlement Date', align='right')\n)\ntext = alt.hconcat(claim_type, settlement_date)\n\nchart = alt.hconcat(\n    points,\n    text\n).resolve_legend(\n    color=\"independent\"\n).configure_view(\n    stroke=None\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Scatter Plots___brushing_scatter_plot_to_show_data_on_a_table.png"
    },
    {
        "type": "type_B",
        "db_id": "insurance_fnol",
        "chart_category": "Scatter Plots",
        "chart_type": "bubble_plot",
        "NLQ": "I came across this bubble plot that has a really clean and professional look. Could you recreate something similar to show how the number of claims a customer files relates to their total settlement amounts, with the bubble size representing the average time it takes to settle those claims? It would be great to use our customer, claims, and settlements data for this.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/insurance_fnol.sqlite')\n\nquery = '''\nSELECT \n    c.Customer_name AS Customer,\n    COUNT(cl.Claim_ID) AS Number_of_Claims,\n    SUM(s.Settlement_Amount) AS Total_Settlement_Amount,\n    AVG(julianday(s.Effective_Date) - julianday(cl.Effective_Date)) AS Avg_Settlement_Time\nFROM \n    Customers AS c\nJOIN \n    First_Notification_of_Loss AS fnol ON c.Customer_ID = fnol.Customer_ID\nJOIN \n    Claims AS cl ON fnol.FNOL_ID = cl.FNOL_ID\nJOIN \n    Settlements AS s ON cl.Claim_ID = s.Claim_ID\nGROUP BY \n    c.Customer_name\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_point().encode(\n    x='Number_of_Claims:Q',\n    y='Total_Settlement_Amount:Q',\n    size='Avg_Settlement_Time:Q',\n    tooltip=['Customer:N', 'Number_of_Claims:Q', 'Total_Settlement_Amount:Q', 'Avg_Settlement_Time:Q']\n).properties(\n    title=\"Claims vs. Settlements with Average Settlement Time\"\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Scatter Plots___bubble_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "insurance_policies",
        "chart_category": "Scatter Plots",
        "chart_type": "bubble_plot",
        "NLQ": "I came across this bubble plot design that I really like—could you recreate something similar for me? I'd like to see the relationship between the amount customers claimed and what was actually settled in 2017, with the bubble sizes showing the difference and colors representing different policy types. Please add a grid to the background, include a proper legend showing the policy types and bubble size meanings, and use a different color scheme with orange, pink and blue circles instead of all blue dots.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/insurance_policies.sqlite')\n\nquery = '''\nSELECT \n    Claims.Claim_ID,\n    Claims.Amount_Claimed,\n    Claims.Amount_Settled,\n    (Claims.Amount_Claimed - Claims.Amount_Settled) AS Difference,\n    Customer_Policies.Policy_Type_Code\nFROM \n    Claims\nJOIN \n    Customer_Policies ON Claims.Policy_ID = Customer_Policies.Policy_ID\nWHERE \n    strftime('%Y', Claims.Date_Claim_Made) = '2017'\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_point().encode(\n    x='Amount_Claimed:Q',\n    y='Amount_Settled:Q',\n    size='Difference:Q',\n    color='Policy_Type_Code:N'\n).properties(\n    title='Relationship Between Amount Claimed and Amount Settled (2017)'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Scatter Plots___bubble_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "medicine_enzyme_interaction",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_labels",
        "NLQ": "Can you create a horizontal bar chart showing the number of medicines that interact with different enzymes? I'd like to see the bars colored by interaction type (like inhibitor or activator), sorted with the enzymes that have the most interactions at the top, and include the count numbers next to each bar. Please add a title like \"Medicine-Enzyme Interaction Counts by Type\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/medicine_enzyme_interaction.sqlite')\n\nquery = '''\nSELECT \n    e.name AS enzyme_name,\n    mei.interaction_type,\n    COUNT(m.id) AS medicine_count\nFROM \n    medicine_enzyme_interaction AS mei\nJOIN \n    enzyme AS e ON mei.enzyme_id = e.id\nJOIN \n    medicine AS m ON mei.medicine_id = m.id\nGROUP BY \n    e.name, mei.interaction_type\nORDER BY \n    e.name, medicine_count DESC;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    x=alt.X('medicine_count:Q', title='Number of Medicines'),\n    y=alt.Y('enzyme_name:N', title='Enzyme Name', sort='-x'),\n    color=alt.Color('interaction_type:N', title='Interaction Type'),\n    text='medicine_count:Q'\n)\n\nchart = base.mark_bar() + base.mark_text(align='left', dx=2)\nchart.properties(title=\"Medicine-Enzyme Interaction Counts by Type\")",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_labels.png"
    },
    {
        "type": "type_B",
        "db_id": "mountain_photos",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_labels",
        "NLQ": "Can you create a horizontal bar chart showing the total number of photos taken for each mountain range? I'd like to see the mountain ranges listed on the y-axis and the number of photos on the x-axis, with the ranges sorted from most to least photographed. Please add a clear title at the top and include the count values as labels next to each bar.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/mountain_photos.sqlite')\n\nquery = '''\nSELECT \n    m.Range AS mountain_range, \n    COUNT(p.id) AS photo_count\nFROM \n    mountain AS m\nJOIN \n    photos AS p ON m.id = p.mountain_id\nGROUP BY \n    m.Range\nORDER BY \n    photo_count DESC;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    x=alt.X('photo_count:Q', title='Number of Photos'),\n    y=alt.Y('mountain_range:N', sort='-x', title='Mountain Range'),\n    text='photo_count:Q'\n)\n\nchart = base.mark_bar() + base.mark_text(align='left', dx=2)\nchart.properties(title=\"Total Photos Taken per Mountain Range\")",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_labels.png"
    },
    {
        "type": "type_B",
        "db_id": "museum_visit",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_labels_based_on_measured_luminance",
        "NLQ": "I came across this bar chart image that I really like—it has labels on the bars and the colors get darker for higher values. Can you create something similar showing how many tickets each museum sold, using the data from the `visit` and `museum` tables? Make sure to add a title \"Total Tickets Sold Per Museum\" at the top, and use a blue color scheme for the bars. Also, could you make it a horizontal bar chart with the museum names on the y-axis?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/museum_visit.sqlite')\n\nquery = '''\nSELECT \n    m.Name AS Museum_Name, \n    SUM(v.Num_of_Ticket) AS Total_Tickets\nFROM \n    visit AS v\nJOIN \n    museum AS m ON v.Museum_ID = m.Museum_ID\nGROUP BY \n    m.Name\nORDER BY \n    Total_Tickets DESC;\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nbase = alt.Chart(df).encode(\n    x=alt.X('Total_Tickets:Q', title='Total Tickets Sold'),\n    y=alt.Y('Museum_Name:O', sort='-x', title='Museum'),\n    text=alt.Text('Total_Tickets:Q', format='.0f')\n)\n\nbars = base.mark_bar().encode(\n    color=alt.Color('Total_Tickets:Q', scale=alt.Scale(scheme='blues'), title='Tickets Sold'),\n    tooltip=alt.Tooltip('Total_Tickets:Q', format='.0f')\n)\n\ntext = base.mark_text(\n    align='left',\n    dx=3,\n    color=alt.expr(\"luminance(scale('color', datum.Total_Tickets)) > 0.5 ? 'black' : 'white'\")\n)\n\nchart = bars + text\n\nchart.properties(\n    title='Total Tickets Sold Per Museum',\n    width=600,\n    height=400\n)",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_labels_based_on_measured_luminance.png"
    },
    {
        "type": "type_B",
        "db_id": "orchestra",
        "chart_category": "Scatter Plots",
        "chart_type": "scatter_plot_with_shaded_area",
        "NLQ": "Can you create a scatter plot showing the relationship between conductor age and their years of work? I'd like to see a vertical red shaded area highlighting ages 40 to 42, and please label the axes clearly as \"Conductor Age\" and \"Years of Work\". Make the plot clean with a light grid in the background.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/orchestra.sqlite')\nquery = '''\nSELECT Age, Year_of_Work\nFROM conductor\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nshaded_area = pd.DataFrame({\n    \"x1\": [40],\n    \"x2\": [42]\n})\n\npoints = alt.Chart(df).mark_point().encode(\n    x=alt.X(\"Age:Q\", title=\"Conductor Age\"),\n    y=alt.Y(\"Year_of_Work:Q\", title=\"Years of Work\")\n)\n\ninterval = alt.Chart(shaded_area).mark_rect(opacity=0.3, color=\"#FF0000\").encode(\n    x=\"x1:Q\",\n    x2=\"x2:Q\"\n)\n\nchart = points + interval\nchart",
        "reference_path": "./vis_bench/img/Scatter Plots___scatter_plot_with_shaded_area.png"
    },
    {
        "type": "type_B",
        "db_id": "phone_1",
        "chart_category": "Simple Charts",
        "chart_type": "simple_bar_chart",
        "NLQ": "I came across this simple bar chart that looks really clean and professional. Can you create something similar to show how many phone models were launched each year, using the launch year from the chip_model table? Make sure to add a clear title \"Total Phone Models Launched Each Year\", label the x-axis as \"Launch Year\" and the y-axis as \"Total Models Launched\", and add gridlines to make it easier to read the values.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/phone_1.sqlite')\n\nquery = '''\nSELECT Launch_year, COUNT(Model_name) AS Total_Models\nFROM chip_model\nGROUP BY Launch_year\nORDER BY Launch_year\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x=alt.X('Launch_year:O', title='Launch Year'),\n    y=alt.Y('Total_Models:Q', title='Total Models Launched')\n).properties(\n    title='Total Phone Models Launched Each Year'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Simple Charts___simple_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "phone_market",
        "chart_category": "Simple Charts",
        "chart_type": "simple_bar_chart",
        "NLQ": "I like this bar chart showing inventory data. Can you create a similar one using our phone market database to show the total number of phones in stock by district? I'd like to see the districts sorted from highest to lowest inventory so we can easily identify which districts have the most stock.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/phone_market.sqlite')\n\nquery = '''\nSELECT \n    m.District AS District, \n    SUM(pm.Num_of_stock) AS Total_Stock\nFROM \n    phone_market AS pm\nJOIN \n    market AS m ON pm.Market_ID = m.Market_ID\nGROUP BY \n    m.District\nORDER BY \n    Total_Stock DESC;\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x=alt.X('District:N', title='District'),\n    y=alt.Y('Total_Stock:Q', title='Total Phones in Stock')\n)\n\nchart",
        "reference_path": "./vis_bench/img/Simple Charts___simple_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "poker_player",
        "chart_category": "Simple Charts",
        "chart_type": "simple_heatmap",
        "NLQ": "I like this heatmap showing a mathematical function. Could you create a similar heatmap but using poker data instead? I'd like to see the total earnings of poker players grouped by their nationality on the y-axis and the number of final tables they've made on the x-axis. Use a similar color scheme where brighter colors represent higher earnings. Please add an appropriate title and make sure the axes are clearly labeled.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/poker_player.sqlite')\n\nquery = '''\nSELECT \n    p.Nationality,\n    pp.Final_Table_Made,\n    SUM(pp.Earnings) AS Total_Earnings\nFROM \n    poker_player AS pp\nJOIN \n    people AS p ON pp.People_ID = p.People_ID\nGROUP BY \n    p.Nationality, pp.Final_Table_Made\nORDER BY \n    p.Nationality, pp.Final_Table_Made;\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nheatmap = alt.Chart(df).mark_rect().encode(\n    x=alt.X('Final_Table_Made:O', title='Final Tables Made'),\n    y=alt.Y('Nationality:O', title='Nationality'),\n    color=alt.Color('Total_Earnings:Q', title='Total Earnings', scale=alt.Scale(scheme='viridis'))\n).properties(\n    width=600,\n    height=400,\n    title=\"Heatmap of Poker Players' Earnings by Nationality and Final Tables Made\"\n)\n\nheatmap",
        "reference_path": "./vis_bench/img/Simple Charts___simple_heatmap.png"
    },
    {
        "type": "type_B",
        "db_id": "products_gen_characteristics",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_rounded_edges",
        "NLQ": "I like this bar chart showing weather data, but could you create a similar one with rounded corners that shows our product categories instead? I'd like to see how many products we have in each category, and have the bars colored by price range (low, medium, and high). Please add a clear title and make sure the axes are properly labeled.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/products_gen_characteristics.sqlite')\nquery = '''\nSELECT \n    T1.product_category_description AS category,\n    CASE \n        WHEN CAST(T2.typical_selling_price AS FLOAT) < 100 THEN 'Low'\n        WHEN CAST(T2.typical_selling_price AS FLOAT) BETWEEN 100 AND 1000 THEN 'Medium'\n        ELSE 'High'\n    END AS price_range\nFROM Ref_Product_Categories AS T1\nJOIN Products AS T2 ON T1.product_category_code = T2.product_category_code\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar(\n    cornerRadiusTopLeft=3,\n    cornerRadiusTopRight=3\n).encode(\n    x=alt.X('category:N', title='Product Category'),\n    y=alt.Y('count():Q', title='Number of Products'),\n    color=alt.Color('price_range:N', title='Selling Price Range')\n).properties(\n    title='Count of Products by Category and Selling Price Range'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_rounded_edges.png"
    },
    {
        "type": "type_B",
        "db_id": "program_share",
        "chart_category": "Bar Charts",
        "chart_type": "bar_chart_with_rounded_edges",
        "NLQ": "Can you create a bar chart showing the average share percentage of different TV programs across different times of day? I'd like to see the data organized by time of day on the x-axis, with the bars showing share percentage and color-coded by program name. Please use rounded corners for the bars and add a clear title that explains what we're looking at.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/program_share.sqlite')\nquery = '''\nSELECT \n    b.Time_of_day AS Time_of_day,\n    p.Name AS Program_Name,\n    AVG(bs.Share_in_percent) AS Avg_Share_Percent\nFROM \n    broadcast AS b\nJOIN \n    program AS p ON b.Program_ID = p.Program_ID\nJOIN \n    broadcast_share AS bs ON b.Channel_ID = bs.Channel_ID AND b.Program_ID = bs.Program_ID\nGROUP BY \n    b.Time_of_day, p.Name\nORDER BY \n    b.Time_of_day;\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar(\n    cornerRadiusTopLeft=3,\n    cornerRadiusTopRight=3\n).encode(\n    x=alt.X('Time_of_day:O', title='Time of Day'),\n    y=alt.Y('Avg_Share_Percent:Q', title='Average Share Percentage'),\n    color=alt.Color('Program_Name:N', title='Program Name')\n).properties(\n    title='Average Share Percentage by Time of Day and Program'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___bar_chart_with_rounded_edges.png"
    },
    {
        "type": "type_B",
        "db_id": "protein_institute",
        "chart_category": "Bar Charts",
        "chart_type": "calculating_percentage_of_total",
        "NLQ": "I came across this bar chart that shows percentages of a total, and I really like its clean style. Can you create something similar for me but using the heights of buildings from the `building` table to show what percentage each building contributes to the total height?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/protein_institute.sqlite')\n\nquery = '''\nSELECT Name, Height_feet\nFROM building\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).transform_joinaggregate(\n    TotalHeight='sum(Height_feet)',\n).transform_calculate(\n    PercentOfTotal=\"datum.Height_feet / datum.TotalHeight\"\n).mark_bar().encode(\n    alt.X('PercentOfTotal:Q').axis(format='.0%'),\n    y='Name:N'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___calculating_percentage_of_total.png"
    },
    {
        "type": "type_B",
        "db_id": "race_track",
        "chart_category": "Bar Charts",
        "chart_type": "calculating_percentage_of_total",
        "NLQ": "I came across this bar chart that shows percentages really well, and I love the way it's laid out. Can you create something similar to visualize how the races are distributed across different track locations as percentages? It should use the data from the `race` and `track` tables. Remove the title and make the bars horizontal with track locations on the y-axis.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/race_track.sqlite')\n\nquery = '''\nSELECT \n    t.Location AS Track_Location,\n    COUNT(r.Race_ID) AS Race_Count\nFROM \n    race AS r\nJOIN \n    track AS t\nON \n    r.Track_ID = t.Track_ID\nGROUP BY \n    t.Location\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).transform_joinaggregate(\n    TotalRaces='sum(Race_Count)',\n).transform_calculate(\n    PercentOfTotal=\"datum.Race_Count / datum.TotalRaces\"\n).mark_bar().encode(\n    alt.X('PercentOfTotal:Q').axis(format='.0%'),\n    y='Track_Location:N'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___calculating_percentage_of_total.png"
    },
    {
        "type": "type_B",
        "db_id": "restaurant_1",
        "chart_category": "Bar Charts",
        "chart_type": "compact_faceted_grid_of_bar_charts",
        "NLQ": "I like this grid layout of bar charts, but could you make a simpler version showing just restaurant types and gender? I'd like to see the average amount spent by male and female students at different restaurant types. Make the bars horizontal with restaurant types listed vertically, and put the gender legend at the bottom.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/restaurant_1.sqlite')\n\nquery = '''\nSELECT \n    RT.ResTypeName AS Restaurant_Type,\n    S.Sex AS Gender,\n    AVG(VR.Spent) AS Average_Spent\nFROM \n    Visits_Restaurant AS VR\nJOIN \n    Student AS S ON VR.StuID = S.StuID\nJOIN \n    Type_Of_Restaurant AS TOR ON VR.ResID = TOR.ResID\nJOIN \n    Restaurant_Type AS RT ON TOR.ResTypeID = RT.ResTypeID\nGROUP BY \n    RT.ResTypeName, S.Sex\nORDER BY \n    RT.ResTypeName, S.Sex;\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df, width=60, height=alt.Step(8)).mark_bar().encode(\n    alt.Y(\"Gender:N\").axis(None),\n    alt.X(\"Average_Spent:Q\").title(\"Average Amount Spent\"),\n    alt.Color(\"Gender:N\").title(\"Gender\").legend(orient=\"bottom\", titleOrient=\"left\"),\n    alt.Row(\"Restaurant_Type:N\").title(\"Restaurant Type\").header(labelAngle=0)\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___compact_faceted_grid_of_bar_charts.png"
    },
    {
        "type": "type_B",
        "db_id": "riding_club",
        "chart_category": "Bar Charts",
        "chart_type": "compact_faceted_grid_of_bar_charts",
        "NLQ": "I like this visualization showing votes by rank, but could you make it more compact by turning it into horizontal bars? I'd like to see each rank as a separate row, with male and female bars side by side for comparison. Remove the x-axis labels and put the legend at the bottom. Also, make the bars narrower to create a more streamlined look.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/riding_club.sqlite')\n\nquery = '''\nSELECT Gender, Rank, SUM(Votes) AS Total_Votes\nFROM player\nGROUP BY Gender, Rank\nORDER BY Rank\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df, width=60, height=alt.Step(8)).mark_bar().encode(\n    alt.Y(\"Gender:N\").axis(None),\n    alt.X(\"Total_Votes:Q\").title(None),\n    alt.Color(\"Gender:N\").title(\"Gender\").legend(orient=\"bottom\", titleOrient=\"left\"),\n    alt.Row(\"Rank:N\").title(\"Rank\").header(labelAngle=0)\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___compact_faceted_grid_of_bar_charts.png"
    },
    {
        "type": "type_B",
        "db_id": "school_bus",
        "chart_category": "Bar Charts",
        "chart_type": "diverging_stacked_bar_chart",
        "NLQ": "I like this diverging stacked bar chart showing survey responses, but could you create a similar visualization that shows school bus drivers' years of experience by political party instead? I'd like to see the breakdown of experience levels (0-5 years, 6-10 years, and 11+ years) as percentages for Democrats and Republicans, using a similar horizontal bar format but with peach, gray, and light blue colors for the experience ranges.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/school_bus.sqlite')\n\nquery = '''\nSELECT \n    d.Party AS Party,\n    CASE \n        WHEN sb.Years_Working BETWEEN 0 AND 5 THEN '0-5 years'\n        WHEN sb.Years_Working BETWEEN 6 AND 10 THEN '6-10 years'\n        ELSE '11+ years'\n    END AS Experience_Range,\n    COUNT(*) AS Driver_Count\nFROM \n    driver AS d\nJOIN \n    school_bus AS sb ON d.Driver_ID = sb.Driver_ID\nGROUP BY \n    d.Party, Experience_Range\nORDER BY \n    d.Party, Experience_Range;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndf['Experience_Code'] = df['Experience_Range'].map({'0-5 years': 1, '6-10 years': 2, '11+ years': 3})\n\ndef compute_percentages(group):\n    group = group.set_index('Experience_Code').sort_index()\n    perc = (group['Driver_Count'] / group['Driver_Count'].sum()) * 100\n    group['Percentage'] = perc\n    group['Percentage_End'] = perc.cumsum() - (perc.sum() / 2)\n    group['Percentage_Start'] = group['Percentage_End'] - perc\n    return group\n\ndf = df.groupby('Party').apply(compute_percentages).reset_index(drop=True)\n\ncolor_scale = alt.Scale(\n    domain=['0-5 years', '6-10 years', '11+ years'],\n    range=['#f3a583', '#cccccc', '#94c6da']\n)\n\ny_axis = alt.Axis(title=\"Political Party\", offset=5, ticks=False, minExtent=60, domain=False)\n\nchart = alt.Chart(df).mark_bar().encode(\n    x=alt.X(\"Percentage_Start:Q\", title=\"Percentage\"),\n    x2=\"Percentage_End:Q\",\n    y=alt.Y(\"Party:N\").axis(y_axis),\n    color=alt.Color(\"Experience_Range:N\").title(\"Experience Range\").scale(color_scale)\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___diverging_stacked_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "school_finance",
        "chart_category": "Simple Charts",
        "chart_type": "simple_stacked_area_chart",
        "NLQ": "I'd like to see the school finance data split into two separate charts - one for budgeted amounts and one for invested amounts. Can you create stacked area charts showing the yearly trends for each school with different colors, and arrange them vertically instead of having everything in one chart? Also, please add gridlines to make it easier to read the values.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/school_finance.sqlite')\n\nquery = '''\nSELECT \n    S.School_name AS School,\n    B.Year AS Year,\n    SUM(B.Budgeted) AS Total_Budgeted,\n    SUM(B.Invested) AS Total_Invested\nFROM \n    budget AS B\nJOIN \n    School AS S ON B.School_id = S.School_id\nGROUP BY \n    S.School_name, B.Year\nORDER BY \n    B.Year\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\ndf_melted = df.melt(id_vars=['School', 'Year'], value_vars=['Total_Budgeted', 'Total_Invested'], \n                    var_name='Category', value_name='Amount')\n\nchart = alt.Chart(df_melted).mark_area().encode(\n    x=alt.X(\"Year:O\", title=\"Year\"),\n    y=alt.Y(\"Amount:Q\", title=\"Amount\"),\n    color=alt.Color(\"School:N\", title=\"School\"),\n    row=alt.Row(\"Category:N\", title=\"Category\")\n).properties(\n    width=600,\n    height=150\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Simple Charts___simple_stacked_area_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "school_finance",
        "chart_category": "Bar Charts",
        "chart_type": "faceted_stacked_bar_chart",
        "NLQ": "I like this chart showing crop yields by variety and site, but I need something different. Could you create a horizontal bar chart comparing budgeted versus invested amounts for different schools from 1999 to 2001? I'd like to see each school in its own panel, with years going down the left side and the dollar amounts shown horizontally. Please add a clear title and make sure to label the axes properly with dollar amounts.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/school_finance.sqlite')\n\nquery = '''\nSELECT \n    S.School_name AS School,\n    B.Year AS Year,\n    B.Budgeted AS Budgeted,\n    B.Invested AS Invested\nFROM \n    School AS S\nJOIN \n    budget AS B\nON \n    S.School_id = B.School_id\nWHERE \n    B.Year BETWEEN 1999 AND 2001\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndf_melted = df.melt(id_vars=['School', 'Year'], value_vars=['Budgeted', 'Invested'], \n                    var_name='Category', value_name='Amount')\n\nchart = alt.Chart(df_melted).mark_bar().encode(\n    column=alt.Column(\"School:N\", title=\"School\"),\n    x=alt.X(\"Amount:Q\", title=\"Amount ($)\"),\n    y=alt.Y(\"Year:O\", title=\"Year\"),\n    color=alt.Color(\"Category:N\", title=\"Category\")\n).properties(\n    width=200,\n    title=\"Comparison of Budgeted and Invested Amounts by School (1999-2001)\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___faceted_stacked_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "school_player",
        "chart_category": "Simple Charts",
        "chart_type": "simple_strip_plot",
        "NLQ": "I like this strip plot showing horsepower vs cylinders, but could you create a similar one using the school data instead? I'd like to see the distribution of enrollment numbers for different religious denominations like Anglican, Catholic, and Uniting Church. Put the denominations on the y-axis and enrollment numbers on the x-axis.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/school_player.sqlite')\n\nquery = '''\nSELECT Enrollment, Denomination\nFROM school\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_tick().encode(\n    x='Enrollment:Q',\n    y='Denomination:O'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Simple Charts___simple_strip_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "school_player",
        "chart_category": "Bar Charts",
        "chart_type": "faceted_stacked_bar_chart",
        "NLQ": "I like this visualization showing crop yields across different varieties and sites, but I need something for baseball data instead. Could you create a similar chart that shows the distribution of baseball players by position for different schools? I'd like to see horizontal bars for each position, with the bars colored by team, and have the schools displayed in separate columns. Please add a title like \"Distribution of Players by Position Across Schools\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/school_player.sqlite')\n\nquery = '''\nSELECT \n    s.School AS School_Name,\n    p.Position,\n    p.Team,\n    COUNT(p.Player_ID) AS Player_Count\nFROM \n    player AS p\nJOIN \n    school AS s ON p.School_ID = s.School_ID\nGROUP BY \n    s.School, p.Position, p.Team\nORDER BY \n    s.School, p.Position\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    column=alt.Column(\"School_Name:N\", title=\"School\"),\n    x=alt.X(\"Player_Count:Q\", title=\"Number of Players\"),\n    y=alt.Y(\"Position:N\", title=\"Position\"),\n    color=alt.Color(\"Team:N\", title=\"Team\")\n).properties(\n    width=200,\n    title=\"Distribution of Players by Position Across Schools\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___faceted_stacked_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "scientist_1",
        "chart_category": "Simple Charts",
        "chart_type": "simple_strip_plot",
        "NLQ": "I like this strip plot showing horsepower distribution by cylinder count. Could you create a similar visualization but instead show the hours allocated to different project codes from the Projects table in our database? Just use a simple tick mark style like this example.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/scientist_1.sqlite')\nquery = '''\nSELECT Code, Hours\nFROM Projects\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_tick().encode(\n    x='Hours:Q',\n    y='Code:O'\n)\nchart.show()",
        "reference_path": "./vis_bench/img/Simple Charts___simple_strip_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "scientist_1",
        "chart_category": "Bar Charts",
        "chart_type": "faceted_stacked_bar_chart",
        "NLQ": "I like this visualization showing crop yields, but I need to create a chart showing how much time scientists spend on different projects. Can you make a horizontal bar chart with scientists across the top as separate columns, project names on the y-axis, and the total hours spent on the x-axis? Please color-code the bars by project name and add a title \"Total Hours Spent by Scientists on Projects\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/scientist_1.sqlite')\n\nquery = '''\nSELECT \n    S.Name AS ScientistName,\n    P.Name AS ProjectName,\n    SUM(P.Hours) AS TotalHours\nFROM \n    AssignedTo AS A\nJOIN \n    Scientists AS S ON A.Scientist = S.SSN\nJOIN \n    Projects AS P ON A.Project = P.Code\nGROUP BY \n    S.Name, P.Name\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    column=alt.Column(\"ScientistName:N\", title=\"Scientist\"),\n    x=\"TotalHours:Q\",\n    y=\"ProjectName:N\",\n    color=\"ProjectName:N\"\n).properties(\n    width=200,\n    title=\"Total Hours Spent by Scientists on Projects\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___faceted_stacked_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "ship_1",
        "chart_category": "Bar Charts",
        "chart_type": "grouped_bar_chart",
        "NLQ": "I'd like to see a chart showing the number of captains by their rank (Commander, Lieutenant, Midshipman) across different ship classes. Could you organize it as a faceted bar chart with ship classes as columns and captain ranks color-coded? Please add a title that explains what we're looking at and include gridlines to make it easier to read the values.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/ship_1.sqlite')\nquery = '''\nSELECT \n    c.Rank AS Captain_Rank, \n    c.Class AS Ship_Class, \n    COUNT(c.Captain_ID) AS Captain_Count\nFROM \n    captain AS c\nGROUP BY \n    c.Rank, c.Class\nORDER BY \n    c.Rank, c.Class;\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x=alt.X('Captain_Rank:N', title='Captain Rank'),\n    y=alt.Y('sum(Captain_Count):Q', title='Number of Captains'),\n    color=alt.Color('Captain_Rank:N', legend=alt.Legend(title=\"Rank\")),\n    column=alt.Column('Ship_Class:N', title='Ship Class')\n).properties(\n    title=\"Number of Captains Grouped by Rank and Ship Class\"\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___grouped_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "ship_mission",
        "chart_category": "Tables",
        "chart_type": "annual_weather_heatmap",
        "NLQ": "I came across this Annual Weather Heatmap that has a really clean and professional look. Can you create something similar to visualize the number of missions launched each year, grouped by the nationality of the ships? I'd like the years on one axis, nationalities on the other, and the mission counts represented by color intensity. Make the heatmap more compact with a blue color scheme, and add a clear title at the top.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/ship_mission.sqlite')\n\nquery = '''\nSELECT \n    s.Nationality AS Nationality,\n    m.Launched_Year AS Launched_Year,\n    COUNT(m.Mission_ID) AS Mission_Count\nFROM \n    mission AS m\nJOIN \n    ship AS s\nON \n    m.Ship_ID = s.Ship_ID\nGROUP BY \n    s.Nationality, m.Launched_Year\nORDER BY \n    s.Nationality, m.Launched_Year;\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df, title=\"Number of Missions Launched Each Year by Nationality\").mark_rect().encode(\n    alt.X(\"Launched_Year:O\").title(\"Launch Year\"),\n    alt.Y(\"Nationality:O\").title(\"Nationality\"),\n    alt.Color(\"Mission_Count:Q\").title(\"Missions\"),\n    tooltip=[\n        alt.Tooltip(\"Launched_Year\", title=\"Launch Year\"),\n        alt.Tooltip(\"Nationality\", title=\"Nationality\"),\n        alt.Tooltip(\"Mission_Count\", title=\"Mission Count\"),\n    ],\n).configure_view(\n    step=13,\n    strokeWidth=0\n).configure_axis(\n    domain=False\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Tables___annual_weather_heatmap.png"
    },
    {
        "type": "type_B",
        "db_id": "ship_mission",
        "chart_category": "Bar Charts",
        "chart_type": "grouped_bar_chart",
        "NLQ": "Could you create a bar chart showing the total tonnage of ships by their type and nationality? I'd like to see the ship types as separate columns with bars for each nationality, and use colors to distinguish between the United Kingdom and United States.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/ship_mission.sqlite')\n\nquery = '''\nSELECT \n    Type, \n    Nationality, \n    SUM(Tonnage) AS Total_Tonnage\nFROM \n    ship\nGROUP BY \n    Type, \n    Nationality\nORDER BY \n    Type, \n    Nationality;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='Nationality:N',\n    y='Total_Tonnage:Q',\n    color='Nationality:N',\n    column='Type:N'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___grouped_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "shop_membership",
        "chart_category": "Bar Charts",
        "chart_type": "grouped_bar_chart",
        "NLQ": "Can you create a bar chart showing membership registration counts by year for different cities? I'd like to see the data from 2016 to 2018, with each year having a different color, and the cities displayed in separate columns. Please use the membership_register_branch and branch tables from our shop database.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/shop_membership.sqlite')\n\nquery = '''\nSELECT \n    b.City AS City, \n    mrb.Register_Year AS Register_Year, \n    COUNT(mrb.Member_ID) AS Registration_Count\nFROM \n    membership_register_branch AS mrb\nJOIN \n    branch AS b ON mrb.Branch_ID = b.Branch_ID\nWHERE \n    mrb.Register_Year BETWEEN '2016' AND '2018'\nGROUP BY \n    b.City, mrb.Register_Year\nORDER BY \n    b.City, mrb.Register_Year;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='Register_Year:O',\n    y='sum(Registration_Count):Q',\n    color='Register_Year:N',\n    column='City:N'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___grouped_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "shop_membership",
        "chart_category": "Tables",
        "chart_type": "annual_weather_heatmap",
        "NLQ": "I came across this Annual Weather Heatmap that has a really clean and professional look. Could you create something similar for me? I'd like it to show the total purchase amounts by branch and year, with branches on the y-axis, years on the x-axis, and the color intensity reflecting the total spent. Please use a blue color scheme instead of the green-yellow one, add a title \"Total Purchase Amounts by Branch and Year\", and make sure to include the pound symbol in the legend since we're showing monetary values.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/shop_membership.sqlite')\n\nquery = '''\nSELECT \n    b.Name AS Branch_Name,\n    p.Year AS Purchase_Year,\n    SUM(p.Total_pounds) AS Total_Purchase_Amount\nFROM \n    purchase AS p\nJOIN \n    branch AS b ON p.Branch_ID = b.Branch_ID\nGROUP BY \n    b.Name, p.Year\nORDER BY \n    b.Name, p.Year;\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df, title=\"Total Purchase Amounts by Branch and Year\").mark_rect().encode(\n    alt.X(\"Purchase_Year:O\").title(\"Year\"),\n    alt.Y(\"Branch_Name:O\").title(\"Branch\"),\n    alt.Color(\"Total_Purchase_Amount:Q\").title(\"Total Purchase Amount (£)\").scale(scheme=\"blues\"),\n    tooltip=[\n        alt.Tooltip(\"Branch_Name\", title=\"Branch\"),\n        alt.Tooltip(\"Purchase_Year\", title=\"Year\"),\n        alt.Tooltip(\"Total_Purchase_Amount\", title=\"Total Purchase Amount (£)\", format=\".2f\"),\n    ],\n).configure_view(\n    step=13,\n    strokeWidth=0\n).configure_axis(\n    domain=False\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Tables___annual_weather_heatmap.png"
    },
    {
        "type": "type_B",
        "db_id": "singer",
        "chart_category": "Tables",
        "chart_type": "annual_weather_heatmap",
        "NLQ": "I came across this Annual Weather Heatmap that has a really clean and professional look. Could you create something similar to show how the birth years of singers relate to the best chart positions of their songs? I'd like the song titles on one axis, the singer birth years on the other, and the colors representing how high each song ranked. Make the title \"Best Chart Positions by Singer Birth Year\" and use a blue color scheme where darker blue represents higher chart positions (closer to #1). Also, remove the grid lines for a cleaner look.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/singer.sqlite')\nquery = '''\nSELECT \n    s.Birth_Year AS Singer_Birth_Year,\n    so.Title AS Song_Title,\n    MIN(so.Highest_Position) AS Best_Position\nFROM \n    singer AS s\nJOIN \n    song AS so\nON \n    s.Singer_ID = so.Singer_ID\nGROUP BY \n    s.Birth_Year, so.Title\nORDER BY \n    s.Birth_Year ASC, Best_Position ASC;\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df, title=\"Best Chart Positions by Singer Birth Year\").mark_rect().encode(\n    alt.X(\"Song_Title:N\").title(\"Song Title\"),\n    alt.Y(\"Singer_Birth_Year:N\").title(\"Singer Birth Year\"),\n    alt.Color(\"Best_Position:Q\").title(\"Highest Position\"),\n    tooltip=[\n        alt.Tooltip(\"Song_Title\", title=\"Song Title\"),\n        alt.Tooltip(\"Singer_Birth_Year\", title=\"Singer Birth Year\"),\n        alt.Tooltip(\"Best_Position\", title=\"Best Position\"),\n    ],\n).configure_view(\n    step=13,\n    strokeWidth=0\n).configure_axis(\n    domain=False\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Tables___annual_weather_heatmap.png"
    },
    {
        "type": "type_B",
        "db_id": "singer",
        "chart_category": "Bar Charts",
        "chart_type": "grouped_bar_chart_with_error_bars",
        "NLQ": "Can you create a bar chart showing the average net worth of singers by their citizenship? I'd like to see the average net worth in millions on the y-axis, with different colors for each country. Also, could you add error bars showing the range from minimum to maximum net worth for each citizenship group? Please title it \"Comparison of Average Net Worth by Citizenship with Variability.\"",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/singer.sqlite')\n\nquery = '''\nSELECT Citizenship, AVG(Net_Worth_Millions) AS Avg_Net_Worth, \n       COUNT(*) AS Singer_Count, \n       MIN(Net_Worth_Millions) AS Min_Net_Worth, \n       MAX(Net_Worth_Millions) AS Max_Net_Worth\nFROM singer\nGROUP BY Citizenship\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbars = alt.Chart(df).mark_bar().encode(\n    x='Citizenship:N',\n    y=alt.Y('Avg_Net_Worth:Q').title('Average Net Worth (Millions)'),\n    color='Citizenship:N'\n)\n\nerror_bars = alt.Chart(df).mark_errorbar(extent='ci').encode(\n    x='Citizenship:N',\n    y=alt.Y('Min_Net_Worth:Q').title('Net Worth Range'),\n    y2='Max_Net_Worth:Q'\n)\n\nchart = alt.layer(bars, error_bars).properties(\n    title='Comparison of Average Net Worth by Citizenship with Variability'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___grouped_bar_chart_with_error_bars.png"
    },
    {
        "type": "type_B",
        "db_id": "soccer_1",
        "chart_category": "Bar Charts",
        "chart_type": "grouped_bar_chart_with_error_bars",
        "NLQ": "Can you create a chart showing the average overall rating and potential for soccer players based on their preferred foot (left or right)? I'd like to see the two rating types separated into different panels, with error bars to show the variation. Please use blue for overall rating and orange for potential.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/soccer_1.sqlite')\n\nquery = '''\nSELECT \n    preferred_foot,\n    AVG(overall_rating) AS avg_overall_rating,\n    AVG(potential) AS avg_potential,\n    COUNT(*) AS count\nFROM Player_Attributes\nWHERE overall_rating IS NOT NULL AND potential IS NOT NULL\nGROUP BY preferred_foot\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndf_melted = df.melt(id_vars=['preferred_foot'], \n                    value_vars=['avg_overall_rating', 'avg_potential'], \n                    var_name='rating_type', \n                    value_name='average_value')\n\nbars = alt.Chart(df_melted).mark_bar().encode(\n    x=alt.X('preferred_foot:N').title('Preferred Foot'),\n    y=alt.Y('average_value:Q').title('Average Rating'),\n    color=alt.Color('rating_type:N').title('Rating Type')\n)\n\nerror_bars = alt.Chart(df_melted).mark_errorbar(extent='stdev').encode(\n    x=alt.X('preferred_foot:N'),\n    y=alt.Y('average_value:Q')\n)\n\nchart = alt.layer(bars, error_bars).facet(\n    column=alt.Column('rating_type:N').title('Rating Type')\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___grouped_bar_chart_with_error_bars.png"
    },
    {
        "type": "type_B",
        "db_id": "sports_competition",
        "chart_category": "Tables",
        "chart_type": "lasagna_plot_dense_time-series_heatmap",
        "NLQ": "I like this heatmap showing stock prices over time, but could you create a similar one using our sports competition data instead? I'd like to see the total medals won by each club across different years. Please use blue color shades, add a proper title, and make sure to label the axes as \"Club\" and \"Year\" with a legend showing the medal counts.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/sports_competition.sqlite')\n\nquery = '''\nSELECT \n    c.name AS Club_Name,\n    cr.Year AS Year,\n    SUM(clr.Gold + clr.Silver + clr.Bronze) AS Total_Medals\nFROM \n    club AS c\nJOIN \n    club_rank AS clr ON c.Club_ID = clr.Club_ID\nJOIN \n    competition AS cr ON cr.Competition_ID = clr.Club_ID\nGROUP BY \n    c.name, cr.Year\nORDER BY \n    cr.Year, c.name\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = (\n    alt.Chart(df, width=400, height=200)\n    .mark_rect()\n    .encode(\n        alt.X(\"Year:O\").title(\"Year\"),\n        alt.Y(\"Club_Name:N\").title(\"Club\"),\n        alt.Color(\"Total_Medals:Q\")\n        .title(\"Total Medals\")\n        .scale(scheme=\"blues\"),\n    )\n    .properties(title=\"Total Medals Won by Clubs Over Time\")\n)\n\nchart",
        "reference_path": "./vis_bench/img/Tables___lasagna_plot_dense_time-series_heatmap.png"
    },
    {
        "type": "type_B",
        "db_id": "sports_competition",
        "chart_category": "Bar Charts",
        "chart_type": "grouped_bar_chart_with_xoffset",
        "NLQ": "I came across this grouped bar chart that looks really clean and professional. Can you create something similar to compare the gold, silver, and bronze medal counts for the top three clubs in the competition? I'd like the clubs on the x-axis and the medals grouped by type. Please use \"Medal Counts by Top 3 Clubs\" as the title, label the y-axis as \"Medal Count\", and use a different color scheme that shows Gold in orange, Silver in pink, and Bronze in blue.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/sports_competition.sqlite')\nquery = '''\nSELECT \n    c.name AS Club_Name,\n    cr.Gold,\n    cr.Silver,\n    cr.Bronze\nFROM \n    club_rank AS cr\nJOIN \n    club AS c ON cr.Club_ID = c.Club_ID\nWHERE \n    cr.Rank <= 3\nORDER BY \n    cr.Rank;\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\ndf_melted = df.melt(id_vars=[\"Club_Name\"], value_vars=[\"Gold\", \"Silver\", \"Bronze\"], \n                    var_name=\"Medal_Type\", value_name=\"Count\")\n\nchart = alt.Chart(df_melted).mark_bar().encode(\n    x=alt.X(\"Club_Name:N\", title=\"Club\"),\n    y=alt.Y(\"Count:Q\", title=\"Medal Count\"),\n    xOffset=\"Medal_Type:N\",\n    color=alt.Color(\"Medal_Type:N\", title=\"Medal Type\")\n).properties(\n    title=\"Medal Counts by Top 3 Clubs\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___grouped_bar_chart_with_xoffset.png"
    },
    {
        "type": "type_B",
        "db_id": "station_weather",
        "chart_category": "Tables",
        "chart_type": "lasagna_plot_dense_time-series_heatmap",
        "NLQ": "I like this stock price heatmap, but could you create a similar visualization showing high temperatures at different weather stations throughout the week? I'd like to see the stations listed vertically on the left, days of the week across the bottom, and use colors to show temperature values. Please add a clear title like \"High Temperatures by Station and Day of Week\" and make sure to include proper labels for the axes and a temperature scale in Fahrenheit.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/station_weather.sqlite')\n\nquery = '''\nSELECT \n    s.network_name AS station_name,\n    w.day_of_week,\n    w.high_temperature\nFROM \n    weekly_weather AS w\nJOIN \n    station AS s\nON \n    w.station_id = s.id\nORDER BY \n    s.network_name, \n    CASE w.day_of_week \n        WHEN 'Monday' THEN 1\n        WHEN 'Tuesday' THEN 2\n        WHEN 'Wednesday' THEN 3\n        WHEN 'Thursday' THEN 4\n        WHEN 'Friday' THEN 5\n        WHEN 'Saturday' THEN 6\n        WHEN 'Sunday' THEN 7\n    END\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df, width=400, height=200).mark_rect().encode(\n    alt.X(\"day_of_week:N\").title(\"Day of Week\"),\n    alt.Y(\"station_name:N\").title(\"Station\"),\n    alt.Color(\"high_temperature:Q\").title(\"High Temperature (°F)\").scale(scheme=\"viridis\")\n).properties(\n    title=\"High Temperatures by Station and Day of Week\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Tables___lasagna_plot_dense_time-series_heatmap.png"
    },
    {
        "type": "type_B",
        "db_id": "storm_record",
        "chart_category": "Bar Charts",
        "chart_type": "horizontal_bar_chart",
        "NLQ": "I came across this horizontal bar chart that looks really clean and professional. Can you create something similar to show how many cities are affected by storms in different regions, ordering the regions from most to least impacted?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/storm_record.sqlite')\n\nquery = '''\nSELECT \n    r.Region_name AS Region,\n    SUM(ar.Number_city_affected) AS Total_Cities_Affected\nFROM \n    affected_region AS ar\nJOIN \n    region AS r ON ar.Region_id = r.Region_id\nGROUP BY \n    r.Region_name\nORDER BY \n    Total_Cities_Affected DESC;\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x=alt.X('Total_Cities_Affected:Q', title='Total Cities Affected'),\n    y=alt.Y('Region:O', sort='-x', title='Region')\n).properties(\n    title='Total Cities Affected by Storms in Each Region'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Bar Charts___horizontal_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "student_assessment",
        "chart_category": "Bar Charts",
        "chart_type": "horizontal_bar_chart",
        "NLQ": "I came across this horizontal bar chart that looks really clean and professional. Could you create something similar to show how many courses each student is registered for, ordered from the most to the least? I'd like the students' names on one side and the number of courses on the other.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/student_assessment.sqlite')\n\nquery = '''\nSELECT \n    s.student_id,\n    p.first_name || ' ' || p.last_name AS student_name,\n    COUNT(sc.course_id) AS course_count\nFROM \n    Students AS s\nJOIN \n    People AS p ON s.student_id = p.person_id\nLEFT JOIN \n    Student_Course_Registrations AS sc ON s.student_id = sc.student_id\nGROUP BY \n    s.student_id, student_name\nORDER BY \n    course_count DESC;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x=alt.X('course_count:Q', title='Number of Courses Registered'),\n    y=alt.Y('student_name:O', sort='-x', title='Student Name')\n).properties(\n    title='Number of Courses Registered per Student'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___horizontal_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "student_assessment",
        "chart_category": "Tables",
        "chart_type": "text_over_a_heatmap",
        "NLQ": "Can you create a heatmap showing average course attendance by city and course name from our student database? I'd like to see cities on the y-axis and course names on the x-axis, with a color scale showing attendance rates. Please include the actual attendance values as text on each cell, with dark text on light backgrounds and white text on dark backgrounds. Add a title \"Average Course Attendance by City and Course Name\" and use a viridis color scheme.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/student_assessment.sqlite')\n\nquery = '''\nSELECT \n    a.city AS City,\n    c.course_name AS Course_Name,\n    COUNT(sca.student_id) * 1.0 / COUNT(DISTINCT sca.student_id) AS Avg_Attendance\nFROM \n    Student_Course_Attendance sca\nJOIN \n    Courses c ON sca.course_id = c.course_id\nJOIN \n    Students s ON sca.student_id = s.student_id\nJOIN \n    People p ON s.student_id = p.person_id\nJOIN \n    People_Addresses pa ON p.person_id = pa.person_id\nJOIN \n    Addresses a ON pa.address_id = a.address_id\nGROUP BY \n    a.city, c.course_name\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    alt.X('Course_Name:O', title='Course Name'),\n    alt.Y('City:O', title='City')\n)\n\nheatmap = base.mark_rect().encode(\n    alt.Color('Avg_Attendance:Q')\n        .scale(scheme='viridis')\n        .title(\"Average Attendance\")\n)\n\ntext = base.mark_text(baseline='middle').encode(\n    alt.Text('Avg_Attendance:Q', format=\".2f\"),\n    color=alt.condition(\n        alt.datum.Avg_Attendance > df['Avg_Attendance'].mean(),\n        alt.value(\"black\"),\n        alt.value(\"white\")\n    )\n)\n\nchart = heatmap + text\nchart.properties(title=\"Average Course Attendance by City and Course Name\")",
        "reference_path": "./vis_bench/img/Tables___text_over_a_heatmap.png"
    },
    {
        "type": "type_B",
        "db_id": "student_transcripts_tracking",
        "chart_category": "Bar Charts",
        "chart_type": "horizontal_bar_chart",
        "NLQ": "I like this horizontal bar chart showing wheat production by year. Could you create a similar chart but instead show the number of courses students are taking grouped by their degree program? Use our student database and make the bars orange for Master's programs and blue for Bachelor's programs. Also, add a legend on the right side.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/student_transcripts_tracking.sqlite')\n\nquery = '''\nSELECT \n    dp.degree_summary_name AS Degree_Program,\n    s.first_name || ' ' || s.last_name AS Student_Name,\n    COUNT(sec.course_id) AS Course_Count\nFROM \n    Student_Enrolment AS se\nJOIN \n    Degree_Programs AS dp ON se.degree_program_id = dp.degree_program_id\nJOIN \n    Students AS s ON se.student_id = s.student_id\nJOIN \n    Student_Enrolment_Courses AS sec ON se.student_enrolment_id = sec.student_enrolment_id\nGROUP BY \n    dp.degree_summary_name, s.student_id\nORDER BY \n    dp.degree_summary_name, Course_Count DESC;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='Course_Count:Q',\n    y=alt.Y('Degree_Program:N', sort='-x'),\n    color='Degree_Program:N',\n    tooltip=['Student_Name:N', 'Course_Count:Q']\n).properties(\n    title=\"Number of Courses Enrolled per Student Grouped by Degree Program\"\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___horizontal_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "student_transcripts_tracking",
        "chart_category": "Tables",
        "chart_type": "text_over_a_heatmap",
        "NLQ": "Can you create a heatmap showing the average number of courses enrolled by degree program and semester? I'd like to see different degree programs on the y-axis and semesters on the x-axis. Please use a viridis color scheme (purple to yellow) to represent the average number of courses, and include the actual values as text on each cell. Also, add a title \"Average Courses Enrolled by Degree Program and Semester\" at the top.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/student_transcripts_tracking.sqlite')\n\nquery = '''\nSELECT \n    dp.degree_summary_name AS Degree_Program,\n    s.semester_name AS Semester,\n    AVG(COUNT(sec.course_id)) OVER (PARTITION BY dp.degree_summary_name, s.semester_name) AS Avg_Courses_Enrolled\nFROM \n    Student_Enrolment AS se\nJOIN \n    Degree_Programs AS dp ON se.degree_program_id = dp.degree_program_id\nJOIN \n    Semesters AS s ON se.semester_id = s.semester_id\nJOIN \n    Student_Enrolment_Courses AS sec ON se.student_enrolment_id = sec.student_enrolment_id\nGROUP BY \n    dp.degree_summary_name, s.semester_name\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    alt.X('Semester:O', title='Semester'),\n    alt.Y('Degree_Program:O', title='Degree Program')\n)\n\nheatmap = base.mark_rect().encode(\n    alt.Color('Avg_Courses_Enrolled:Q')\n        .scale(scheme='viridis')\n        .title(\"Average Courses Enrolled\")\n)\n\ncolor = (\n    alt.when(alt.datum.Avg_Courses_Enrolled > 5)\n    .then(alt.value(\"black\"))\n    .otherwise(alt.value(\"white\"))\n)\n\ntext = base.mark_text(baseline='middle').encode(\n    alt.Text('Avg_Courses_Enrolled:Q', format=\".1f\"), color=color\n)\n\nchart = heatmap + text\nchart.properties(title=\"Average Courses Enrolled by Degree Program and Semester\")",
        "reference_path": "./vis_bench/img/Tables___text_over_a_heatmap.png"
    },
    {
        "type": "type_B",
        "db_id": "swimming",
        "chart_category": "Tables",
        "chart_type": "text_over_a_heatmap",
        "NLQ": "Can you create a heatmap showing the average 100-meter swim times by country? I'd like to see the countries listed along the x-axis and the average time on the y-axis. Please use a color gradient from purple to yellow to represent the times, and overlay the exact time values (with two decimal places) on each bar. Make the text white on dark backgrounds and black on light backgrounds for better readability.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/swimming.sqlite')\n\nquery = '''\nSELECT Nationality, AVG(meter_100) AS avg_time\nFROM swimmer\nGROUP BY Nationality\nORDER BY avg_time DESC\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).encode(\n    alt.X('Nationality:O', title='Country'),\n    alt.Y('avg_time:Q', title='Average 100m Time (seconds)')\n)\n\nheatmap = base.mark_rect().encode(\n    alt.Color('avg_time:Q')\n        .scale(scheme='viridis')\n        .title(\"Average Time (s)\")\n)\n\ncolor = (\n    alt.when(alt.datum.avg_time > df['avg_time'].mean())\n    .then(alt.value(\"black\"))\n    .otherwise(alt.value(\"white\"))\n)\n\ntext = base.mark_text(baseline='middle').encode(\n    alt.Text('avg_time:Q', format=\".2f\"), color=color\n)\n\nchart = heatmap + text\nchart.properties(width=600, height=400)",
        "reference_path": "./vis_bench/img/Tables___text_over_a_heatmap.png"
    },
    {
        "type": "type_B",
        "db_id": "swimming",
        "chart_category": "Bar Charts",
        "chart_type": "horizontal_grouped_bar_chart",
        "NLQ": "Can you change this wheat production chart to show 100-meter swim times by nationality instead? I'd like to see the swimmers grouped by their country, with each swimmer represented by a different color bar. Please include a title that mentions \"100-Meter Swim Times by Nationality\" and add a legend showing the swimmers' names.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/swimming.sqlite')\n\nquery = '''\nSELECT name, Nationality, meter_100\nFROM swimmer\nORDER BY Nationality, meter_100 ASC\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='meter_100:Q',\n    y='Nationality:N',\n    color='name:N',\n    tooltip=['name', 'Nationality', 'meter_100']\n).properties(\n    width=600,\n    height=400,\n    title='100-Meter Swim Times by Nationality'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Bar Charts___horizontal_grouped_bar_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "tracking_grants_for_research",
        "chart_category": "Uncertainties And Trends",
        "chart_type": "error_bars_with_confidence_interval",
        "NLQ": "I like this error bar chart showing yield ranges by variety. Could you create a similar chart but for grant amounts by organization type instead? I'd like to see the minimum and maximum grant amounts as the error bars with a point showing the average amount for each type. Also, please flip the chart horizontally so organization types are listed on the y-axis and grant amounts on the x-axis.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/tracking_grants_for_research.sqlite')\n\nquery = '''\nSELECT\n    OT.organisation_type_description,\n    AVG(G.grant_amount) AS avg_grant_amount,\n    MIN(G.grant_amount) AS min_grant_amount,\n    MAX(G.grant_amount) AS max_grant_amount\nFROM Grants AS G\nJOIN Organisations AS O ON G.organisation_id = O.organisation_id\nJOIN Organisation_Types AS OT ON O.organisation_type = OT.organisation_type\nGROUP BY OT.organisation_type_description;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nerror_bars = alt.Chart(df).mark_errorbar().encode(\n    x=alt.X('min_grant_amount:Q', title='Grant Amount'),\n    x2='max_grant_amount:Q',\n    y=alt.Y('organisation_type_description:N', title='Organisation Type')\n)\n\npoints = alt.Chart(df).mark_point(filled=True, color='black').encode(\n    x=alt.X('avg_grant_amount:Q', title='Grant Amount'),\n    y=alt.Y('organisation_type_description:N', title='Organisation Type')\n)\n\nerror_bars + points",
        "reference_path": "./vis_bench/img/Uncertainties And Trends___error_bars_with_confidence_interval.png"
    },
    {
        "type": "type_B",
        "db_id": "tracking_software_problems",
        "chart_category": "Uncertainties And Trends",
        "chart_type": "error_bars_with_standard_deviation",
        "NLQ": "I came across this visualization that uses error bars to show averages and variation—it looks really clear and professional. Could you create something similar to display the average time it takes to resolve different types of software problems, along with how much that time varies for each category? The data should come from the Problems and Problem_Category_Codes tables.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/tracking_software_problems.sqlite')\nquery = '''\nSELECT\n    PCC.problem_category_description AS variety,\n    STRFTIME('%J', P.date_problem_closed) - STRFTIME('%J', P.date_problem_reported) AS yield\nFROM Problems AS P\nJOIN Problem_Log AS PL\n    ON P.problem_id = PL.problem_id\nJOIN Problem_Category_Codes AS PCC\n    ON PL.problem_category_code = PCC.problem_category_code\nWHERE\n    P.date_problem_closed IS NOT NULL AND P.date_problem_reported IS NOT NULL\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nerror_bars = alt.Chart(df).mark_errorbar(extent='stdev').encode(\n  x=alt.X('yield:Q', scale=alt.Scale(zero=False), title='Days to Close Problem'),\n  y=alt.Y('variety:N', title='Problem Category')\n)\n\npoints = alt.Chart(df).mark_point(filled=True, color='black').encode(\n  x=alt.X('mean(yield):Q', title='Days to Close Problem'),\n  y=alt.Y('variety:N'),\n)\n\nerror_bars + points",
        "reference_path": "./vis_bench/img/Uncertainties And Trends___error_bars_with_standard_deviation.png"
    },
    {
        "type": "type_B",
        "db_id": "assets_maintenance",
        "chart_category": "Bar Charts",
        "chart_type": "stacked_bar_chart_with_text_overlay",
        "NLQ": "Can you create a horizontal stacked bar chart showing fault counts for different assets? I'd like to see the breakdown by fault status (Fixed, Reported, Return, Waiting), with the asset names on the y-axis and total faults on the x-axis. Please add the count numbers inside each bar segment and title it \"Fault Counts by Asset and Status\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/assets_maintenance.sqlite')\n\nquery = '''\nSELECT \n    A.asset_details AS asset,\n    FLP.fault_status AS status,\n    COUNT(FLP.fault_status) AS fault_count\nFROM \n    Fault_Log_Parts AS FLP\nJOIN \n    Fault_Log AS FL ON FLP.fault_log_entry_id = FL.fault_log_entry_id\nJOIN \n    Assets AS A ON FL.asset_id = A.asset_id\nGROUP BY \n    A.asset_details, FLP.fault_status\nORDER BY \n    A.asset_details, FLP.fault_status;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbars = alt.Chart(df).mark_bar().encode(\n    x=alt.X('sum(fault_count):Q', stack='zero', title='Total Faults'),\n    y=alt.Y('asset:N', title='Asset'),\n    color=alt.Color('status:N', title='Fault Status')\n)\n\ntext = alt.Chart(df).mark_text(dx=-15, dy=3, color='white').encode(\n    x=alt.X('sum(fault_count):Q', stack='zero'),\n    y=alt.Y('asset:N'),\n    detail='status:N',\n    text=alt.Text('sum(fault_count):Q', format='.0f')\n)\n\nchart = bars + text\nchart.properties(title=\"Fault Counts by Asset and Status\")",
        "reference_path": "./vis_bench/img/Bar Charts___stacked_bar_chart_with_text_overlay.png"
    },
    {
        "type": "type_B",
        "db_id": "body_builder",
        "chart_category": "Line Charts",
        "chart_type": "filled_step_chart",
        "NLQ": "I came across this cool filled step chart that I really like the look of. Can you create something similar to visualize the total weight lifted by bodybuilders? Use their names on the x-axis, total weight on the y-axis, and order it by their birth dates. Make it a light blue area chart with step-after interpolation and include the outline.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/body_builder.sqlite')\n\nquery = '''\nSELECT p.Name, bb.Total, p.Birth_Date\nFROM body_builder AS bb\nJOIN people AS p ON bb.People_ID = p.People_ID\nORDER BY p.Birth_Date\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_area(\n    color=\"lightblue\",\n    interpolate='step-after',\n    line=True\n).encode(\n    x=alt.X('Name:N', title='Bodybuilder Name'),\n    y=alt.Y('Total:Q', title='Total Weight Lifted')\n)\n\nchart",
        "reference_path": "./vis_bench/img/Line Charts___filled_step_chart.png"
    },
    {
        "type": "type_B",
        "db_id": "climbing",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_cumulative_sum",
        "NLQ": "I came across this line chart image that shows a running total, and I really like its clean style. Could you create something similar for me but using the heights of mountains from the `mountain` table, ordered by their IDs? It would be great if it showed how the total height adds up as we go through the mountains. Please remove the title, grid lines, and data points, and make the chart wider.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/climbing.sqlite')\n\nquery = '''\nSELECT Mountain_ID, Height\nFROM mountain\nORDER BY Mountain_ID;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df, width=600).mark_line().transform_window(\n    sort=[{'field': 'Mountain_ID'}],\n    frame=[None, 0],\n    cumulative_height='sum(Height)'\n).encode(\n    x='Mountain_ID:O',\n    y='cumulative_height:Q'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_cumulative_sum.png"
    },
    {
        "type": "type_B",
        "db_id": "company_1",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_custom_order",
        "NLQ": "I like this line chart showing gas mileage, but could you create a similar one that shows total hours worked on different projects instead? I'd like to see project numbers on the x-axis and total hours worked on the y-axis. Make sure to include data points along the line and add tooltips that show the project name, total hours, and project number when I hover over each point.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/company_1.sqlite')\n\nquery = '''\nSELECT \n    p.Pname AS Project_Name,\n    p.Pnumber AS Project_Number,\n    SUM(w.Hours) AS Total_Hours\nFROM \n    works_on AS w\nJOIN \n    project AS p ON w.Pno = p.Pnumber\nGROUP BY \n    p.Pnumber, p.Pname\nORDER BY \n    p.Pnumber\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_line(point=True).encode(\n    x=alt.X(\"Project_Number:O\").title(\"Project Number\"),\n    y=alt.Y(\"Total_Hours:Q\").title(\"Total Hours Worked\"),\n    order=\"Project_Number\",\n    tooltip=[\"Project_Name\", \"Total_Hours\", \"Project_Number\"]\n)\n\nchart",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_custom_order.png"
    },
    {
        "type": "type_B",
        "db_id": "company_office",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_datum",
        "NLQ": "Can you create a simple line chart showing the number of companies moving into office locations each year? I'd like to highlight the year 2022 with a cyan vertical line and also show the average number of companies per year with a dashed horizontal line. Please remove the title and make it a clean, minimalist design with a tooltip that shows the year and number of companies when hovering.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/company_office.sqlite')\n\nquery = '''\nSELECT \n    move_in_year AS Year, \n    COUNT(company_id) AS Company_Count\nFROM Office_locations\nGROUP BY move_in_year\nORDER BY move_in_year\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\naverage_companies = df['Company_Count'].mean()\n\nlines = (\n    alt.Chart(df)\n    .mark_line()\n    .encode(\n        x=alt.X(\"Year:O\", title=\"Year\"),\n        y=alt.Y(\"Company_Count:Q\", title=\"Number of Companies\"),\n        tooltip=[\"Year\", \"Company_Count\"]\n    )\n)\n\nxrule = (\n    alt.Chart().mark_rule(color=\"cyan\", strokeWidth=2)\n    .encode(x=alt.datum(2022))\n)\n\nyrule = (\n    alt.Chart().mark_rule(strokeDash=[12, 6], size=2)\n    .encode(y=alt.datum(average_companies))\n)\n\nchart = lines + xrule + yrule\nchart.show()",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_datum.png"
    },
    {
        "type": "type_B",
        "db_id": "course_teach",
        "chart_category": "Distributions",
        "chart_type": "2d_histogram_heatmap",
        "NLQ": "I like this movie ratings heatmap, but I need something similar for teacher data instead. Can you create a heatmap showing the relationship between teacher ages and the grades they teach? Use a blue-green color scheme, and bin both the grade levels and ages to make the patterns easier to see. No need for a title - just keep it simple.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/course_teach.sqlite')\n\nquery = '''\nSELECT T1.Grade AS Grade, T3.Age AS Age\nFROM course_arrange AS T1\nJOIN teacher AS T3 ON T1.Teacher_ID = T3.Teacher_ID\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\nchart = alt.Chart(df).mark_rect().encode(\n    alt.X('Grade:Q').bin(maxbins=10),\n    alt.Y('Age:Q').bin(maxbins=10),\n    alt.Color('count():Q').scale(scheme='greenblue')\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___2d_histogram_heatmap.png"
    },
    {
        "type": "type_B",
        "db_id": "course_teach",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_datum_for_color",
        "NLQ": "I came across this line chart that uses different colored lines to compare trends, and I really like the style. Can you create something similar to show how the average teacher ID and average grade vary across different course ID ranges? Remove the title, grid lines, and legend markers, and make the chart more minimalist with thinner lines. Also, extend the x-axis range to go up to 10.",
        "code": "import altair as alt\nfrom vega_datasets import data\nimport sqlite3\nimport pandas as pd\n\nconn = sqlite3.connect('database/course_teach.sqlite')\n\nquery = '''\nSELECT C.Course_ID as IMDB_Rating, T.Teacher_ID as US_Gross, CA.Grade as Worldwide_Gross\nFROM Course AS C\nJOIN course_arrange AS CA ON C.Course_ID = CA.Course_ID\nJOIN Teacher AS T ON CA.Teacher_ID = T.Teacher_ID;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nalt.Chart(df).mark_line().encode(\n    alt.X(\"IMDB_Rating\").bin(True),\n    alt.Y(alt.repeat(\"layer\"))\n        .aggregate(\"mean\")\n        .title(\"Mean of US and Worldwide Gross\"),\n    color=alt.datum(alt.repeat(\"layer\")),\n).repeat(\n    layer=[\"US_Gross\", \"Worldwide_Gross\"]\n)",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_datum_for_color.png"
    },
    {
        "type": "type_B",
        "db_id": "cre_Doc_Control_Systems",
        "chart_category": "Line Charts",
        "chart_type": "line_chart_with_datum_for_color",
        "NLQ": "Can you create a line chart showing how the average number of drafts for document types has changed over the years? I'd like to see the years on the x-axis and the average number of drafts on the y-axis. Please use a blue line and include a simple legend showing it's the document type code.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/cre_Doc_Control_Systems.sqlite')\n\nquery = '''\nSELECT \n    T1.document_type_code,\n    strftime('%Y', T2.receipt_date) AS year,\n    COUNT(T3.draft_number) AS draft_count\nFROM \n    Documents AS T2\nJOIN \n    Ref_Document_Types AS T1 ON T2.document_type_code = T1.document_type_code\nLEFT JOIN \n    Document_Drafts AS T3 ON T2.document_id = T3.document_id\nGROUP BY \n    T1.document_type_code, year\nORDER BY \n    year ASC;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_line().encode(\n    alt.X(\"year:N\", title=\"Year\"),\n    alt.Y(\"mean(draft_count):Q\", title=\"Average Number of Drafts\"),\n    color=alt.datum(\"document_type_code:N\")\n).repeat(\n    layer=[\"document_type_code\"]\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Line Charts___line_chart_with_datum_for_color.png"
    },
    {
        "type": "type_B",
        "db_id": "cre_Doc_Control_Systems",
        "chart_category": "Distributions",
        "chart_type": "2d_histogram_scatter_plot",
        "NLQ": "I like this bubble chart showing movie ratings, but I need something different for my document data. Can you create a bubble chart that shows receipt years on the x-axis and number of drafts on the y-axis? I'd like the y-axis to be binned into groups, and the size of the bubbles should represent how many documents fall into each combination of year and draft count.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/cre_Doc_Control_Systems.sqlite')\n\nquery = '''\nSELECT \n    strftime('%Y', T1.receipt_date) AS receipt_year,\n    COUNT(T2.draft_number) AS draft_count\nFROM \n    Documents AS T1\nJOIN \n    Document_Drafts AS T2 ON T1.document_id = T2.document_id\nGROUP BY \n    receipt_year, T1.document_id\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_circle().encode(\n    alt.X('receipt_year:N').title('Receipt Year'),\n    alt.Y('draft_count:Q').bin().title('Number of Drafts'),\n    size='count()'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___2d_histogram_scatter_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "cre_Doc_Template_Mgt",
        "chart_category": "Distributions",
        "chart_type": "2d_histogram_scatter_plot",
        "NLQ": "I like this binned scatter plot with circles showing counts. Could you create a similar visualization using our document database? I want to see how paragraph counts vary over time, using the effective dates from our Templates table. Just bin the dates on the x-axis and paragraph counts on the y-axis, with the circle size representing how many documents fall in each bin.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/cre_Doc_Template_Mgt.sqlite')\n\nquery = '''\nSELECT \n    T.Date_Effective_From AS Effective_Date,\n    COUNT(P.Paragraph_ID) AS Paragraph_Count\nFROM Templates AS T\nJOIN Documents AS D ON T.Template_ID = D.Template_ID\nJOIN Paragraphs AS P ON D.Document_ID = P.Document_ID\nGROUP BY T.Date_Effective_From\nORDER BY T.Date_Effective_From;\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_circle().encode(\n    alt.X('Effective_Date:T').bin(),\n    alt.Y('Paragraph_Count:Q').bin(),\n    size='count()'\n)\n\nchart.show()",
        "reference_path": "./vis_bench/img/Distributions___2d_histogram_scatter_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "customers_and_products_contacts",
        "chart_category": "Distributions",
        "chart_type": "distributions_and_medians_of_likert_scale_ratings",
        "NLQ": "I came across this visualization that shows distributions with medians highlighted, and I really like the way it presents data. Can you create something similar to display how product prices are distributed across different product types, grouped into five price categories, using our Products table? Make the bubbles blue and add \"Low Range\" and \"High Range\" labels at the ends of each row. Also, include a title \"Product Price Range Distribution by Product Type\" and show the number of products in the legend.",
        "code": "import altair as alt\nimport pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database/customers_and_products_contacts.sqlite')\n\nquery = \"\"\"\nSELECT\n    product_type_code,\n    CASE\n        WHEN product_price < 10000 THEN 1\n        WHEN product_price < 100000 THEN 2\n        WHEN product_price < 1000000 THEN 3\n        WHEN product_price < 10000000 THEN 4\n        ELSE 5\n    END AS price_range_rating\nFROM Products;\n\"\"\"\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nmedians_df = df.groupby('product_type_code')['price_range_rating'].median().reset_index()\nmedians_df.rename(columns={'product_type_code': 'name', 'price_range_rating': 'median'}, inplace=True)\nmedians_df['lo'] = 'Low Range'\nmedians_df['hi'] = 'High Range'\n\nvalues_df = pd.DataFrame()\nfor index, row in df.iterrows():\n    values_df = pd.concat([values_df, pd.DataFrame([{'name': row['product_type_code'], 'value': row['price_range_rating']}])])\n\ny_axis = alt.Y(\"name\").axis(\n    title=None,\n    offset=50,\n    labelFontWeight=\"bold\",\n    ticks=False,\n    grid=True,\n    domain=False,\n)\n\nbase = alt.Chart(\n    medians_df,\n).encode(y_axis)\n\nbubbles = (\n    alt.Chart(values_df)\n    .mark_circle(color=\"#6EB4FD\")\n    .encode(\n        alt.X(\n            \"value:Q\",\n        ).title(None),\n        y_axis,\n        alt.Size(\"count()\").legend(offset=75, title=\"Number of products\"),\n        tooltip=[alt.Tooltip(\"count()\").title(\"Number of products\")],\n    )\n)\n\nticks = base.mark_tick(color=\"black\").encode(\n    alt.X(\"median:Q\")\n    .axis(grid=False, values=[1, 2, 3, 4, 5], format=\".0f\")\n    .scale(domain=[0, 6]),\n)\n\ntexts_lo = base.mark_text(align=\"right\", x=-5).encode(text=\"lo\")\ntexts_hi = base.mark_text(align=\"left\", x=255).encode(text=\"hi\")\n\nchart = (bubbles + ticks + texts_lo + texts_hi).properties(\n    title=\"Product Price Range Distribution by Product Type\", width=300, height=200\n).configure_view(stroke=None)\n\nchart",
        "reference_path": "./vis_bench/img/Distributions___distributions_and_medians_of_likert_scale_ratings.png"
    },
    {
        "type": "type_B",
        "db_id": "game_1",
        "chart_category": "Distributions",
        "chart_type": "quantile-quantile_plot",
        "NLQ": "I like this Q-Q plot, but could you modify it to show hours played on the y-axis instead of standardized values? Also, split the chart to compare scholarship vs non-scholarship students side by side, and just use the uniform distribution on the x-axis. Add a grid to make it easier to read the values.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/game_1.sqlite')\nquery = '''\nSELECT \n    S.OnScholarship,\n    PG.Hours_Played\nFROM \n    Plays_Games AS PG\nJOIN \n    SportsInfo AS S ON PG.StuID = S.StuID\nWHERE \n    S.OnScholarship IN ('Y', 'N')\n'''\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nbase = alt.Chart(df).transform_quantile(\n    'Hours_Played',\n    step=0.01,\n    as_=['p', 'v']\n).transform_calculate(\n    uniform='quantileUniform(datum.p)',\n    normal='quantileNormal(datum.p)'\n).mark_point().encode(\n    alt.Y('v:Q', title='Hours Played')\n)\n\nchart = base.encode(x='uniform:Q').facet(\n    column=alt.Column('OnScholarship:N', title='On Scholarship')\n)\n\nchart",
        "reference_path": "./vis_bench/img/Distributions___quantile-quantile_plot.png"
    },
    {
        "type": "type_B",
        "db_id": "performance_attendance",
        "chart_category": "Scatter Plots",
        "chart_type": "simple_scatter_plot_with_labels",
        "NLQ": "I came across this scatter plot image that I really like—it has a clean design with labels on each point. Could you create something similar for me but using the attendance numbers from the `performance` table, with locations on the y-axis and attendance on the x-axis?",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/performance_attendance.sqlite')\n\nquery = '''\nSELECT Location, Attendance\nFROM performance\n'''\n\ndf = pd.read_sql_query(query, conn)\n\nconn.close()\n\npoints = alt.Chart(df).mark_point().encode(\n    x='Attendance:Q',\n    y='Location:N'\n)\n\ntext = points.mark_text(\n    align='left',\n    baseline='middle',\n    dx=7\n).encode(\n    text='Location:N'\n)\n\npoints + text",
        "reference_path": "./vis_bench/img/Scatter Plots___simple_scatter_plot_with_labels.png"
    },
    {
        "type": "type_B",
        "db_id": "perpetrator",
        "chart_category": "Scatter Plots",
        "chart_type": "simple_scatter_plot_with_labels",
        "NLQ": "I came across this scatter plot image that I really like—it has points labeled with names, and it looks clean and professional. Can you create something similar showing the number of people killed vs. injured for different locations, using our perpetrator data? Make sure to label the axes as \"Killed\" and \"Injured\", add a grid to the background, and place the location names next to each point instead of using letters.",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/perpetrator.sqlite')\n\nquery = '''\nSELECT Location, Killed, Injured\nFROM perpetrator\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\npoints = alt.Chart(df).mark_point().encode(\n    x='Killed:Q',\n    y='Injured:Q'\n)\n\ntext = points.mark_text(\n    align='left',\n    baseline='middle',\n    dx=7\n).encode(\n    text='Location'\n)\n\nchart = points + text\nchart",
        "reference_path": "./vis_bench/img/Scatter Plots___simple_scatter_plot_with_labels.png"
    },
    {
        "type": "type_B",
        "db_id": "pilot_record",
        "chart_category": "Simple Charts",
        "chart_type": "simple_bar_chart",
        "NLQ": "I came across this simple bar chart that looks clean and professional. Can you create something similar to show how many flights were logged each year from the pilot record data, broken down by year? Make sure to label the x-axis with the actual years (like 2003, 2004, etc.) and the y-axis as \"Total Flights\".",
        "code": "import sqlite3\nimport pandas as pd\nimport altair as alt\n\nconn = sqlite3.connect('database/pilot_record.sqlite')\n\nquery = '''\nSELECT \n    SUBSTR(Date, 1, 4) AS Year,\n    COUNT(*) AS Total_Flights\nFROM pilot_record\nGROUP BY Year\nORDER BY Year\n'''\n\ndf = pd.read_sql_query(query, conn)\nconn.close()\n\nchart = alt.Chart(df).mark_bar().encode(\n    x='Year:N',\n    y='Total_Flights:Q'\n)\n\nchart",
        "reference_path": "./vis_bench/img/Simple Charts___simple_bar_chart.png"
    }
]